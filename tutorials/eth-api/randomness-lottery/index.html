<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Looking to create a lottery smart contract? Follow this step-by-step tutorial on using Moonbeam's Randomness Precompile (a Solidity interface) to get started."><link href=https://docs.moonbeam.network/tutorials/eth-api/randomness-lottery/ rel=canonical><link href=../batch-approve-swap/ rel=prev><link href=../call-permit-gasless-txs/ rel=next><link rel=icon href=../../../assets/images/favicon.webp><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.15"><title>Create a Lottery with the Randomness Precompile | Moonbeam Docs</title><link rel=stylesheet href=../../../assets/stylesheets/main.342714a4.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@cookbookdev/docsbot/dist/standalone/index.cjs.js as=script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Banana+Grotesk:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Banana Grotesk";--md-code-font:"Roboto Mono"}</style><link rel=preconnect href=https://fonts.googleapis.com><link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel=stylesheet><link rel=stylesheet href=../../../assets/stylesheets/moonbeam.min.css><link rel=stylesheet href=../../../assets/stylesheets/termynal.min.css><link rel=stylesheet href=../../../assets/stylesheets/timeline-neoteroi.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-5ZBERCXWC3"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-5ZBERCXWC3",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-5ZBERCXWC3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#create-a-lottery-contract-using-the-randomness-precompile class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <div class=md-header__left-nav> <a href=https://docs.moonbeam.network/ title="Moonbeam Docs" class="md-header__button md-logo" aria-label="Moonbeam Docs"> <img src=../../../assets/images/logo.webp alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> </div> <div class=md-header__buttons> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../builders/ >Builders</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../builders/get-started/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/get-started.webp alt="Get Started" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Get Started</span> <p class=dropdown-desc>Everything you need to get started building</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/ethereum/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/ethereum.webp alt="Ethereum Toolkit" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Ethereum Toolkit</span> <p class=dropdown-desc>Ethereum libraries, tools, and contracts</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/substrate/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/substrate.webp alt="Substrate Toolkit" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Substrate Toolkit</span> <p class=dropdown-desc>Substrate libraries, tools, and low-level interfaces</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/interoperability/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/interoperability.webp alt=Interoperability loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Interoperability</span> <p class=dropdown-desc>GMP protocols for cross-chain development</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/integrations/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/integrations.webp alt=Integrate loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Integrate</span> <p class=dropdown-desc>Tools and protocols to integrate with</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../node-operators/ >Node Operators</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../node-operators/networks/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/networks.webp alt=Networks loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Networks</span> <p class=dropdown-desc>Run full, tracing, or collator nodes</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../tokens/ >Tokens</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../tokens/connect/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/connect.webp alt="Connect to Moonbeam" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Connect to Moonbeam</span> <p class=dropdown-desc>Connect your wallet to Moonbeam</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../tokens/manage/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/manage.webp alt="Account Management" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Account Management</span> <p class=dropdown-desc>Advanced account and identity services</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../tokens/staking/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/staking.webp alt=Staking loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Staking</span> <p class=dropdown-desc>Stake tokens by delegating to collators</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../tokens/governance/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/governance.webp alt=Governance loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Governance</span> <p class=dropdown-desc>Submit and vote on on-chain proposals</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../learn/ >Learn</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../learn/platform/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/platform.webp alt=Platform loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Platform</span> <p class=dropdown-desc>Dive into underlying technology and design aspects</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../learn/core-concepts/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/core-concepts.webp alt="Core Concepts" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Core Concepts</span> <p class=dropdown-desc>Learn about the fundamentals of Moonbeam</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../learn/features/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/features.webp alt=Features loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Features</span> <p class=dropdown-desc>Explore core features</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../learn/dapp-directory/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/dapp-directory.webp alt="DApp Directory" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>DApp Directory</span> <p class=dropdown-desc>Explore the DApp Directory and listing process</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../ >Tutorials</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../interoperability/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/interoperability.webp alt=Interoperability loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Interoperability</span> <p class=dropdown-desc>Get hands-on building cross-chain DApps</p> </div> </a> </li> <li class=md-tab__item> <a href=../ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/eth-api.webp alt="Ethereum API" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Ethereum API</span> <p class=dropdown-desc>Beginner to pro smart contract tutorials</p> </div> </a> </li> <li class=md-tab__item> <a href=../../integrations/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/integrations.webp alt=Integrations loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Integrations</span> <p class=dropdown-desc>Dive deeper with tutorials on seamless integrations</p> </div> </a> </li> </ul> </li> </ul> </div> </nav> <div class="language-select-wrapper select-wrapper"> <span class="language-select-label select-label">Eng</span> <ul class="language-select select"> <li class=en value=en><a href=#>Eng</a></li> <li class=cn value=cn><a href>中文</a></li> </ul> <span class="md-icon selector-closed active"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6z"/></svg></span> <span class="md-icon selector-open"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></span> </div> <a href=# class="md-header__button md-button connectMetaMask-nav md-typeset"> Connect Wallet </a> <a class="md-header__button md-button faucet md-typeset" href=https://faucet.moonbeam.network/ target=_blank> Faucet </a> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Moonbeam Docs" class="md-nav__button md-logo" aria-label="Moonbeam Docs" data-md-component=logo> <img src=../../../assets/images/logo.webp alt=logo> </a> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ >Builders</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/get-started/ >Get Started</a> <label for=__nav_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-get-started-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/get-started/quick-start/ class=md-nav__link> Quick Start </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/create-account/ class=md-nav__link> Create an Account </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/get-started/networks/ >Networks</a> <label for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-get-started-networks-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonbeam-dev/ class=md-nav__link> Local Moonbeam Dev Node </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonbase/ class=md-nav__link> Moonbase Alpha </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonriver/ class=md-nav__link> Moonriver </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonbeam/ class=md-nav__link> Moonbeam </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/get-started/endpoints/ class=md-nav__link> Network RPC Endpoints </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/explorers/ class=md-nav__link> Block Explorers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/ >Ethereum Toolkit</a> <label for=__nav_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/canonical-contracts/ class=md-nav__link> Canonical Contracts </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/ >Precompiled Contracts</a> <label for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/account/ >Account Management</a> <label for=__nav_2_3_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-account-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/account/identity/ class=md-nav__link> Identity </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/account/proxy/ class=md-nav__link> Proxy </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/ux/ >User Experience</a> <label for=__nav_2_3_3_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-ux-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/ux/batch/ class=md-nav__link> Batch </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/ux/call-permit/ class=md-nav__link> Call Permit </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/ux/erc20/ class=md-nav__link> Native Token ERC-20 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/features/ >Network Features</a> <label for=__nav_2_3_3_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-features-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/features/governance/ >Governance</a> <label for=__nav_2_3_3_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_3_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-features-governance-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/collective/ class=md-nav__link> Collective </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/conviction-voting/ class=md-nav__link> Conviction Voting </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/preimage/ class=md-nav__link> Preimage </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/referenda/ class=md-nav__link> Referenda </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/randomness/ class=md-nav__link> Randomness </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/staking/ class=md-nav__link> Staking Functions </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/interoperability/ >Interoperability</a> <label for=__nav_2_3_3_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-interoperability-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/interoperability/gmp/ class=md-nav__link> GMP </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xc20/send-xc20s/xtokens-precompile/ class=md-nav__link> X-Tokens </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xc20/send-xc20s/eth-api/ class=md-nav__link> XCM Interface </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-precompile/ class=md-nav__link> XCM Transactor </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xcm-utils/ class=md-nav__link> XCM Utilities </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_7> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/utility/ >Utility</a> <label for=__nav_2_3_3_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_7> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-utility-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/eth-mainnet/ class=md-nav__link> Ethereum Native </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/registry/ class=md-nav__link> Precompile Registry </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/relay-data-verifier/ class=md-nav__link> Relay Data Verifier </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/non-specific/ class=md-nav__link> Non-Network Specific </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/libraries/ >Libraries</a> <label for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-libraries-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/ethersjs/ class=md-nav__link> Ethers.js </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/ethersrs/ class=md-nav__link> Ethers.rs </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/viem/ class=md-nav__link> viem </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/web3js/ class=md-nav__link> Web3.js </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/web3py/ class=md-nav__link> Web3.py </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/dev-env/ >Dev Environments</a> <label for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-dev-env-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/dev-env/openzeppelin/ >OpenZeppelin</a> <label for=__nav_2_3_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-dev-env-openzeppelin-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/openzeppelin/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/openzeppelin/contracts/ class=md-nav__link> Contract Wizard </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/ape/ class=md-nav__link> Ape </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/foundry/ class=md-nav__link> Foundry </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/hardhat/ class=md-nav__link> Hardhat </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/remix/ class=md-nav__link> Remix </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/scaffold-eth/ class=md-nav__link> Scaffold-ETH </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/tenderly/ class=md-nav__link> Tenderly </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/thirdweb/ class=md-nav__link> thirdweb </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/waffle-mars/ class=md-nav__link> Waffle & Mars </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/verify-contracts/ >Verify Contracts</a> <label for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-verify-contracts-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/verify-contracts/block-explorers/ class=md-nav__link> Block Explorers </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/verify-contracts/etherscan-plugins/ class=md-nav__link> Etherscan Plugins </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/verify-contracts/api-verification/ class=md-nav__link> API-based Verification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_7> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/json-rpc/ >JSON-RPC APIs</a> <label for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-json-rpc-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/eth-rpc/ class=md-nav__link> Standard Ethereum </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/debug-trace/ class=md-nav__link> Non-standard Ethereum: Tracing </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/pubsub/ class=md-nav__link> Non-standard Ethereum: Pubsub </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/moonbeam-custom-api/ class=md-nav__link> Custom Moonbeam </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/ >Substrate Toolkit</a> <label for=__nav_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/libraries/ >Libraries</a> <label for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-libraries-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/libraries/polkadot-js-api/ class=md-nav__link> Polkadot.js API </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/libraries/py-substrate-interface/ class=md-nav__link> Py Substrate Interface </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/libraries/sidecar/ class=md-nav__link> Sidecar </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/dev-env/ >Dev Environments</a> <label for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-dev-env-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/dev-env/chopsticks/ class=md-nav__link> Chopsticks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/ >Low-Level Interfaces</a> <label for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/account/ >Account Management</a> <label for=__nav_2_4_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-account-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/account/identity/ class=md-nav__link> Identity </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/account/multisig/ class=md-nav__link> Multisig </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/account/proxy/ class=md-nav__link> Proxy </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/features/ >Network Features</a> <label for=__nav_2_4_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-features-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/features/governance/ >Governance</a> <label for=__nav_2_4_4_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_4_4_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_3_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-features-governance-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/conviction-voting/ class=md-nav__link> Conviction Voting </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/parameters/ class=md-nav__link> Parameters </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/preimage/ class=md-nav__link> Preimage </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/referenda/ class=md-nav__link> Referenda </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/staking/ class=md-nav__link> Parachain Staking </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/randomness/ class=md-nav__link> Randomness </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/interoperability/ >Interoperability</a> <label for=__nav_2_4_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-interoperability-" data-md-scrollfix> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xc20/send-xc20s/xcm-pallet/ class=md-nav__link> Polkadot XCM </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-pallet/ class=md-nav__link> XCM Transactor </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/utility/ >Utility</a> <label for=__nav_2_4_4_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-utility-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/utility/utility/ class=md-nav__link> Utility </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/ >Interoperability</a> <label for=__nav_2_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/ >XCM Interoperability</a> <label for=__nav_2_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/core-concepts/ >Core Concepts</a> <label for=__nav_2_5_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-core-concepts-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/instructions/ class=md-nav__link> XCM Instructions </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/multilocations/ class=md-nav__link> Multilocations </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/weights-fees/ class=md-nav__link> Weights and Fees </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/sovereign-accounts/ class=md-nav__link> Sovereign Accounts </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/xc-registration/ >XC Registration</a> <label for=__nav_2_5_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-xc-registration-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/forum-templates/ class=md-nav__link> Forum Templates </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/xc-integration/ class=md-nav__link> XC Channel Registration </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/assets/ class=md-nav__link> XC Asset Registration via Governance </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/self-serve-asset-registration/ class=md-nav__link> Self-Serve Asset Registration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/xc20/ >XC-20s</a> <label for=__nav_2_5_2_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-xc20-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/interact/ class=md-nav__link> Interact with XC-20s </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_5_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/ >Send XC-20s</a> <label for=__nav_2_5_2_5_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_5_2_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_5_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-xc20-send-xc20s-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/xcm-pallet/ class=md-nav__link> Using the Substrate API: Polkadot XCM Pallet </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/xtokens-precompile/ class=md-nav__link> Using the Ethereum API: X-Tokens Precompile </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/eth-api/ class=md-nav__link> Using the Ethereum API: XCM Precompile </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/remote-execution/ >Remote Execution</a> <label for=__nav_2_5_2_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-remote-execution-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/computed-origins/ class=md-nav__link> Computed Origin Accounts </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_6_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/remote-execution/substrate-calls/ >Remote Substrate Calls</a> <label for=__nav_2_5_2_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_5_2_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_6_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-remote-execution-substrate-calls-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-pallet/ class=md-nav__link> Using the Substrate API </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-precompile/ class=md-nav__link> Using the Ethereum API </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/remote-evm-calls/ class=md-nav__link> Remote EVM Calls </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://moonbeam-foundation.github.io/xcm-sdk/latest/ class=md-nav__link> XCM SDK </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/send-execute-xcm/ class=md-nav__link> Send, Execute, & Test XCMs </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xcm-utils/ class=md-nav__link> XCM Utilities </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/protocols/ >Cross-Chain Protocols</a> <label for=__nav_2_5_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-protocols-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/axelar/ class=md-nav__link> Axelar </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/hyperlane/ class=md-nav__link> Hyperlane </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/layerzero/ class=md-nav__link> LayerZero </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/wormhole/ class=md-nav__link> Wormhole </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/mrl/ class=md-nav__link> Moonbeam Routed Liquidity </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/ >Integrate</a> <label for=__nav_2_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/analytics/ >Analytics</a> <label for=__nav_2_6_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-analytics-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/analytics/dapplooker/ class=md-nav__link> Dapplooker </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/analytics/zapper/ class=md-nav__link> Portfolio Tracking on Moonbeam </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/indexers/ >Indexers</a> <label for=__nav_2_6_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-indexers-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/thegraph/ class=md-nav__link> The Graph </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/covalent/ class=md-nav__link> GoldRush API </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/moralis/ class=md-nav__link> Moralis </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/subquery/ class=md-nav__link> SubQuery </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/subsquid/ class=md-nav__link> SQD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/oracles/ >Oracles</a> <label for=__nav_2_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-oracles-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/api3/ class=md-nav__link> API3 </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/band-protocol/ class=md-nav__link> Band Protocol </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/dia/ class=md-nav__link> DIA </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/razor-network/ class=md-nav__link> Razor Network </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/supra/ class=md-nav__link> Supra </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/wallets/ >Wallets</a> <label for=__nav_2_6_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-wallets-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/metamask/ class=md-nav__link> MetaMask </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/walletconnect/ class=md-nav__link> WalletConnect </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/particle-network/ class=md-nav__link> Particle Network </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/rainbowkit/ class=md-nav__link> RainbowKit </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/ >Node Operators</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/networks/ >Networks</a> <label for=__nav_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-networks-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/networks/run-a-node/ >Run a Node</a> <label for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-networks-run-a-node-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/docker/ class=md-nav__link> Using Docker </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/systemd/ class=md-nav__link> Using Systemd </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/flags/ class=md-nav__link> Flags </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/tracing-node/ class=md-nav__link> Run a Tracing Node </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/networks/collators/ >Collators</a> <label for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-networks-collators-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/requirements/ class=md-nav__link> Requirements </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/account-management/ class=md-nav__link> Account Management </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/author-mapping/ class=md-nav__link> Author Mapping Precompile </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/activities/ class=md-nav__link> Collator Activities </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/orbiter/ class=md-nav__link> Orbiter Program </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/ >Tokens</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/connect/ >Connect to Moonbeam</a> <label for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-connect-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/connect/ledger/ >Ledger</a> <label for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-connect-ledger-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/connect/ledger/moonbeam/ class=md-nav__link> Moonbeam App </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/ledger/moonriver/ class=md-nav__link> Moonriver App </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/ledger/ethereum/ class=md-nav__link> Ethereum App </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tokens/connect/coinbase-wallet/ class=md-nav__link> Coinbase Wallet </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/mathwallet/ class=md-nav__link> MathWallet </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/metamask/ class=md-nav__link> MetaMask </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/polkadotjs/ class=md-nav__link> Polkadot.js Apps </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/subwallet/ class=md-nav__link> SubWallet </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/talisman/ class=md-nav__link> Talisman </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/trezor/ class=md-nav__link> Trezor </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/on-ramps/ class=md-nav__link> On Ramps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/manage/ >Account Management</a> <label for=__nav_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-manage-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/manage/proxy-accounts/ class=md-nav__link> Proxy Accounts </a> </li> <li class=md-nav__item> <a href=../../../tokens/manage/multisig-safe/ class=md-nav__link> Moonbeam Safe </a> </li> <li class=md-nav__item> <a href=../../../tokens/manage/identity/ class=md-nav__link> Managing an Identity </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/staking/ >Staking</a> <label for=__nav_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-staking-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/staking/stake/ class=md-nav__link> How to Stake </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/governance/ >Governance</a> <label for=__nav_4_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-governance-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/governance/proposals/ class=md-nav__link> Submit a Democracy Proposal </a> </li> <li class=md-nav__item> <a href=../../../tokens/governance/voting/ class=md-nav__link> Vote on a Proposal </a> </li> <li class=md-nav__item> <a href=../../../tokens/governance/treasury-spend/ class=md-nav__link> Submit a Treasury Proposal </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/ >Learn</a> <label for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/platform/ >Platform</a> <label for=__nav_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-platform-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/platform/networks/ >Networks</a> <label for=__nav_5_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-platform-networks-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../learn/platform/networks/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/networks/moonbase/ class=md-nav__link> Moonbase Alpha </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/networks/moonriver/ class=md-nav__link> Moonriver </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/networks/moonbeam/ class=md-nav__link> Moonbeam </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../learn/platform/vision/ class=md-nav__link> Vision </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/why-polkadot/ class=md-nav__link> Why Polkadot </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/technology/ class=md-nav__link> Technology & Architecture </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/tokens/ class=md-nav__link> Tokens </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/code/ class=md-nav__link> Source Code </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/links/ class=md-nav__link> Important Links </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/glossary/ class=md-nav__link> Glossary </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/core-concepts/ >Core Concepts</a> <label for=__nav_5_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-core-concepts-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../learn/core-concepts/balances/ class=md-nav__link> Account Balances </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/transfers-api/ class=md-nav__link> Balance Transfers </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/consensus-finality/ class=md-nav__link> Consensus & Finality </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/tx-fees/ class=md-nav__link> Transaction Fees </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/unified-accounts/ class=md-nav__link> Unified Accounts </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/security/ class=md-nav__link> Security Considerations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/features/ >Features</a> <label for=__nav_5_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-features-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../learn/features/xchain-plans/ class=md-nav__link> Cross-Chain Communication </a> </li> <li class=md-nav__item> <a href=../../../learn/features/eth-compatibility/ class=md-nav__link> Ethereum Compatibility </a> </li> <li class=md-nav__item> <a href=../../../learn/features/governance/ class=md-nav__link> Governance </a> </li> <li class=md-nav__item> <a href=../../../learn/features/consensus/ class=md-nav__link> Parachain Consensus </a> </li> <li class=md-nav__item> <a href=../../../learn/features/randomness/ class=md-nav__link> Randomness </a> </li> <li class=md-nav__item> <a href=../../../learn/features/staking/ class=md-nav__link> Staking </a> </li> <li class=md-nav__item> <a href=../../../learn/features/treasury/ class=md-nav__link> Treasury </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../learn/dapp-directory/ class=md-nav__link> DApp Directory </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../ >Tutorials</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../interoperability/ >Interoperability</a> <label for=__nav_6_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-interoperability-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../interoperability/protocols.index/ >Create Connected Contracts with Cross-Chain Protocols</a> <label for=__nav_6_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-interoperability-protocols.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../interoperability/cross-chain-dao/ class=md-nav__link> [LayerZero] Creating a Cross-Chain DAO </a> </li> <li class=md-nav__item> <a href=../../interoperability/using-axelar-sdk/ class=md-nav__link> [Axelar] Minting a Cross-Chain NFT </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../interoperability/xcm.index/ >Build Cross-Chain Applications with XCM</a> <label for=__nav_6_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-interoperability-xcm.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../interoperability/remote-staking-xcm/ class=md-nav__link> [Polkadot's XCM Pallet] Remote Staking on Moonbeam from Polkadot </a> </li> <li class=md-nav__item> <a href=../../interoperability/uniswapv2-swap-xcm/ class=md-nav__link> [Polkadot's XCM Pallet] Uniswap V2 Swap on Moonbeam from Polkadot </a> </li> <li class=md-nav__item> <a href=../../interoperability/remote-batched-evm-calls/ class=md-nav__link> [Polkadot's XCM Pallet] Batched Remote EVM Calls on Moonbeam from Polkadot </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Ethereum API</a> <label for=__nav_6_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=true> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-eth-api-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../get-started.index/ >Get Started with Smart Contracts</a> <label for=__nav_6_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-eth-api-get-started.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../chat-gpt/ class=md-nav__link> [ChatGPT] Use GPT-4 to Write and Debug Smart Contracts </a> </li> <li class=md-nav__item> <a href=../how-to-build-a-dapp/ class=md-nav__link> [Ethers.js] How to Build a DApp </a> </li> <li class=md-nav__item> <a href=../foundry-start-to-end/ class=md-nav__link> [Foundry] Development Life Cycle from Start to End </a> </li> <li class=md-nav__item> <a href=../hardhat-start-to-end/ class=md-nav__link> [Hardhat] Development Life Cycle from Start to End </a> </li> <li class=md-nav__item> <a href=../using-tenderly/ class=md-nav__link> [Tenderly] Using Tenderly to Debug and Simulate Transactions </a> </li> <li class=md-nav__item> <a href=../thirdweb/ class=md-nav__link> [thirdweb] Building a DApp with thirdweb </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../precompiles.index/ >Interact with Precompiles</a> <label for=__nav_6_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_6_3_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-eth-api-precompiles.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../batch-approve-swap/ class=md-nav__link> [Batch] Approve & Swap Tokens in a Single Transaction </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> [Randomness] Create a Lottery <span class="md-nav__icon md-icon"></span> </label> <div class="md-nav__link-wrapper md-nav__item md-nav__item--active"> <a href=./ class="md-nav__link md-nav__link--active"> [Randomness] Create a Lottery </a> </div> <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Determine title --> <!-- Table of contents --> <nav class="md-nav md-nav--secondary" aria-label=Sections> <!--
    Check whether the content starts with a level 1 headline. If it does, the
    top-level anchor must be skipped, since it would be redundant to the link
    to the current page that is located just above the anchor. Therefore we
    directly continue with the children of the anchor.
  --> <!-- Table of contents title and list --> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> <div class=toc-sections-title>Sections</div> </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#checking-prerequisites class=md-nav__link> <span class=md-ellipsis> Checking Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#contracts class=md-nav__link> <span class=md-ellipsis> Contract Setup </span> </a> </li> <li class=md-nav__item> <a href=#write-the-lottery-contract class=md-nav__link> <span class=md-ellipsis> Create the Lottery Smart Contract </span> </a> <nav class=md-nav aria-label="Create the Lottery Smart Contract"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-parameters class=md-nav__link> <span class=md-ellipsis> Define Parameters for the Lottery and Randomness Request </span> </a> </li> <li class=md-nav__item> <a href=#create-constructor class=md-nav__link> <span class=md-ellipsis> Create the Constructor </span> </a> </li> <li class=md-nav__item> <a href=#participate-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Participate in the Lottery </span> </a> </li> <li class=md-nav__item> <a href=#start-lottery-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Start the Lottery and Request Randomness </span> </a> </li> <li class=md-nav__item> <a href=#fulfill-randomness-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Fulfill the Randomness Request </span> </a> </li> <li class=md-nav__item> <a href=#pick-winners-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Pick the Lottery Winners </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#interact-with-lottery-contract class=md-nav__link> <span class=md-ellipsis> Interact with the Lottery Contract </span> </a> <nav class=md-nav aria-label="Interact with the Lottery Contract"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compile-deploy-lottery-contract class=md-nav__link> <span class=md-ellipsis> Compile &amp; Deploy the Lottery Contract </span> </a> </li> <li class=md-nav__item> <a href=#participate-in-lottery class=md-nav__link> <span class=md-ellipsis> Create Scripts to Interact with the Lottery Contract </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../call-permit-gasless-txs/ class=md-nav__link> [Call Permit] Send Gasless Transactions </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4> <div class="md-nav__link md-nav__link--index "> <a href=../../integrations/ >Integrations</a> <label for=__nav_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-integrations-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../integrations/indexers.index/ >Use Indexers to Query Chain Data</a> <label for=__nav_6_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-integrations-indexers.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../integrations/local-subsquid/ class=md-nav__link> [SQD] Index a Local Dev Node </a> </li> <li class=md-nav__item> <a href=../../integrations/nft-subsquid/ class=md-nav__link> [SQD] Index NFT Transfers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../integrations/oracles.index/ >Use Oracles to Fetch Off-Chain Data</a> <label for=__nav_6_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-integrations-oracles.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../integrations/supra/ class=md-nav__link> [Supra] Fetch Price Data </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../integrations/0xgasless/ class=md-nav__link> Enable Gasless Transactions </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner><!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Determine title --> <!-- Table of contents --> <nav class="md-nav md-nav--secondary" aria-label=Sections> <!--
    Check whether the content starts with a level 1 headline. If it does, the
    top-level anchor must be skipped, since it would be redundant to the link
    to the current page that is located just above the anchor. Therefore we
    directly continue with the children of the anchor.
  --> <!-- Table of contents title and list --> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> <div class=toc-sections-title>Sections</div> </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#checking-prerequisites class=md-nav__link> <span class=md-ellipsis> Checking Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#contracts class=md-nav__link> <span class=md-ellipsis> Contract Setup </span> </a> </li> <li class=md-nav__item> <a href=#write-the-lottery-contract class=md-nav__link> <span class=md-ellipsis> Create the Lottery Smart Contract </span> </a> <nav class=md-nav aria-label="Create the Lottery Smart Contract"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-parameters class=md-nav__link> <span class=md-ellipsis> Define Parameters for the Lottery and Randomness Request </span> </a> </li> <li class=md-nav__item> <a href=#create-constructor class=md-nav__link> <span class=md-ellipsis> Create the Constructor </span> </a> </li> <li class=md-nav__item> <a href=#participate-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Participate in the Lottery </span> </a> </li> <li class=md-nav__item> <a href=#start-lottery-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Start the Lottery and Request Randomness </span> </a> </li> <li class=md-nav__item> <a href=#fulfill-randomness-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Fulfill the Randomness Request </span> </a> </li> <li class=md-nav__item> <a href=#pick-winners-logic class=md-nav__link> <span class=md-ellipsis> Add Logic to Pick the Lottery Winners </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#interact-with-lottery-contract class=md-nav__link> <span class=md-ellipsis> Interact with the Lottery Contract </span> </a> <nav class=md-nav aria-label="Interact with the Lottery Contract"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compile-deploy-lottery-contract class=md-nav__link> <span class=md-ellipsis> Compile &amp; Deploy the Lottery Contract </span> </a> </li> <li class=md-nav__item> <a href=#participate-in-lottery class=md-nav__link> <span class=md-ellipsis> Create Scripts to Interact with the Lottery Contract </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div><div class=feedback-actions-container><div class=feedback-section> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M23 10a2 2 0 0 0-2-2h-6.32l.96-4.57c.02-.1.03-.21.03-.32 0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.58C7.22 7.95 7 8.45 7 9v10a2 2 0 0 0 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73zM1 21h4V9H1z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15h4V3h-4m-4 0H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2a2 2 0 0 0 2 2h6.31l-.95 4.57c-.02.1-.03.2-.03.31 0 .42.17.79.44 1.06L9.83 23l6.58-6.59c.37-.36.59-.86.59-1.41V5a2 2 0 0 0-2-2"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by submitting <a href="https://github.com/moonbeam-foundation/moonbeam-docs/issues/new/?title=[Feedback]+Create%20a%20Lottery%20with%20the%20Randomness%20Precompile+-+/tutorials/eth-api/randomness-lottery/" target=_blank rel=noopener>additional feedback</a>. </div> </div> </div> </fieldset> <div class=divider></div></form> </div><div class=edit-section> <a href=https://github.com/moonbeam-foundation/moonbeam-docs/edit/master/tutorials/eth-api/randomness-lottery.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> Edit this page </a> </div> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=create-a-lottery-contract-using-the-randomness-precompile>Create a Lottery Contract using the Randomness Precompile<a class=headerlink href=#create-a-lottery-contract-using-the-randomness-precompile title="Permanent link">&para;</a></h1> <p><em>by Erin Shaben</em></p> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>Moonbeam utilizes verifiable random functions (VRF) to generate randomness that can be verified on-chain. A VRF is a cryptographic function that takes some input and produces random values, along with a proof of authenticity that these random values were generated by the submitter. The proof can be verified by anyone to ensure the random values generated were calculated correctly.</p> <p>There are two available sources of randomness that provide random inputs based on block producers' VRF keys and past randomness results: <a href=/moonbeam-mkdocs/learn/features/randomness/#local-vrf target=_blank>local VRF</a> and <a href=/moonbeam-mkdocs/learn/features/randomness/#babe-epoch-randomness target=_blank>BABE epoch randomness</a>. Local VRF is determined directly within Moonbeam using the collator of the block's VRF key and the last block's VRF output. On the other hand, <a href=https://docs.polkadot.com/polkadot-protocol/architecture/polkadot-chain/pos-consensus/#block-production-babe target=_blank>BABE</a> epoch randomness is based on all the VRF produced by the relay chain validators during a complete <a href=https://wiki.polkadot.com/general/glossary/#epoch target=_blank>epoch</a>.</p> <p>For more information on the two sources of randomness, how the request and fulfillment process works, and security considerations, please refer to the <a href=/moonbeam-mkdocs/learn/features/randomness/ target=_blank>Randomness on Moonbeam</a> page.</p> <p>Moonbeam provides a <a href=/moonbeam-mkdocs/builders/ethereum/precompiles/features/randomness/ target=_blank>Randomness Precompile</a>, which is a Solidity interface that enables smart contract developers to generate randomness via local VRF or BABE epoch randomness using the Ethereum API. Moonbeam also provides a <a href=/moonbeam-mkdocs/builders/ethereum/precompiles/features/randomness/#randomness-consumer-solidity-interface target=_blank>Randomness Consumer Solidity contract</a> that your contract must inherit from in order to consume fulfilled randomness requests.</p> <p>This guide will show you how to use the Randomness Precompile and Randomness Consumer contract to create a lottery where the winners will randomly be selected.</p> <h2 id=checking-prerequisites>Checking Prerequisites<a class=headerlink href=#checking-prerequisites title="Permanent link">&para;</a></h2> <p>For this tutorial, you'll need the following:</p> <ul> <li>Create or have three accounts on Moonbase Alpha to test out the lottery contract</li> <li>All of the accounts will need to be funded with <code>DEV</code> tokens. You can get DEV tokens for testing on Moonbase Alpha once every 24 hours from the <a href=https://faucet.moonbeam.network target=_blank>Moonbase Alpha Faucet</a></li> <li>An empty Hardhat project that is configured for the Moonbase Alpha TestNet. For step-by-step instructions, please refer to the <a href=/moonbeam-mkdocs/builders/ethereum/dev-env/hardhat/#creating-a-hardhat-project target=_blank>Creating a Hardhat Project</a> and the <a href=/moonbeam-mkdocs/builders/ethereum/dev-env/hardhat/#hardhat-configuration-file target=_blank>Hardhat Configuration File</a> sections of our Hardhat documentation page</li> <li> <p>Install the <a href=https://hardhat.org/hardhat-runner/plugins/nomicfoundation-hardhat-ethers target=_blank>Hardhat Ethers plugin</a>. This provides a convenient way to use the <a href=/moonbeam-mkdocs/builders/ethereum/libraries/ethersjs/ target=_blank>Ethers.js</a> library to interact with the network from your Hardhat project:</p> <div class=highlight><pre><span></span><code>npm<span class=w> </span>install<span class=w> </span>@nomicfoundation/hardhat-ethers<span class=w> </span>ethers@6
</code></pre></div> </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>To test out the examples in this guide on Moonbeam or Moonriver, you will need to have your own endpoint and API key, which you can get from one of the supported <a href=/moonbeam-mkdocs/builders/get-started/endpoints/ target=_blank>Endpoint Providers</a>.</p> </div> <h2 id=contracts>Contract Setup<a class=headerlink href=#contracts title="Permanent link">&para;</a></h2> <p>The following are the contracts that we'll be working with today to create our lottery:</p> <ul> <li><code>Randomness.sol</code> - the <a href=/moonbeam-mkdocs/builders/ethereum/precompiles/features/randomness/ target=_blank>Randomness Precompile</a>, which is a Solidity interface that allows you to request randomness, get information about randomness requests, fulfill requests, and more</li> <li><code>RandomnessConsumer.sol</code> - the <a href=/moonbeam-mkdocs/builders/ethereum/precompiles/features/randomness/#randomness-consumer-solidity-interface target=_blank>Randomness Consumer</a>, which is an abstract Solidity contract that is used to interact with the Randomness Precompile. This contract is responsible for validating the origin of randomness requests, ensuring the Randomness Precompile is always the origin, and fulfilling requests</li> <li><code>Lottery.sol</code> - an example lottery contract that we'll be building in this guide together. It will rely on the Randomness Precompile and Consumer to request random words that will be used to select a winner for our lottery</li> </ul> <p>If you don't already have a <code>contracts</code> directory in your Hardhat project, you can create a new directory:</p> <div class=highlight><pre><span></span><code>mkdir<span class=w> </span>contracts<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>contracts
</code></pre></div> <p>Then you can create the following three files, one for each of the aforementioned contracts:</p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>Randomness.sol<span class=w> </span>RandomnessConsumer.sol<span class=w> </span>Lottery.sol
</code></pre></div> <p>In the <code>Randomness.sol</code> file, you can paste in the Randomness Precompile contract.</p> <details class=code> <summary>Randomness.sol</summary> <div class=highlight><pre><span></span><code><span class=c1>// SPDX-License-Identifier: GPL-3.0-only</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=o>&gt;=</span><span class=k>0.8.3</span><span class=p>;</span>

<span class=c1>/// @dev The Randomness contract&#39;s address.</span>
<span class=kt>address</span><span class=w> </span><span class=nv>constant</span><span class=w> </span>RANDOMNESS_ADDRESS<span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x0000000000000000000000000000000000000809</span><span class=p>;</span>

<span class=c1>/// @dev The Randomness contract&#39;s instance.</span>
Randomness<span class=w> </span><span class=kt>constant</span><span class=w> </span>RANDOMNESS_CONTRACT<span class=w> </span><span class=o>=</span><span class=w> </span>Randomness<span class=p>(</span>RANDOMNESS_ADDRESS<span class=p>);</span>

<span class=c1>/// @dev Maximum number of random words being requested</span>
<span class=kt>uint32</span><span class=w> </span><span class=nv>constant</span><span class=w> </span>MAX_RANDOM_WORDS<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">100</span><span class=p>;</span>
<span class=c1>/// @dev Minimum number of blocks before a request can be fulfilled for Local VRF Request</span>
<span class=kt>uint32</span><span class=w> </span><span class=nv>constant</span><span class=w> </span>MIN_VRF_BLOCKS_DELAY<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">2</span><span class=p>;</span>
<span class=c1>/// @dev Maximum number of blocks before a request can be fulfilled for Local VRF Request</span>
<span class=kt>uint32</span><span class=w> </span><span class=nv>constant</span><span class=w> </span>MAX_VRF_BLOCKS_DELAY<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">2000</span><span class=p>;</span>
<span class=c1>/// @dev The deposit amount needed to request random words. There is 1 deposit per request</span>
<span class=kt>uint256</span><span class=w> </span><span class=nv>constant</span><span class=w> </span>REQUEST_DEPOSIT_AMOUNT<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">1000000000000000000</span><span class=p>;</span>

<span class=c1>/// @author The Moonbeam Team</span>
<span class=c1>/// @title Pallet Randomness Interface</span>
<span class=c1>/// @dev The interface through which solidity contracts will interact with Randomness</span>
<span class=c1>/// @custom:address 0x0000000000000000000000000000000000000809</span>
interface<span class=w> </span>Randomness<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>/// @notice Event emitted when the request has been successfully executed</span>
<span class=w>    </span><span class=kt>event</span><span class=w> </span><span class=nv>FulFillmentSucceeded</span><span class=p>();</span>
<span class=w>    </span><span class=c1>/// @notice Event emitted when the request has failed to execute fulfillment</span>
<span class=w>    </span><span class=kt>event</span><span class=w> </span><span class=nv>FulFillmentFailed</span><span class=p>();</span>

<span class=w>    </span><span class=c1>/// @notice The status of the request</span>
<span class=w>    </span><span class=c1>/// @param DoesNotExist The request doesn&#39;t exist</span>
<span class=w>    </span><span class=c1>/// @param Pending The request cannot be fulfilled yet</span>
<span class=w>    </span><span class=c1>/// @param Ready The request is ready to be fulfilled</span>
<span class=w>    </span><span class=c1>/// @param Expired The request has expired</span>
<span class=w>    </span><span class=kt>enum</span><span class=w> </span><span class=nv>RequestStatus</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>DoesNotExist<span class=p>,</span>
<span class=w>        </span>Pending<span class=p>,</span>
<span class=w>        </span>Ready<span class=p>,</span>
<span class=w>        </span>Expired
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=c1>/// @notice The type of randomness source</span>
<span class=w>    </span><span class=c1>/// @param LocalVRF Randomness VRF using the parachain material as seed</span>
<span class=w>    </span><span class=c1>/// @param RelayBabeEpoch Randomness VRF using relay material from previous epoch</span>
<span class=w>    </span><span class=kt>enum</span><span class=w> </span><span class=nv>RandomnessSource</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>LocalVRF<span class=p>,</span>
<span class=w>        </span>RelayBabeEpoch
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=c1>/// @notice The request details</span>
<span class=w>    </span><span class=c1>/// @param id The id of the request (is always &lt; 2**64)</span>
<span class=w>    </span><span class=c1>/// @param refundAddress The address receiving the left-over fees after the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param contractAddress The address of the contract being called back during fulfillment</span>
<span class=w>    </span><span class=c1>/// @param fee The amount to set aside to pay for the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param gasLimit The gas limit to use for the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param salt A string being mixed with the randomness seed to obtain different random words. This should be as unique as possible; using the same salt will lead to same randomness result.</span>
<span class=w>    </span><span class=c1>/// @param numWords The number of random words requested (from 1 to MAX_RANDOM_WORDS)</span>
<span class=w>    </span><span class=c1>/// @param randomnessSource The type of randomness source used to generate the random words</span>
<span class=w>    </span><span class=c1>/// @param fulfillmentBlock The parachain block number at which the request can be fulfilled (for LocalVRF only)</span>
<span class=w>    </span><span class=c1>/// @param fulfillmentEpochIndex The relay epoch index at which the request can be fulfilled (for RelayBabeEpoch)</span>
<span class=w>    </span><span class=c1>/// @param expirationBlock The parachain block number at which the request expires (for LocalVRF only)</span>
<span class=w>    </span><span class=c1>/// @param expirationEpochIndex The relay epoch index at which the request expires (for RelayBabeEpoch)</span>
<span class=w>    </span><span class=c1>/// @param status The current status of the request</span>
<span class=w>    </span><span class=kt>struct</span><span class=w> </span><span class=nv>Request</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>id</span><span class=p>;</span>
<span class=w>        </span><span class=kt>address</span><span class=w> </span><span class=nv>refundAddress</span><span class=p>;</span>
<span class=w>        </span><span class=kt>address</span><span class=w> </span><span class=nv>contractAddress</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>fee</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>gasLimit</span><span class=p>;</span>
<span class=w>        </span><span class=kt>bytes32</span><span class=w> </span><span class=nv>salt</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint32</span><span class=w> </span><span class=nv>numWords</span><span class=p>;</span>
<span class=w>        </span>RandomnessSource<span class=w> </span>randomnessSource<span class=p>;</span>
<span class=w>        </span><span class=kt>uint32</span><span class=w> </span><span class=nv>fulfillmentBlock</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>fulfillmentEpochIndex</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint32</span><span class=w> </span><span class=nv>expirationBlock</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>expirationEpochIndex</span><span class=p>;</span>
<span class=w>        </span>RequestStatus<span class=w> </span>status<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=c1>/// Return the current relay epoch index</span>
<span class=w>    </span><span class=c1>/// @dev An epoch represents real time and not a block number</span>
<span class=w>    </span><span class=c1>/// @dev Currently, time between epoch changes cannot be longer than:</span>
<span class=w>    </span><span class=c1>/// @dev  - Kusama/Westend/Rococo: 600 relay blocks (1 hour)</span>
<span class=w>    </span><span class=c1>/// @dev  - Polkadot: 2400 relay blocks (4 hours)</span>
<span class=w>    </span><span class=c1>/// @custom:selector 81797566</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>relayEpochIndex</span><span class=p>()</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint64</span><span class=p>);</span>

<span class=w>    </span><span class=c1>/// Return the deposit required to perform a request</span>
<span class=w>    </span><span class=c1>/// @dev Each request will need a deposit.</span>
<span class=w>    </span><span class=c1>/// @custom:selector fb7cfdd7</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>requiredDeposit</span><span class=p>()</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>);</span>

<span class=w>    </span><span class=c1>/// @notice Returns the request status</span>
<span class=w>    </span><span class=c1>/// @param requestId The id of the request to check (must be &lt; 2**64)</span>
<span class=w>    </span><span class=c1>/// @return status Status of the request</span>
<span class=w>    </span><span class=c1>/// @custom:selector d8a4676f</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getRequestStatus</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>)</span>
<span class=w>        </span><span class=kt>external</span>
<span class=w>        </span>view
<span class=w>        </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span>RequestStatus<span class=w> </span>status<span class=p>);</span>

<span class=w>    </span><span class=c1>/// @notice Returns the request or revert</span>
<span class=w>    </span><span class=c1>/// @param requestId The id of the request to check (must be &lt; 2**64)</span>
<span class=w>    </span><span class=c1>/// @return request The request</span>
<span class=w>    </span><span class=c1>/// @custom:selector c58343ef</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getRequest</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>)</span>
<span class=w>        </span><span class=kt>external</span>
<span class=w>        </span>view
<span class=w>        </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span>Request<span class=w> </span><span class=kt>memory</span><span class=w> </span>request<span class=p>);</span>

<span class=w>    </span><span class=c1>/// @notice Request random words generated from the parachain VRF</span>
<span class=w>    </span><span class=c1>/// @dev This is using pseudo-random VRF executed by the collator at the fulfillment</span>
<span class=w>    </span><span class=c1>/// @dev Warning:</span>
<span class=w>    </span><span class=c1>/// @dev The collator in charge of producing the block at fulfillment can decide to skip</span>
<span class=w>    </span><span class=c1>/// @dev producing the block in order to have a different random word generated by the next</span>
<span class=w>    </span><span class=c1>/// @dev collator, at the cost of a block reward. It is therefore economically viable to use</span>
<span class=w>    </span><span class=c1>/// @dev this randomness source only if the financial reward at stake is lower than the block</span>
<span class=w>    </span><span class=c1>/// @dev reward.</span>
<span class=w>    </span><span class=c1>/// @dev In order to reduce the risk of a collator being able to predict the random words</span>
<span class=w>    </span><span class=c1>/// @dev when the request is performed, it is possible to increase the delay to multiple blocks</span>
<span class=w>    </span><span class=c1>/// @dev The higher the delay is, the less likely the collator will be able to know which</span>
<span class=w>    </span><span class=c1>/// @dev collator will be in charge of fulfilling the request.</span>
<span class=w>    </span><span class=c1>/// @dev Fulfillment is manual and can be executed by anyone (for free) after the given delay</span>
<span class=w>    </span><span class=c1>/// @param refundAddress The address receiving the left-over fees after the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param fee The amount to set aside to pay for the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param gasLimit The gas limit to use for the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param salt A string being mixed with the randomness seed to obtain different random words</span>
<span class=w>    </span><span class=c1>/// @param numWords The number of random words requested (from 1 to MAX_RANDOM_WORDS)</span>
<span class=w>    </span><span class=c1>/// @param delay The number of blocks until the request can be fulfilled (between MIN_DELAY_BLOCKS and MAX_DELAY_BLOCKS)</span>
<span class=w>    </span><span class=c1>/// @return requestId The id of the request requestLocalVRFRandomWords</span>
<span class=w>    </span><span class=c1>/// @custom:selector 9478430c</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>requestLocalVRFRandomWords</span><span class=p>(</span>
<span class=w>        </span><span class=kt>address</span><span class=w> </span><span class=nv>refundAddress</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>fee</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>gasLimit</span><span class=p>,</span>
<span class=w>        </span><span class=kt>bytes32</span><span class=w> </span><span class=nv>salt</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint8</span><span class=w> </span><span class=nv>numWords</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>delay</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>);</span>

<span class=w>    </span><span class=c1>/// @notice Request random words generated from the relaychain Babe consensus</span>
<span class=w>    </span><span class=c1>/// @dev The random words are generated from the hash of the all the VRF provided by the</span>
<span class=w>    </span><span class=c1>/// @dev relaychain validator during 1 epoch.</span>
<span class=w>    </span><span class=c1>/// @dev It requires a delay of at least 1 epoch after the current epoch to be unpredictable</span>
<span class=w>    </span><span class=c1>/// @dev at the time the request is performed.</span>
<span class=w>    </span><span class=c1>/// @dev Warning:</span>
<span class=w>    </span><span class=c1>/// @dev The validator (on the relaychain) of the last block of an epoch can decide to skip</span>
<span class=w>    </span><span class=c1>/// @dev producing the block in order to choose the previous generated epoch random number</span>
<span class=w>    </span><span class=c1>/// @dev at the cost of a relaychain block rewards. It is therefore economically viable to use</span>
<span class=w>    </span><span class=c1>/// @dev this randomness source only if the financial reward at stake is lower than the relaychain</span>
<span class=w>    </span><span class=c1>/// @dev block reward.</span>
<span class=w>    </span><span class=c1>/// @dev (see https://crates.parity.io/pallet_babe/struct.RandomnessFromOneEpochAgo.html)</span>
<span class=w>    </span><span class=c1>/// @dev Fulfillment is manual and can be executed by anyone (for free) at</span>
<span class=w>    </span><span class=c1>/// @dev the beginning of the 2nd relay epoch following the current one</span>
<span class=w>    </span><span class=c1>/// @param refundAddress The address receiving the left-over fees after the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param fee Amount to set aside to pay for the fulfillment. Those fees are taken from the contract</span>
<span class=w>    </span><span class=c1>/// @param gasLimit Gas limit for the fulfillment</span>
<span class=w>    </span><span class=c1>/// @param salt Salt to be mixed with raw randomness to get output</span>
<span class=w>    </span><span class=c1>/// @param numWords Number of random words to be returned (limited to MAX_RANDOM_WORDS)</span>
<span class=w>    </span><span class=c1>/// @return requestId The id of the request</span>
<span class=w>    </span><span class=c1>/// @custom:selector 33c14a63</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>requestRelayBabeEpochRandomWords</span><span class=p>(</span>
<span class=w>        </span><span class=kt>address</span><span class=w> </span><span class=nv>refundAddress</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>fee</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>gasLimit</span><span class=p>,</span>
<span class=w>        </span><span class=kt>bytes32</span><span class=w> </span><span class=nv>salt</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint8</span><span class=w> </span><span class=nv>numWords</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>);</span>

<span class=w>    </span><span class=c1>/// @dev fulFill the request which will call the contract method &quot;fulfillRandomWords&quot;</span>
<span class=w>    </span><span class=c1>/// @dev Fees of the caller are refunded if the request is fulfillable</span>
<span class=w>    </span><span class=c1>/// @param requestId Request to be fulfilled (must be &lt; 2**64)</span>
<span class=w>    </span><span class=c1>/// @custom:selector 9a91eb0d</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>fulfillRequest</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=p>;</span>

<span class=w>    </span><span class=c1>/// @param requestId Request receiving the additional fees (must be &lt; 2**64)</span>
<span class=w>    </span><span class=c1>/// @param feeIncrease Amount to increase</span>
<span class=w>    </span><span class=c1>/// @custom:selector d0408a7f</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>increaseRequestFee</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>,</span><span class=w> </span><span class=kt>uint256</span><span class=w> </span><span class=nv>feeIncrease</span><span class=p>)</span>
<span class=w>        </span><span class=kt>external</span><span class=p>;</span>

<span class=w>    </span><span class=c1>/// @param requestId Request to be purged (must be &lt; 2**64)</span>
<span class=w>    </span><span class=c1>/// @custom:selector 1d26cbab</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>purgeExpiredRequest</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> </details> <p>Similarly, in the <code>RandomnessConsumer.sol</code> file, you can paste in the Randomness Consumer contract. </p> <details class=code> <summary>RandomnessConsumer.sol</summary> <div class=highlight><pre><span></span><code><span class=c1>// Inspired by: https://raw.githubusercontent.com/smartcontractkit/chainlink/8e8a996fd882c0861bdc9824c1ca27c857c87d03/contracts/src/v0.8/VRFConsumerBaseV2.sol</span>
<span class=c1>// SPDX-License-Identifier: GPL-3.0</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=o>&gt;=</span><span class=k>0.8.3</span><span class=p>;</span>

<span class=c1>/// @dev The Randomness contract&#39;s address.</span>
<span class=kt>address</span><span class=w> </span><span class=nv>constant</span><span class=w> </span>RANDOMNESS_ADDRESS<span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x0000000000000000000000000000000000000809</span><span class=p>;</span>

<span class=cm>/** ****************************************************************************</span>
<span class=cm> * @notice Interface for contracts using VRF randomness</span>
<span class=cm> * *****************************************************************************</span>
<span class=cm> * @dev PURPOSE</span>
<span class=cm> *</span>
<span class=cm> * @dev The purpose of this contract is to make it easy for contracts to talk to</span>
<span class=cm> * @dev the Randomness Precompile. It ensures 2 things:</span>
<span class=cm> * @dev 1. The fulfillment came from the Randomness Precompile</span>
<span class=cm> * @dev 2. The consumer contract implements fulfillRandomWords.</span>
<span class=cm> * *****************************************************************************</span>
<span class=cm> * @dev USAGE</span>
<span class=cm> *</span>
<span class=cm> * @dev Calling contracts must inherit from RandomnessConsumer</span>
<span class=cm> *</span>
<span class=cm> * @dev Call one of the randomness request functions:</span>
<span class=cm> * @dev 1. requestLocalVRFRandomWords(refundAddress, fee, gasLimit, salt</span>
<span class=cm> * @dev numWords, delay),</span>
<span class=cm> * @dev 2. requestRelayBabeEpochRandomWords(refundAddress, fee, gasLimit, salt</span>
<span class=cm> * @dev numWords),</span>
<span class=cm> * @dev see (Randomness.sol for a description of each function and their arguments).</span>
<span class=cm> *</span>
<span class=cm> * @dev Once the request has been registered and the minimum delay is passed, the</span>
<span class=cm> * @dev request then can be executed (for 0 fee) by anyone. it will call your</span>
<span class=cm> * @dev contract&#39;s fulfillRandomWords method.</span>
<span class=cm> *</span>
<span class=cm> * @dev The randomness argument to fulfillRandomWords is a set of random words</span>
<span class=cm> * @dev generated from your requestId.</span>
<span class=cm> *</span>
<span class=cm> * @dev If your contract could have concurrent requests open, you can use the</span>
<span class=cm> * @dev requestId returned from requestRandomWords to track which response is associated</span>
<span class=cm> * @dev with which randomness request.</span>
<span class=cm> * @dev See &quot;SECURITY CONSIDERATIONS&quot; for principles to keep in mind,</span>
<span class=cm> * @dev if your contract could have multiple requests in flight simultaneously.</span>
<span class=cm> *</span>
<span class=cm> * @dev Colliding `requestId`s are cryptographically impossible as long as seeds</span>
<span class=cm> * @dev differ.</span>
<span class=cm> *</span>
<span class=cm> * *****************************************************************************</span>
<span class=cm> * @dev SECURITY CONSIDERATIONS</span>
<span class=cm> *</span>
<span class=cm> * @dev A method with the ability to call your fulfillRandomness method directly</span>
<span class=cm> * @dev could spoof a VRF response with any random value, so it&#39;s critical that</span>
<span class=cm> * @dev it cannot be directly called by anything other than this base contract</span>
<span class=cm> * @dev (specifically, by the RandomnessConsumer.rawFulfillRandomness method).</span>
<span class=cm> *</span>
<span class=cm> * @dev For your users to trust that your contract&#39;s random behavior is free</span>
<span class=cm> * @dev from malicious interference, it&#39;s best if you can write it so that all</span>
<span class=cm> * @dev behaviors implied by a VRF response are executed *during* your</span>
<span class=cm> * @dev fulfillRandomness method. If your contract must store the response (or</span>
<span class=cm> * @dev anything derived from it) and use it later, you must ensure that any</span>
<span class=cm> * @dev user-significant behavior which depends on that stored value cannot be</span>
<span class=cm> * @dev manipulated by a subsequent VRF request.</span>
<span class=cm> *</span>
<span class=cm> * @dev Similarly, the collators have some influence over the order in which</span>
<span class=cm> * @dev VRF responses appear on the blockchain, so if your contract could have</span>
<span class=cm> * @dev multiple VRF requests in flight simultaneously, you must ensure that</span>
<span class=cm> * @dev the order in which the VRF responses arrive cannot be used to manipulate</span>
<span class=cm> * @dev your contract&#39;s user-significant behavior.</span>
<span class=cm> *</span>
<span class=cm> * @dev Since the output of the random words generated for</span>
<span class=cm> * @dev *requestLocalVRFRandomWords* is dependant of the collator producing the</span>
<span class=cm> * @dev block at fulfillment, the collator could skip its block forcing the</span>
<span class=cm> * @dev fulfillment to be executed by a different collator, and therefore</span>
<span class=cm> * @dev generating a different VRF.</span>
<span class=cm> * @dev However, such an attack would incur the cost of losing the block reward to</span>
<span class=cm> * @dev the collator.</span>
<span class=cm> * @dev It is also possible for a collator to be able to predict some of the</span>
<span class=cm> * @dev possible outcome of the VRF if the delay between the request and the</span>
<span class=cm> * @dev fulfillment is too short. It is for this reason that we allow to provide</span>
<span class=cm> * @dev a higher delay</span>
<span class=cm> *</span>
<span class=cm> * @dev Since the output of the random words generated for</span>
<span class=cm> * @dev *requestRelayBabeEpochRandomWords* is dependant of the relaychain</span>
<span class=cm> * @dev validator producing the blocks during an epoch, it is possible for</span>
<span class=cm> * @dev the last validator of an epoch to choose between 2 possible VRF</span>
<span class=cm> * @dev outputs by skipping the production of a block.</span>
<span class=cm> * @dev However, such an attack would incur the cost of losing the block reward to</span>
<span class=cm> * @dev the validator</span>
<span class=cm> * @dev It is not possible for a parachain collator to predict nor influence</span>
<span class=cm> * @dev the output of the relaychain VRF, not to censor the fulfillment as long as</span>
<span class=cm> * @dev there is one honest collator.</span>
<span class=cm> */</span>
abstract<span class=w> </span><span class=k>contract</span><span class=w> </span><span class=ni>RandomnessConsumer</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span>error<span class=w> </span>OnlyRandomnessPrecompileCanFulfill<span class=p>(</span><span class=kt>address</span><span class=w> </span><span class=nv>have</span><span class=p>,</span><span class=w> </span><span class=kt>address</span><span class=w> </span><span class=nv>want</span><span class=p>);</span>

<span class=w>    </span><span class=cm>/**</span>
<span class=cm>     * @notice fulfillRandomness handles the VRF response. Your contract must</span>
<span class=cm>     * @notice implement it. See &quot;SECURITY CONSIDERATIONS&quot; above for important</span>
<span class=cm>     * @notice principles to keep in mind when implementing your fulfillRandomness</span>
<span class=cm>     * @notice method.</span>
<span class=cm>     *</span>
<span class=cm>     * @dev RandomnessConsumer expects its subcontracts to have a method with this</span>
<span class=cm>     * @dev signature, and will call it once it has verified the proof</span>
<span class=cm>     * @dev associated with the randomness. (It is triggered via a call to</span>
<span class=cm>     * @dev rawFulfillRandomness, below.)</span>
<span class=cm>     *</span>
<span class=cm>     * @param requestId The Id initially returned by requestLocalVRFRandomWords or requestRelayBabeEpochRandomWords</span>
<span class=cm>     * @param randomWords The VRF output expanded to the requested number of words</span>
<span class=cm>     */</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>fulfillRandomWords</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>,</span><span class=w> </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>randomWords<span class=p>)</span>
<span class=w>        </span><span class=kt>internal</span>
<span class=w>        </span>virtual<span class=p>;</span>

<span class=w>    </span><span class=c1>// rawFulfillRandomness is called by Randomness Precompile when the executeFulfillement</span>
<span class=w>    </span><span class=c1>// is called. rawFulfillRandomness then calls fulfillRandomness, after validating</span>
<span class=w>    </span><span class=c1>// the origin of the call</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>rawFulfillRandomWords</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>requestId</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>randomWords
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=k>msg.sender</span><span class=w> </span><span class=o>!=</span><span class=w> </span>RANDOMNESS_ADDRESS<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=w> </span>OnlyRandomnessPrecompileCanFulfill<span class=p>(</span>
<span class=w>                </span><span class=k>msg.sender</span><span class=p>,</span>
<span class=w>                </span>RANDOMNESS_ADDRESS
<span class=w>            </span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span>fulfillRandomWords<span class=p>(</span>requestId<span class=p>,</span><span class=w> </span>randomWords<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </details> <p>We'll start adding the functionality to the <code>Lottery.sol</code> contract in the following section.</p> <h2 id=write-the-lottery-contract>Create the Lottery Smart Contract<a class=headerlink href=#write-the-lottery-contract title="Permanent link">&para;</a></h2> <p>At a high level, the lottery contract we're creating will define the rules of the lottery, enable participation, and use randomly generated words to select winners fairly. We'll be requesting the random words via the Randomness Precompile. Then we'll use the Randomness Consumer interface to consume the results of the fulfilled request so that our contract can use the randomly generated words to select the winners and pay them out. We'll break down each step of the process as we build the lottery contract, but for now, you can review the following diagram for an overview of the process.</p> <p><a class=glightbox href=/moonbeam-mkdocs/images/tutorials/eth-api/randomness-lottery/lottery-1.webp data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Diagram of the Lottery process." src=/moonbeam-mkdocs/images/tutorials/eth-api/randomness-lottery/lottery-1.webp></a></p> <p><strong>This contract is for educational purposes only and is not meant for production use.</strong></p> <p>To get started, let's set up our lottery contract. We'll need to:</p> <ul> <li>Import the <code>Randomness.sol</code> precompile and <code>RandomnessConsumer.sol</code> interface</li> <li>Inherit the Randomness Consumer interface</li> <li>Create a variable for the Randomness Precompile so we can easily access its functions later on</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>// SPDX-License-Identifier: GPL-3.0-only</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=o>&gt;=</span><span class=k>0.8.0</span><span class=p>;</span>

<span class=kt>import</span><span class=w> </span><span class=s2>&quot;./Randomness.sol&quot;</span><span class=p>;</span>
<span class=kt>import</span><span class=w> </span><span class=p>{</span>RandomnessConsumer<span class=p>}</span><span class=w> </span>from<span class=w> </span><span class=s2>&quot;./RandomnessConsumer.sol&quot;</span><span class=p>;</span>

<span class=k>contract</span><span class=w> </span><span class=ni>Lottery</span><span class=w> </span><span class=kt>is</span><span class=w> </span>RandomnessConsumer<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Randomness Precompile interface</span>
<span class=w>    </span>Randomness<span class=w> </span><span class=kt>public</span><span class=w> </span>randomness<span class=w> </span><span class=o>=</span>
<span class=w>        </span>Randomness<span class=p>(</span><span class=mh>0x0000000000000000000000000000000000000809</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> <h3 id=define-parameters>Define Parameters for the Lottery and Randomness Request<a class=headerlink href=#define-parameters title="Permanent link">&para;</a></h3> <p>Next we're going to need to define the rules of our lottery, such as:</p> <ul> <li>The participation fee</li> <li>The minimum and maximum number of participants</li> <li>The minimum length of the lottery</li> <li>The number of winners</li> </ul> <p>Inside of the <code>Lottery</code> contract, you can add these parameters:</p> <div class=highlight><pre><span></span><code><span class=c1>// The number of winners. This number corresponds to how many random words</span>
<span class=c1>// will be requested. Cannot exceed MAX_RANDOM_WORDS (from the Randomness</span>
<span class=c1>// Precompile)</span>
<span class=kt>uint8</span><span class=w> </span><span class=k>public </span><span class=nv>NUM_WINNERS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">2</span><span class=p>;</span>

<span class=c1>// The number of blocks before the request can be fulfilled (for Local VRF</span>
<span class=c1>// randomness). The MIN_VRF_BLOCKS_DELAY (from the Randomness Precompile) </span>
<span class=c1>// provides a minimum number that is safe enough for games with low economical</span>
<span class=c1>// value at stake. Increasing the delay slightly reduces the probability </span>
<span class=c1>// (already very low) of a collator being able to predict the pseudo-random number</span>
<span class=kt>uint32</span><span class=w> </span><span class=k>public </span><span class=nv>VRF_BLOCKS_DELAY</span><span class=w> </span><span class=o>=</span><span class=w> </span>MIN_VRF_BLOCKS_DELAY<span class=p>;</span>

<span class=c1>// The minimum number of participants to start the lottery</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>MIN_PARTICIPANTS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">3</span><span class=p>;</span>

<span class=c1>// The maximum number of participants allowed to participate. It is important </span>
<span class=c1>// to limit the total jackpot (by limiting the number of participants) to</span>
<span class=c1>// guarantee the economic incentive of a collator to avoid trying to influence</span>
<span class=c1>// the pseudo-random. (See Randomness.sol for more details)</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>MAX_PARTICIPANTS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">20</span><span class=p>;</span>

<span class=c1>// The fee needed to participate in the lottery. Will go into the jackpot</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>PARTICIPATION_FEE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">100000</span><span class=w> </span>gwei<span class=p>;</span>
</code></pre></div> <p>We will also need to define some parameters specifically related to requesting randomness:</p> <ul> <li>The gas limit for the transaction that fulfills a randomness request</li> <li>The minimum fee needed to start the lottery and request the random words. Each request for randomness requires a fulfillment fee. The purpose of this fee is to pay for the fulfillment of a randomness request, which allows anyone to fulfill a request since the request will already have been paid for. When submitting a randomness request, a refund account can be specified, where any excess fees will be returned to. Our contract will be set up so that the owner of the lottery contract will receive the refund</li> <li>A salt prefix and the global request count, both of which will be used to generate unique randomness requests</li> </ul> <p>You can go ahead and add these parameters:</p> <div class=highlight><pre><span></span><code><span class=c1>// The gas limit allowed to be used for the fulfillment, which depends on the</span>
<span class=c1>// code that is executed and the number of words requested. Test and adjust</span>
<span class=c1>// this limit based on the size of the request and the processing of the </span>
<span class=c1>// callback request in the fulfillRandomWords() function</span>
<span class=kt>uint64</span><span class=w> </span><span class=k>public </span><span class=nv>FULFILLMENT_GAS_LIMIT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">100000</span><span class=p>;</span>

<span class=c1>// The minimum fee needed to start the lottery. This does not guarantee that </span>
<span class=c1>// there will be enough fee to pay for the gas used by the fulfillment. </span>
<span class=c1>// Ideally it should be over-estimated considering possible fluctuation of </span>
<span class=c1>// the gas price. Additional fee will be refunded to the caller</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>MIN_FEE</span><span class=w> </span><span class=o>=</span><span class=w> </span>FULFILLMENT_GAS_LIMIT<span class=w> </span><span class=o>*</span><span class=w> </span><span class="m m-Decimal">150</span><span class=w> </span>gwei<span class=p>;</span>

<span class=c1>// A string used to allow having different salt than other contracts</span>
<span class=kt>bytes32</span><span class=w> </span><span class=k>public </span><span class=nv>SALT_PREFIX</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;my_demo_salt_change_me&quot;</span><span class=p>;</span>

<span class=c1>// Stores the global number of requests submitted. This number is used as a</span>
<span class=c1>// salt to make each request unique</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>globalRequestCount</span><span class=p>;</span>
</code></pre></div> <p>Aside from these parameters, we'll need to create some variables which will be used to keep track of the current lottery:</p> <ul> <li>The current request ID</li> <li>The list of current participants</li> <li>The jackpot</li> <li>The owner of the lottery contract. This is necessary because only the owner of the contract will be allowed to start the lottery</li> <li>The source of randomness (local VRF or BABE epoch) that is being used</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>// The current request id</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>requestId</span><span class=p>;</span>

<span class=c1>// The list of current participants</span>
<span class=kt>address</span><span class=p>[]</span><span class=w> </span><span class=kt>public</span><span class=w> </span>participants<span class=p>;</span>

<span class=c1>// The current amount of token at stake in the lottery</span>
<span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>jackpot</span><span class=p>;</span>

<span class=c1>// the owner of the contract</span>
<span class=kt>address</span><span class=w> </span><span class=nv>owner</span><span class=p>;</span>

<span class=c1>// Which randomness source to use. This correlates to the values in the</span>
<span class=c1>// RandomnessSource enum in the Randomness Precompile</span>
Randomness<span class=p>.</span>RandomnessSource<span class=w> </span>randomnessSource<span class=p>;</span>
</code></pre></div> <h3 id=create-constructor>Create the Constructor<a class=headerlink href=#create-constructor title="Permanent link">&para;</a></h3> <p>Now that we have completed the initial set up of all of the variables required for the lottery, we can start to code the functions that will bring the lottery to life. First, we'll start off by creating a constructor function.</p> <p>The constructor will accept a <em>uint8</em> as the randomness source, which corresponds to the index of the type of randomness defined in the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/Randomness.sol#L44-L47 target=_blank><code>RandomnessSource</code> enum</a>, located in the Randomness Precompile. So, we can either pass in <code>0</code> for local VRF or <code>1</code> for BABE epoch randomness. It will also be <code>payable</code>, as we'll submit the deposit at the time of deployment and will be used to perform the randomness request later on.</p> <p>The <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/Randomness.sol#L17 target=_blank>deposit</a> is defined in the Randomness Precompile and is required in addition to the fulfillment fee. The deposit will be refunded to the original requester, which in our case is the owner of the contract, after the request has been fulfilled. If a request never gets fulfilled, it will expire and need to be purged. Once it is purged, the deposit will be returned.</p> <div class=highlight><pre><span></span><code><span class=kt>constructor</span><span class=p>(</span>
<span class=w>    </span>Randomness<span class=p>.</span>RandomnessSource<span class=w> </span>source
<span class=p>)</span><span class=w> </span><span class=kt>payable</span><span class=w> </span>RandomnessConsumer<span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Because this contract can only perform one randomness request at a time,</span>
<span class=w>    </span><span class=c1>// we only need to have one required deposit</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=nv>requiredDeposit</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requiredDeposit<span class=p>();</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=k>msg.value</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span>requiredDeposit<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Deposit too Low&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=c1>// Update parameters</span>
<span class=w>    </span>randomnessSource<span class=w> </span><span class=o>=</span><span class=w> </span>source<span class=p>;</span>
<span class=w>    </span>owner<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>msg.sender</span><span class=p>;</span>
<span class=w>    </span>globalRequestCount<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>    </span>jackpot<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>    </span><span class=c1>// Set the requestId to the maximum allowed value by the precompile (64 bits)</span>
<span class=w>    </span>requestId<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">2</span><span class=w> </span><span class=o>**</span><span class=w> </span><span class="m m-Decimal">64</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class="m m-Decimal">1</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <h3 id=participate-logic>Add Logic to Participate in the Lottery<a class=headerlink href=#participate-logic title="Permanent link">&para;</a></h3> <p>Next we can create the function that will allow users to participate in the lottery. The <code>participate</code> function will be <code>payable</code> as each participant will need to submit a participation fee.</p> <p>The <code>participate</code> function will include the following logic:</p> <ul> <li>Check that the lottery hasn't started yet using the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/Randomness.sol#L96-L99 target=_blank><code>getRequestStatus</code> function</a> of the Randomness Precompile. This function returns the status as defined by the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/Randomness.sol#L34-L39 target=_blank><code>RequestStatus</code> enum</a>. If the status is anything other than <code>DoesNotExist</code>, then the lottery has already been started</li> <li>Check that the participation fee meets the requirement</li> <li>If both of the above are true, then the participant will be added to the list of participants and their participation fee will be added to the jackpot</li> </ul> <div class=highlight><pre><span></span><code><span class=kt>function</span><span class=w> </span><span class=nv>participate</span><span class=p>()</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>payable</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// We check that the lottery hasn&#39;t started yet</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span>randomness<span class=p>.</span>getRequestStatus<span class=p>(</span>requestId<span class=p>)</span><span class=w> </span><span class=o>!=</span>
<span class=w>        </span>Randomness<span class=p>.</span>RequestStatus<span class=p>.</span>DoesNotExist
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Request already initiated&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=c1>// Each player must submit a fee to participate, which is added to</span>
<span class=w>    </span><span class=c1>// the jackpot</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=k>msg.value</span><span class=w> </span><span class=o>!=</span><span class=w> </span>PARTICIPATION_FEE<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Invalid participation fee&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span>participants<span class=p>.</span>push<span class=p>(</span><span class=k>msg.sender</span><span class=p>);</span>
<span class=w>    </span>jackpot<span class=w> </span><span class=o>+=</span><span class=w> </span><span class=k>msg.value</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <div class="admonition challenge"> <p class=admonition-title>Challenge</p> <p>In the above function, we check that the lottery hasn't started yet, but what if we want to know the exact status of the lottery? Create a function that solves this problem and returns the status of the lottery.</p> </div> <h3 id=start-lottery-logic>Add Logic to Start the Lottery and Request Randomness<a class=headerlink href=#start-lottery-logic title="Permanent link">&para;</a></h3> <p>The logic for starting the lottery contains a crucial component: requesting randomness. As previously mentioned, only the owner of the lottery contract will be able to start the lottery. As such, the owner will need to submit the fulfillment fee for the request.</p> <p>The <code>startLottery</code> function will include the following logic:</p> <ul> <li>Check that the lottery hasn't started yet, as we did in the <code>participate</code> function</li> <li>Check that there is an acceptable number of participants</li> <li>Check that the fulfillment fee meets the minimum requirements</li> <li>Check that the balance of the contract is enough to pay for the deposit. Remember how the constructor accepts the request deposit? That deposit is stored in the contract until this function is called</li> <li>If all of the above are true, we submit the randomness request via the Randomness Precompile along with the fulfillment fee. Depending on the source of randomness, either the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/Randomness.sol#L110-L167 target=_blank><code>requestLocalVRFRandomWords</code> or the <code>requestRelayBabeEpochRandomWords</code> function</a> of the Randomness Precompile will be called along with the following parameters:<ul> <li>The address where excess fees will be refunded to</li> <li>The fulfillment fee</li> <li>The gas limit to use for the fulfillment</li> <li>The salt, which is a string that is mixed with the randomness seed to obtain different random words. The <code>globalRequestCount</code> is used to ensure uniqueness</li> <li>The number of random words requested, which is based off the number of winners that will be selected</li> <li>(For local VRF only) The delay, which is the number of blocks that must pass before the request can be fulfilled</li> </ul> </li> </ul> <p>Since the lottery function should only be called by the owner, we'll also add in an <code>onlyOwner</code> modifier that requires the <code>msg.sender</code> to be the <code>owner</code>.</p> <div class=highlight><pre><span></span><code><span class=kt>function</span><span class=w> </span><span class=nv>startLottery</span><span class=p>()</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>payable</span><span class=w> </span>onlyOwner<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Check we haven&#39;t started the randomness request yet</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span>randomness<span class=p>.</span>getRequestStatus<span class=p>(</span>requestId<span class=p>)</span><span class=w> </span><span class=o>!=</span>
<span class=w>        </span>Randomness<span class=p>.</span>RequestStatus<span class=p>.</span>DoesNotExist
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Request already initiated&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=c1>// Check that the number of participants is acceptable</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>participants<span class=p>.</span>length<span class=w> </span><span class=o>&lt;</span><span class=w> </span>MIN_PARTICIPANTS<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Not enough participants&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>participants<span class=p>.</span>length<span class=w> </span><span class=o>&gt;=</span><span class=w> </span>MAX_PARTICIPANTS<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Too many participants&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=c1>// Check the fulfillment fee is enough</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=nv>fee</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>msg.value</span><span class=p>;</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>fee<span class=w> </span><span class=o>&lt;</span><span class=w> </span>MIN_FEE<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Not enough fee&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=c1>// Check there is enough balance on the contract to pay for the deposit.</span>
<span class=w>    </span><span class=c1>// This would fail only if the deposit amount required is changed in the</span>
<span class=w>    </span><span class=c1>// Randomness Precompile.</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=nv>requiredDeposit</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requiredDeposit<span class=p>();</span>
<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=kt>this</span><span class=p>).</span>balance<span class=w> </span><span class=o>&lt;</span><span class=w> </span>jackpot<span class=w> </span><span class=o>+</span><span class=w> </span>requiredDeposit<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>revert<span class=p>(</span><span class=s2>&quot;Deposit too low&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>randomnessSource<span class=w> </span><span class=o>==</span><span class=w> </span>Randomness<span class=p>.</span>RandomnessSource<span class=p>.</span>LocalVRF<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Request random words using local VRF randomness</span>
<span class=w>        </span>requestId<span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requestLocalVRFRandomWords<span class=p>(</span>
<span class=w>            </span><span class=k>msg.sender</span><span class=p>,</span>
<span class=w>            </span>fee<span class=p>,</span>
<span class=w>            </span>FULFILLMENT_GAS_LIMIT<span class=p>,</span>
<span class=w>            </span>SALT_PREFIX<span class=w> </span><span class=o>^</span><span class=w> </span><span class=kt>bytes32</span><span class=p>(</span>globalRequestCount<span class=o>++</span><span class=p>),</span>
<span class=w>            </span>NUM_WINNERS<span class=p>,</span>
<span class=w>            </span>VRF_BLOCKS_DELAY
<span class=w>        </span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=kt>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Requesting random words using BABE Epoch randomness</span>
<span class=w>        </span>requestId<span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requestRelayBabeEpochRandomWords<span class=p>(</span>
<span class=w>            </span><span class=k>msg.sender</span><span class=p>,</span>
<span class=w>            </span>fee<span class=p>,</span>
<span class=w>            </span>FULFILLMENT_GAS_LIMIT<span class=p>,</span>
<span class=w>            </span>SALT_PREFIX<span class=w> </span><span class=o>^</span><span class=w> </span><span class=kt>bytes32</span><span class=p>(</span>globalRequestCount<span class=o>++</span><span class=p>),</span>
<span class=w>            </span>NUM_WINNERS
<span class=w>        </span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>modifier</span><span class=w> </span>onlyOwner<span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>require</span><span class=p>(</span><span class=k>msg.sender</span><span class=w> </span><span class=o>==</span><span class=w> </span>owner<span class=p>);</span>
<span class=w>    </span>_<span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <h3 id=fulfill-randomness-logic>Add Logic to Fulfill the Randomness Request<a class=headerlink href=#fulfill-randomness-logic title="Permanent link">&para;</a></h3> <p>In this section, we'll be adding in two functions required to request fulfillment and handle the result of the fulfillment: <code>fulfillRequest</code> and <code>fulfillRandomWords</code>.</p> <p>Our <code>fulfillRequest</code> function will call the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/Randomness.sol#L173 target=_blank><code>fulfillRequest</code> method</a> of the Randomness Precompile. When this method is called, under the hood the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/RandomnessConsumer.sol#L114-L125 target=_blank><code>rawFulfillRandomWords</code> method</a> of the Randomness Consumer is called, which will verify that the call originated from the Randomness Precompile. From there, the <a href=https://github.com/moonbeam-foundation/moonbeam/blob/master/precompiles/randomness/RandomnessConsumer.sol#L107-L109 target=_blank><code>fulfillRandomWords</code> function</a> of the Randomness Consumer contract is called and the requested number of random words are computed using the block's randomness result and a given salt, and then it is returned. If the fulfillment was successful, the <code>FulfillmentSucceeded</code> event will be emitted; otherwise, the <code>FulfillmentFailed</code> event will be emitted.</p> <p>For fulfilled requests, the cost of execution will be refunded from the request fee to the caller of <code>fulfillRequest</code>. Then any excess fees and the request deposit are transferred to the specified refund address.</p> <p>Our <code>fulfillRandomWords</code> function defines a callback, the <code>pickWinners</code> function, that is responsible for handling the fulfillment. So, in our case, the callback will use the random words to select a winner and payout the winnings. The signature of our <code>fulfillRandomWords</code> function must match the signature of the Randomness Consumer's <code>fulfillRandomWords</code> function.</p> <div class=highlight><pre><span></span><code><span class=kt>function</span><span class=w> </span><span class=nv>fulfillRequest</span><span class=p>()</span><span class=w> </span><span class=kt>public</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span>randomness<span class=p>.</span>fulfillRequest<span class=p>(</span>requestId<span class=p>);</span>
<span class=p>}</span>

<span class=kt>function</span><span class=w> </span><span class=nv>fulfillRandomWords</span><span class=p>(</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=cm>/* requestId */</span><span class=p>,</span>
<span class=w>    </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>randomWords
<span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span>override<span class=w> </span><span class=p>{</span>
<span class=w>    </span>pickWinners<span class=p>(</span>randomWords<span class=p>);</span>
<span class=p>}</span>
</code></pre></div> <p>We'll create the logic for the <code>pickWinners</code> function in the next section.</p> <div class="admonition challenge"> <p class=admonition-title>Challenge</p> <p>What if gas prices change significantly before we request the fulfillment, and as a result this function fails? Currently, we wouldn't be able to increase the fulfillment fee. Create a function that solves this problem and allows us to increase the fulfillment fee.</p> </div> <h3 id=pick-winners-logic>Add Logic to Pick the Lottery Winners<a class=headerlink href=#pick-winners-logic title="Permanent link">&para;</a></h3> <p>The last step for our lottery contract will be to create the <code>pickWinners</code> function, which, as previously mentioned, is responsible for using the random words to select a winner of the lottery.</p> <p>The <code>pickWinners</code> function contains the following logic:</p> <ul> <li>Determine the number of winners. This is only necessary if you happened to change either the <code>NUM_WINNERS</code> or the number of <code>MIN_PARTICIPANTS</code>, so that the <code>NUM_WINNERS</code> is greater than the <code>MIN_PARTICIPANTS</code></li> <li>Calculate the amount to be awarded to the winners based on the amount in the jackpot and the total number of winners</li> <li>Determine the winners by using the random words</li> <li>Distribute the winnings to each of the winners, making sure to deduct the winnings from the jackpot before transferring them</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>// This function is called only by the fulfillment callback</span>
<span class=kt>function</span><span class=w> </span><span class=nv>pickWinners</span><span class=p>(</span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>randomWords<span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Get the total number of winners to select</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=nv>totalWinners</span><span class=w> </span><span class=o>=</span><span class=w> </span>NUM_WINNERS<span class=w> </span><span class=o>&lt;</span><span class=w> </span>participants<span class=p>.</span>length
<span class=w>        </span><span class=o>?</span><span class=w> </span>NUM_WINNERS
<span class=w>        </span><span class=o>:</span><span class=w> </span>participants<span class=p>.</span>length<span class=p>;</span>

<span class=w>    </span><span class=c1>// The amount distributed to each winner</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=nv>amountAwarded</span><span class=w> </span><span class=o>=</span><span class=w> </span>jackpot<span class=w> </span><span class=o>/</span><span class=w> </span>totalWinners<span class=p>;</span>
<span class=w>    </span><span class=kt>for</span><span class=w> </span><span class=p>(</span><span class=kt>uint32</span><span class=w> </span><span class=nv>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span><span class=w> </span>i<span class=w> </span><span class=o>&lt;</span><span class=w> </span>totalWinners<span class=p>;</span><span class=w> </span>i<span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// This is safe to index randomWords with i because we requested</span>
<span class=w>        </span><span class=c1>// NUM_WINNERS random words</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>randomWord</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomWords<span class=p>[</span>i<span class=p>];</span>

<span class=w>        </span><span class=c1>// Using modulo is not totally fair, but fair enough for this demo</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>index</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomWord<span class=w> </span><span class=o>%</span><span class=w> </span>participants<span class=p>.</span>length<span class=p>;</span>
<span class=w>        </span><span class=kt>address</span><span class=w> </span><span class=nv>payable</span><span class=w> </span>winner<span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>payable</span><span class=p>(</span>participants<span class=p>[</span>index<span class=p>]);</span>
<span class=w>        </span>delete<span class=w> </span>participants<span class=p>[</span>index<span class=p>];</span>
<span class=w>        </span>jackpot<span class=w> </span><span class=o>-=</span><span class=w> </span>amountAwarded<span class=p>;</span>
<span class=w>        </span>winner<span class=p>.</span>transfer<span class=p>(</span>amountAwarded<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>Congratulations! You've gone through the entire process of creating the <code>Lottery.sol</code> contract! You can view the completed version below. Remember, <strong>this contract is for educational purposes only and is not meant for production use.</strong></p> <details class=code> <summary>Lottery.sol</summary> <div class=highlight><pre><span></span><code><span class=c1>// SPDX-License-Identifier: GPL-3.0-only</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=o>&gt;=</span><span class=k>0.8.0</span><span class=p>;</span>

<span class=kt>import</span><span class=w> </span><span class=s2>&quot;./Randomness.sol&quot;</span><span class=p>;</span>
<span class=kt>import</span><span class=w> </span><span class=p>{</span>RandomnessConsumer<span class=p>}</span><span class=w> </span>from<span class=w> </span><span class=s2>&quot;./RandomnessConsumer.sol&quot;</span><span class=p>;</span>

<span class=k>contract</span><span class=w> </span><span class=ni>Lottery</span><span class=w> </span><span class=kt>is</span><span class=w> </span>RandomnessConsumer<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Randomness Precompile interface</span>
<span class=w>    </span>Randomness<span class=w> </span><span class=kt>public</span><span class=w> </span>randomness<span class=w> </span><span class=o>=</span>
<span class=w>        </span>Randomness<span class=p>(</span><span class=mh>0x0000000000000000000000000000000000000809</span><span class=p>);</span>

<span class=w>    </span><span class=c1>// The number of winners. This number corresponds to how many random words</span>
<span class=w>    </span><span class=c1>// will be requested. Cannot exceed MAX_RANDOM_WORDS (from the Randomness</span>
<span class=w>    </span><span class=c1>// Precompile)</span>
<span class=w>    </span><span class=kt>uint8</span><span class=w> </span><span class=k>public </span><span class=nv>NUM_WINNERS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">2</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// The number of blocks before the request can be fulfilled (for Local VRF</span>
<span class=w>    </span><span class=c1>// randomness). The MIN_VRF_BLOCKS_DELAY (from the Randomness Precompile)</span>
<span class=w>    </span><span class=c1>// provides a minimum number that is safe enough for games with low economical</span>
<span class=w>    </span><span class=c1>// value at stake. Increasing the delay slightly reduces the probability</span>
<span class=w>    </span><span class=c1>// (already very low) of a collator being able to predict the pseudo-random number</span>
<span class=w>    </span><span class=kt>uint32</span><span class=w> </span><span class=k>public </span><span class=nv>VRF_BLOCKS_DELAY</span><span class=w> </span><span class=o>=</span><span class=w> </span>MIN_VRF_BLOCKS_DELAY<span class=p>;</span>

<span class=w>    </span><span class=c1>// The minimum number of participants to start the lottery</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>MIN_PARTICIPANTS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">3</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// The maximum number of participants allowed to participate. It is important</span>
<span class=w>    </span><span class=c1>// to limit the total jackpot (by limiting the number of participants) to</span>
<span class=w>    </span><span class=c1>// guarantee the economic incentive of a collator to avoid trying to influence</span>
<span class=w>    </span><span class=c1>// the pseudo-random. (See Randomness.sol for more details)</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>MAX_PARTICIPANTS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">20</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// The fee needed to participate in the lottery. Will go into the jackpot</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>PARTICIPATION_FEE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">100000</span><span class=w> </span>gwei<span class=p>;</span>

<span class=w>    </span><span class=c1>// The gas limit allowed to be used for the fulfillment, which depends on the</span>
<span class=w>    </span><span class=c1>// code that is executed and the number of words requested. Test and adjust</span>
<span class=w>    </span><span class=c1>// this limit based on the size of the request and the processing of the</span>
<span class=w>    </span><span class=c1>// callback request in the fulfillRandomWords() function</span>
<span class=w>    </span><span class=kt>uint64</span><span class=w> </span><span class=k>public </span><span class=nv>FULFILLMENT_GAS_LIMIT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">100000</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// The minimum fee needed to start the lottery. This does not guarantee that</span>
<span class=w>    </span><span class=c1>// there will be enough fee to pay for the gas used by the fulfillment.</span>
<span class=w>    </span><span class=c1>// Ideally it should be over-estimated considering possible fluctuation of</span>
<span class=w>    </span><span class=c1>// the gas price. Additional fee will be refunded to the caller</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>MIN_FEE</span><span class=w> </span><span class=o>=</span><span class=w> </span>FULFILLMENT_GAS_LIMIT<span class=w> </span><span class=o>*</span><span class=w> </span><span class="m m-Decimal">150</span><span class=w> </span>gwei<span class=p>;</span>

<span class=w>    </span><span class=c1>// A string used to allow having different salt than other contracts</span>
<span class=w>    </span><span class=kt>bytes32</span><span class=w> </span><span class=k>public </span><span class=nv>SALT_PREFIX</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;INSERT_ANY_STRING_FOR_SALT&quot;</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// Stores the global number of requests submitted. This number is used as a</span>
<span class=w>    </span><span class=c1>// salt to make each request unique</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>globalRequestCount</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// The current request id</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>requestId</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// The list of current participants</span>
<span class=w>    </span><span class=kt>address</span><span class=p>[]</span><span class=w> </span><span class=kt>public</span><span class=w> </span>participants<span class=p>;</span>

<span class=w>    </span><span class=c1>// The current amount of token at stake in the lottery</span>
<span class=w>    </span><span class=kt>uint256</span><span class=w> </span><span class=k>public </span><span class=nv>jackpot</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// the owner of the contract</span>
<span class=w>    </span><span class=kt>address</span><span class=w> </span><span class=nv>owner</span><span class=p>;</span>

<span class=w>    </span><span class=c1>// Which randomness source to use. This correlates to the values in the</span>
<span class=w>    </span><span class=c1>// RandomnessSource enum in the Randomness Precompile</span>
<span class=w>    </span>Randomness<span class=p>.</span>RandomnessSource<span class=w> </span>randomnessSource<span class=p>;</span>

<span class=w>    </span><span class=kt>constructor</span><span class=p>(</span>
<span class=w>        </span>Randomness<span class=p>.</span>RandomnessSource<span class=w> </span>source
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>payable</span><span class=w> </span>RandomnessConsumer<span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Because this contract can only perform one randomness request at a time,</span>
<span class=w>        </span><span class=c1>// we only need to have one required deposit</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>requiredDeposit</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requiredDeposit<span class=p>();</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=k>msg.value</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span>requiredDeposit<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Deposit too Low&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=c1>// Update parameters</span>
<span class=w>        </span>randomnessSource<span class=w> </span><span class=o>=</span><span class=w> </span>source<span class=p>;</span>
<span class=w>        </span>owner<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>msg.sender</span><span class=p>;</span>
<span class=w>        </span>globalRequestCount<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>        </span>jackpot<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>        </span><span class=c1>// Set the requestId to the maximum allowed value by the precompile (64 bits)</span>
<span class=w>        </span>requestId<span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">2</span><span class=w> </span><span class=o>**</span><span class=w> </span><span class="m m-Decimal">64</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class="m m-Decimal">1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>participate</span><span class=p>()</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>payable</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// We check that the lottery hasn&#39;t started yet</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span>randomness<span class=p>.</span>getRequestStatus<span class=p>(</span>requestId<span class=p>)</span><span class=w> </span><span class=o>!=</span>
<span class=w>            </span>Randomness<span class=p>.</span>RequestStatus<span class=p>.</span>DoesNotExist
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Request already initiated&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=c1>// Each player must submit a fee to participate, which is added to</span>
<span class=w>        </span><span class=c1>// the jackpot</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=k>msg.value</span><span class=w> </span><span class=o>!=</span><span class=w> </span>PARTICIPATION_FEE<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Invalid participation fee&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span>participants<span class=p>.</span>push<span class=p>(</span><span class=k>msg.sender</span><span class=p>);</span>
<span class=w>        </span>jackpot<span class=w> </span><span class=o>+=</span><span class=w> </span><span class=k>msg.value</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>startLottery</span><span class=p>()</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>payable</span><span class=w> </span>onlyOwner<span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Check we haven&#39;t started the randomness request yet</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span>randomness<span class=p>.</span>getRequestStatus<span class=p>(</span>requestId<span class=p>)</span><span class=w> </span><span class=o>!=</span>
<span class=w>            </span>Randomness<span class=p>.</span>RequestStatus<span class=p>.</span>DoesNotExist
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Request already initiated&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=c1>// Check that the number of participants is acceptable</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>participants<span class=p>.</span>length<span class=w> </span><span class=o>&lt;</span><span class=w> </span>MIN_PARTICIPANTS<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Not enough participants&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>participants<span class=p>.</span>length<span class=w> </span><span class=o>&gt;=</span><span class=w> </span>MAX_PARTICIPANTS<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Too many participants&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=c1>// Check the fulfillment fee is enough</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>fee</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>msg.value</span><span class=p>;</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>fee<span class=w> </span><span class=o>&lt;</span><span class=w> </span>MIN_FEE<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Not enough fee&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=c1>// Check there is enough balance on the contract to pay for the deposit.</span>
<span class=w>        </span><span class=c1>// This would fail only if the deposit amount required is changed in the</span>
<span class=w>        </span><span class=c1>// Randomness Precompile.</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>requiredDeposit</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requiredDeposit<span class=p>();</span>
<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=kt>this</span><span class=p>).</span>balance<span class=w> </span><span class=o>&lt;</span><span class=w> </span>jackpot<span class=w> </span><span class=o>+</span><span class=w> </span>requiredDeposit<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span>revert<span class=p>(</span><span class=s2>&quot;Deposit too low&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>randomnessSource<span class=w> </span><span class=o>==</span><span class=w> </span>Randomness<span class=p>.</span>RandomnessSource<span class=p>.</span>LocalVRF<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=c1>// Request random words using local VRF randomness</span>
<span class=w>            </span>requestId<span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requestLocalVRFRandomWords<span class=p>(</span>
<span class=w>                </span><span class=k>msg.sender</span><span class=p>,</span>
<span class=w>                </span>fee<span class=p>,</span>
<span class=w>                </span>FULFILLMENT_GAS_LIMIT<span class=p>,</span>
<span class=w>                </span>SALT_PREFIX<span class=w> </span><span class=o>^</span><span class=w> </span><span class=kt>bytes32</span><span class=p>(</span>globalRequestCount<span class=o>++</span><span class=p>),</span>
<span class=w>                </span>NUM_WINNERS<span class=p>,</span>
<span class=w>                </span>VRF_BLOCKS_DELAY
<span class=w>            </span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span><span class=w> </span><span class=kt>else</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=c1>// Requesting random words using BABE Epoch randomness</span>
<span class=w>            </span>requestId<span class=w> </span><span class=o>=</span><span class=w> </span>randomness<span class=p>.</span>requestRelayBabeEpochRandomWords<span class=p>(</span>
<span class=w>                </span><span class=k>msg.sender</span><span class=p>,</span>
<span class=w>                </span>fee<span class=p>,</span>
<span class=w>                </span>FULFILLMENT_GAS_LIMIT<span class=p>,</span>
<span class=w>                </span>SALT_PREFIX<span class=w> </span><span class=o>^</span><span class=w> </span><span class=kt>bytes32</span><span class=p>(</span>globalRequestCount<span class=o>++</span><span class=p>),</span>
<span class=w>                </span>NUM_WINNERS
<span class=w>            </span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>fulfillRequest</span><span class=p>()</span><span class=w> </span><span class=kt>public</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>randomness<span class=p>.</span>fulfillRequest<span class=p>(</span>requestId<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>fulfillRandomWords</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=cm>/* requestId */</span><span class=p>,</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>randomWords
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span>override<span class=w> </span><span class=p>{</span>
<span class=w>        </span>pickWinners<span class=p>(</span>randomWords<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=c1>// This function is called only by the fulfillment callback</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>pickWinners</span><span class=p>(</span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>randomWords<span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Get the total number of winners to select</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>totalWinners</span><span class=w> </span><span class=o>=</span><span class=w> </span>NUM_WINNERS<span class=w> </span><span class=o>&lt;</span><span class=w> </span>participants<span class=p>.</span>length
<span class=w>            </span><span class=o>?</span><span class=w> </span>NUM_WINNERS
<span class=w>            </span><span class=o>:</span><span class=w> </span>participants<span class=p>.</span>length<span class=p>;</span>

<span class=w>        </span><span class=c1>// The amount distributed to each winner</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>amountAwarded</span><span class=w> </span><span class=o>=</span><span class=w> </span>jackpot<span class=w> </span><span class=o>/</span><span class=w> </span>totalWinners<span class=p>;</span>
<span class=w>        </span><span class=kt>for</span><span class=w> </span><span class=p>(</span><span class=kt>uint32</span><span class=w> </span><span class=nv>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span><span class=w> </span>i<span class=w> </span><span class=o>&lt;</span><span class=w> </span>totalWinners<span class=p>;</span><span class=w> </span>i<span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=c1>// This is safe to index randomWords with i because we requested</span>
<span class=w>            </span><span class=c1>// NUM_WINNERS random words</span>
<span class=w>            </span><span class=kt>uint256</span><span class=w> </span><span class=nv>randomWord</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomWords<span class=p>[</span>i<span class=p>];</span>

<span class=w>            </span><span class=c1>// Using modulo is not totally fair, but fair enough for this demo</span>
<span class=w>            </span><span class=kt>uint256</span><span class=w> </span><span class=nv>index</span><span class=w> </span><span class=o>=</span><span class=w> </span>randomWord<span class=w> </span><span class=o>%</span><span class=w> </span>participants<span class=p>.</span>length<span class=p>;</span>
<span class=w>            </span><span class=kt>address</span><span class=w> </span><span class=nv>payable</span><span class=w> </span>winner<span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>payable</span><span class=p>(</span>participants<span class=p>[</span>index<span class=p>]);</span>
<span class=w>            </span>delete<span class=w> </span>participants<span class=p>[</span>index<span class=p>];</span>
<span class=w>            </span>jackpot<span class=w> </span><span class=o>-=</span><span class=w> </span>amountAwarded<span class=p>;</span>
<span class=w>            </span>winner<span class=p>.</span>transfer<span class=p>(</span>amountAwarded<span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>modifier</span><span class=w> </span>onlyOwner<span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>require</span><span class=p>(</span><span class=k>msg.sender</span><span class=w> </span><span class=o>==</span><span class=w> </span>owner<span class=p>);</span>
<span class=w>        </span>_<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </details> <div class="admonition challenge"> <p class=admonition-title>Challenge</p> <p>To make the contract easier to work with, add some events for when a lottery has started, a winner has been chosen, and a winner has been awarded.</p> </div> <h2 id=interact-with-lottery-contract>Interact with the Lottery Contract<a class=headerlink href=#interact-with-lottery-contract title="Permanent link">&para;</a></h2> <p>Now that we've gone through and created our lottery contract, let's deploy it and start a lottery!</p> <h3 id=compile-deploy-lottery-contract>Compile &amp; Deploy the Lottery Contract<a class=headerlink href=#compile-deploy-lottery-contract title="Permanent link">&para;</a></h3> <p>To compile our contracts, you can simply run:</p> <div class=highlight><pre><span></span><code>npx<span class=w> </span>hardhat<span class=w> </span>compile
</code></pre></div> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>npx hardhat compile</span> <span data-ty>Compiled 3 Solidity files successfully</span> <span data-ty=input><span class=file-path></span></span> </div> <p>After compilation, an <code>artifacts</code> directory is created: it holds the bytecode and metadata of the contracts, which are <code>.json</code> files. It’s a good idea to add this directory to your <code>.gitignore</code>.</p> <p>Before we can deploy the <code>Lottery.sol</code> contract, we'll need to create a deployment script.</p> <p>You can create a new directory for the script and name it <code>scripts</code> and add a new file to it called <code>deploy.js</code>:</p> <div class=highlight><pre><span></span><code>mkdir<span class=w> </span>scripts<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>
touch<span class=w> </span>scripts/deploy.js
</code></pre></div> <p>Now to write the deployment script we can use <a href=/moonbeam-mkdocs/builders/ethereum/libraries/ethersjs/ target=_blank><code>ethers</code></a>. Because we'll be running it with Hardhat, we don't need to import any libraries. We can simply take the following steps:</p> <ol> <li>Create a local instance of the lottery contract with the <code>getContractFactory</code> method</li> <li>Get the deposit required for a randomness request using the <code>requiredDeposit</code> function of the Randomness Precompile</li> <li>Use the <code>deploy</code> method that exists within this instance to instantiate the smart contract. You can pass in <code>0</code> to use local VRF randomness or <code>1</code> for BABE epoch randomness. For this example, we'll use local VRF randomness. We'll also need to submit the deposit upon deployment</li> <li>Wait for the deployment by using <code>waitForDeployment</code></li> <li>Once deployed, we can fetch the address of the contract using the contract instance</li> </ol> <div class=highlight><pre><span></span><code><span class=k>async</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// 1. Get the contract to deploy</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>Lottery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>ethers</span><span class=p>.</span><span class=nx>getContractFactory</span><span class=p>(</span><span class=s1>&#39;Lottery&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// 2. Get the required deposit amount from the Randomness Precompile</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>Randomness</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>ethers</span><span class=p>.</span><span class=nx>getContractAt</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;Randomness&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;0x0000000000000000000000000000000000000809&#39;</span>
<span class=w>  </span><span class=p>);</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deposit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>Randomness</span><span class=p>.</span><span class=nx>requiredDeposit</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// 3. Instantiate a new Lottery smart contract that uses local VRF</span>
<span class=w>  </span><span class=c1>// randomness and pass in the required deposit</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>lottery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>Lottery</span><span class=p>.</span><span class=nx>deploy</span><span class=p>(</span><span class=mf>0</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>value</span><span class=o>:</span><span class=w> </span><span class=nx>deposit</span><span class=w> </span><span class=p>});</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Deploying Lottery...&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// 4. Waiting for the deployment to resolve</span>
<span class=w>  </span><span class=k>await</span><span class=w> </span><span class=nx>lottery</span><span class=p>.</span><span class=nx>waitForDeployment</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// 5. Use the contract instance to get the contract address</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Lottery deployed to:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>lottery</span><span class=p>.</span><span class=nx>target</span><span class=p>);</span>
<span class=p>}</span>

<span class=nx>main</span><span class=p>()</span>
<span class=w>  </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mf>0</span><span class=p>))</span>
<span class=w>  </span><span class=p>.</span><span class=k>catch</span><span class=p>((</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span>
<span class=w>  </span><span class=p>});</span>
</code></pre></div> <p>To deploy our lottery contract, we'll use the <code>run</code> command and specify <code>moonbase</code> as the network:</p> <div class=highlight><pre><span></span><code>npx<span class=w> </span>hardhat<span class=w> </span>run<span class=w> </span>--network<span class=w> </span>moonbase<span class=w> </span>scripts/deploy.js
</code></pre></div> <p>If you're using another Moonbeam network, make sure that you specify the correct network. The network name needs to match how it's defined in the <code>hardhat.config.js</code>.</p> <p>After a few seconds, the contract is deployed, and you should see the address in the terminal. Save the address, as we will use it to interact with this contract instance in the next step.</p> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>npx hardhat run --network moonbase scripts/deploy.js</span> <span data-ty>Deploying Lottery...</span> <span data-ty>Lottery deployed to: 0xc20F6c3dd46fBf83fe484AD80E3EffDb26108A12</span> <span data-ty=input><span class=file-path></span></span> </div> <h3 id=participate-in-lottery>Create Scripts to Interact with the Lottery Contract<a class=headerlink href=#participate-in-lottery title="Permanent link">&para;</a></h3> <p>We can continue to work with our Hardhat project and create additional scripts to interact with our lottery contract and call some of it's functions. For example, to participate in the lottery, we can create another script in our <code>scripts</code> directory:</p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>participate.js
</code></pre></div> <p>Then we can add the following code, which will create an instance of the lottery contract using the name of the contract and the contract address. Then we can obtain the participation fee directly from the contract and call the contract's <code>participate</code> function:</p> <div class=highlight><pre><span></span><code><span class=k>async</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>participate</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>lottery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>ethers</span><span class=p>.</span><span class=nx>getContractAt</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;Lottery&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>participationFee</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>lottery</span><span class=p>.</span><span class=nx>PARTICIPATION_FEE</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>tx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>lottery</span><span class=p>.</span><span class=nx>participate</span><span class=p>({</span><span class=w> </span><span class=nx>value</span><span class=o>:</span><span class=w> </span><span class=nx>participationFee</span><span class=w> </span><span class=p>});</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Participation transaction hash:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>tx</span><span class=p>.</span><span class=nx>hash</span><span class=p>);</span>
<span class=p>}</span>

<span class=nx>participate</span><span class=p>()</span>
<span class=w>  </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mf>0</span><span class=p>))</span>
<span class=w>  </span><span class=p>.</span><span class=k>catch</span><span class=p>((</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span>
<span class=w>  </span><span class=p>});</span>
</code></pre></div> <p>To run this script, you can use the following command:</p> <div class=highlight><pre><span></span><code>npx<span class=w> </span>hardhat<span class=w> </span>run<span class=w> </span>--network<span class=w> </span>moonbase<span class=w> </span>scripts/participate.js
</code></pre></div> <p>The transaction hash will be printed to the console. You can use the hash to look up the transaction on <a href=https://moonbase.moonscan.io target=_blank>Moonscan</a>.</p> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>npx hardhat run --network moonbase scripts/participate.js</span> <span data-ty>Participation transaction hash: 0xc16cb530ea6a29eb50a0f05b2328b53fc271cc342391af2c10f3da329c587326</span> <span data-ty=input><span class=file-path></span></span> </div> <p>And that's it! You can feel free to continue creating additional scripts to perform the next steps of the lottery, such as starting the lottery and picking the winners.</p> <div class=page-disclaimer> This tutorial is for educational purposes only. As such, any contracts or code created in this tutorial should not be used in production. </div> <div class=page-disclaimer> The information presented herein has been provided by third parties and is made available solely for general information purposes. Moonbeam does not endorse any project listed and described on the Moonbeam Doc Website (https://docs.moonbeam.network/). Moonbeam Foundation does not warrant the accuracy, completeness or usefulness of this information. Any reliance you place on such information is strictly at your own risk. Moonbeam Foundation disclaims all liability and responsibility arising from any reliance placed on this information by you or by anyone who may be informed of any of its contents. All statements and/or opinions expressed in these materials are solely the responsibility of the person or entity providing those materials and do not necessarily represent the opinion of Moonbeam Foundation. The information should not be construed as professional or financial advice of any kind. Advice from a suitably qualified professional should always be sought in relation to any particular matter or circumstance. The information herein may link to or integrate with other websites operated or content provided by third parties, and such other websites may link to this website. Moonbeam Foundation has no control over any such other websites or their content and will have no liability arising out of or related to such websites or their content. The existence of any such link does not constitute an endorsement of such websites, the content of the websites, or the operators of the websites. These links are being provided to you only as a convenience and you release and hold Moonbeam Foundation harmless from any and all liability arising from your use of this information or the information provided by any third-party website or service. </div> <div class=md-source-file> <small> <span class=source-file-label>Last update:</span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 16, 2025 14:41:49">September 16, 2025</span> <br> <span class=source-file-seperator>|</span> <span class=source-file-label>Created:</span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 16, 2025 14:41:49">September 16, 2025</span> </small> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=footer.title> <a href=../batch-approve-swap/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=122.883px height=122.882px viewbox="0 0 122.883 122.882" enable-background="new 0 0 122.883 122.882" xml:space=preserve><g><path d="M61.441,0c16.967,0,32.327,6.877,43.446,17.996c11.119,11.119,17.996,26.479,17.996,43.445 c0,16.966-6.877,32.326-17.996,43.445c-11.119,11.118-26.479,17.995-43.446,17.995c-16.966,0-32.326-6.877-43.445-17.995 C6.877,93.768,0,78.407,0,61.441c0-16.967,6.877-32.327,17.996-43.445C29.115,6.877,44.475,0,61.441,0L61.441,0z M71.377,42.166 c1.736-1.784,1.695-4.637-0.088-6.372s-4.637-1.696-6.373,0.088L43.078,58.402l3.23,3.142l-3.244-3.146 c-1.737,1.792-1.693,4.652,0.099,6.39c0.052,0.05,0.104,0.099,0.158,0.146l21.595,22.082c1.736,1.784,4.59,1.823,6.373,0.088 c1.783-1.734,1.824-4.588,0.088-6.372L52.598,61.531L71.377,42.166L71.377,42.166z M98.496,24.386 C89.014,14.903,75.912,9.038,61.441,9.038s-27.572,5.865-37.055,15.348C14.903,33.869,9.038,46.97,9.038,61.441 c0,14.471,5.865,27.572,15.349,37.055c9.482,9.483,22.583,15.349,37.055,15.349s27.573-5.865,37.055-15.349 c9.484-9.482,15.35-22.584,15.35-37.055C113.846,46.97,107.98,33.869,98.496,24.386L98.496,24.386z"/></g></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <span class=md-footer__page-name> [Batch] Approve & Swap Tokens in a Single Transaction </span> </div> </a> <a href=../call-permit-gasless-txs/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <span class=md-footer__page-name> [Call Permit] Send Gasless Transactions </span> </div> <div class="md-footer__button md-icon"> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=122.883px height=122.882px viewbox="0 0 122.883 122.882" enable-background="new 0 0 122.883 122.882" xml:space=preserve><g><path d="M61.441,0C44.475,0,29.115,6.877,17.996,17.996C6.877,29.115,0,44.475,0,61.441c0,16.966,6.877,32.326,17.996,43.445 c11.119,11.118,26.479,17.995,43.445,17.995c16.967,0,32.327-6.877,43.446-17.995c11.119-11.119,17.996-26.479,17.996-43.445 c0-16.967-6.877-32.327-17.996-43.445C93.768,6.877,78.408,0,61.441,0L61.441,0z M51.505,42.166 c-1.735-1.784-1.696-4.637,0.088-6.372c1.784-1.735,4.637-1.696,6.373,0.088l21.839,22.521l-3.23,3.142l3.244-3.146 c1.738,1.792,1.693,4.652-0.098,6.39c-0.053,0.05-0.105,0.099-0.158,0.146L57.966,87.017c-1.735,1.784-4.588,1.823-6.373,0.088 c-1.784-1.734-1.823-4.588-0.088-6.372l18.78-19.201L51.505,42.166L51.505,42.166z M24.386,24.386 C33.869,14.903,46.97,9.038,61.441,9.038c14.471,0,27.573,5.865,37.055,15.348c9.484,9.483,15.35,22.584,15.35,37.056 c0,14.471-5.865,27.572-15.35,37.055c-9.482,9.483-22.584,15.349-37.055,15.349c-14.471,0-27.572-5.865-37.055-15.349 C14.903,89.014,9.038,75.912,9.038,61.441C9.038,46.97,14.903,33.869,24.386,24.386L24.386,24.386z"/></g></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="column llms-wrapper"> <p class=llms-title> AI-Compatible Docs </p> <div class=llms-options> <a class=llms-link href=/llms.txt>llms.txt</a> <a class=llms-link href=/llms-full.txt>llms-full.txt</a> <a href=/ai-resources/ai-resources/ class=llms-link>LLMs By Topic</a> </div> </div> <div class="column social"> <div class=md-social> <a href=https://discord.com/invite/PfpUATX target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://t.me/Moonbeam_Official target=_blank rel=noopener title=Telegram class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg> </a> <a href=https://twitter.com/MoonbeamNetwork target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://www.youtube.com/c/MoonbeamNetwork target=_blank rel=noopener title=YouTube class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg> </a> <a href=https://github.com/moonbeam-foundation/moonbeam target=_blank rel=noopener title=GitHub class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> <div class=md-footer-copyright> <div class=copyright-wrapper> <div class=md-footer-copyright__highlight> © 2025 Moonbeam Foundation. All Rights Reserved. </div> <div class=papermoon> <span> Made with 🩵 by <a href=https://papermoon.io/ target=_blank>PaperMoon</a> </span> </div> <div class=policy-links> <a href=https://moonbeam.network/terms-of-use target=_blank>Terms of use</a> <a href=https://moonbeam.network/privacy-policy target=_blank>Privacy policy</a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <form class="md-consent__form md-grid md-typeset"><div class=cookie-logo> <img src=../../..assets/images/Moonbeam_Icon_White.webp alt="Moonbeam logo for Cookie consent"> </div><div class=cookie-content> <h4>This website uses cookies</h4> <p>We use essential cookies to make the website work. We would also like to use cookies to understand how you use the website and how you interact with certain features. We may share this information with our analytics partners. For further details, please see our <a href=https://moonbeam.network/cookie-policy target=_blank rel=noopener>cookie policy</a>. </p><input class=md-toggle type=checkbox id=__settings><div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> </ul> </div> </div><div class="cookie-buttons md-consent__controls"> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> <button type=reset class="md-button md-button--secondary">Reject</button> </div> </form> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "navigation.prune", "content.code.copy", "announce.dismiss", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.56ea9cef.min.js></script> <script src=../../../js/connectMetaMask.min.js></script> <script src=../../../js/errorModal.min.js></script> <script src=../../../js/networkModal.min.js></script> <script src=../../../js/handleLanguageChange.min.js></script> <script src=../../../js/fixCreatedDate.min.js></script> <script src=../../../js/externalLinkModal.min.js></script> <script src=../../../js/cookbookInit.min.js></script> <script src=../../../js/clipboardCopyllms.min.js></script> <script src=../../../js/cookbookEventHandler.js></script> <script>
    document.addEventListener('DOMContentLoaded', () => {
      const copyTxtFile = async (url) => {
        try {
            const response = await fetch(url);
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            const text = await response.text();
            await navigator.clipboard.writeText(text);

            const copiedToClipboard = document.querySelector('.md-dialog');
            if (copiedToClipboard) {
              copiedToClipboard.classList.add('md-dialog--active');

              const copiedToClipboardMessage =
                copiedToClipboard.querySelector('.md-dialog__inner');
              if (
                copiedToClipboardMessage &&
                copiedToClipboardMessage.textContent !==
                  "Copied to clipboard"
              ) {
                copiedToClipboardMessage.textContent =
                  "Copied to clipboard";
              }
              // Set a timer to remove the after 2 seconds (2000ms)
              setTimeout(() => {
                copiedToClipboard.classList.remove('md-dialog--active');
              }, 2000);
            }
          } catch (err) {
            console.error('Failed to copy:', err);
            const copiedToClipboard = document.querySelector('.md-dialog');
            if (copiedToClipboard) {
              copiedToClipboard.classList.remove('md-dialog--active');
            }
          }
      }

      document.querySelectorAll('.llms').forEach(button => {
        button.addEventListener('click', (event) => {
          event.preventDefault(); // Prevent default link behavior

          const action = button.getAttribute('data-action');
          const fileName = button.getAttribute('data-value');
          if (!fileName) return; // Exit if no file name is found

          // Add 'llms-files/' prefix except for root-level llms.txt and llms-full.txt
          const filePath = (fileName === "llms.txt" || fileName === "llms-full.txt") 
            ? fileName 
            : `llms-files/${fileName}`;
          const url = `https://docs.moonbeam.network/${filePath}`;

          if (action === 'copy') {
            copyTxtFile(url);
          }
        })
      })
    });
  </script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>