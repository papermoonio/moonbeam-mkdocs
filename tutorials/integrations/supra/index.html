<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In this step-by-step tutorial, learn about Supra's pull model and how to use their price feeds to fetch price data in smart contracts on Moonbeam."><link href=https://docs.moonbeam.network/tutorials/integrations/supra/ rel=canonical><link href=../oracles.index/ rel=prev><link href=../0xgasless/ rel=next><link rel=icon href=../../../assets/images/favicon.webp><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.15"><title>Supra Oracles | Moonbeam Docs</title><link rel=stylesheet href=../../../assets/stylesheets/main.342714a4.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@cookbookdev/docsbot/dist/standalone/index.cjs.js as=script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Banana+Grotesk:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Banana Grotesk";--md-code-font:"Roboto Mono"}</style><link rel=preconnect href=https://fonts.googleapis.com><link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel=stylesheet><link rel=stylesheet href=../../../assets/stylesheets/moonbeam.min.css><link rel=stylesheet href=../../../assets/stylesheets/termynal.min.css><link rel=stylesheet href=../../../assets/stylesheets/timeline-neoteroi.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-5ZBERCXWC3"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-5ZBERCXWC3",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-5ZBERCXWC3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#fetching-price-data-with-supra-oracles class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <div class=md-header__left-nav> <a href=https://docs.moonbeam.network/ title="Moonbeam Docs" class="md-header__button md-logo" aria-label="Moonbeam Docs"> <img src=../../../assets/images/logo.webp alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> </div> <div class=md-header__buttons> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../builders/ >Builders</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../builders/get-started/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/get-started.webp alt="Get Started" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Get Started</span> <p class=dropdown-desc>Everything you need to get started building</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/ethereum/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/ethereum.webp alt="Ethereum Toolkit" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Ethereum Toolkit</span> <p class=dropdown-desc>Ethereum libraries, tools, and contracts</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/substrate/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/substrate.webp alt="Substrate Toolkit" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Substrate Toolkit</span> <p class=dropdown-desc>Substrate libraries, tools, and low-level interfaces</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/interoperability/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/interoperability.webp alt=Interoperability loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Interoperability</span> <p class=dropdown-desc>GMP protocols for cross-chain development</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../builders/integrations/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/integrations.webp alt=Integrate loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Integrate</span> <p class=dropdown-desc>Tools and protocols to integrate with</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../node-operators/ >Node Operators</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../node-operators/networks/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/networks.webp alt=Networks loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Networks</span> <p class=dropdown-desc>Run full, tracing, or collator nodes</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../tokens/ >Tokens</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../tokens/connect/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/connect.webp alt="Connect to Moonbeam" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Connect to Moonbeam</span> <p class=dropdown-desc>Connect your wallet to Moonbeam</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../tokens/manage/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/manage.webp alt="Account Management" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Account Management</span> <p class=dropdown-desc>Advanced account and identity services</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../tokens/staking/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/staking.webp alt=Staking loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Staking</span> <p class=dropdown-desc>Stake tokens by delegating to collators</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../tokens/governance/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/governance.webp alt=Governance loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Governance</span> <p class=dropdown-desc>Submit and vote on on-chain proposals</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../../learn/ >Learn</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../../learn/platform/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/platform.webp alt=Platform loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Platform</span> <p class=dropdown-desc>Dive into underlying technology and design aspects</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../learn/core-concepts/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/core-concepts.webp alt="Core Concepts" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Core Concepts</span> <p class=dropdown-desc>Learn about the fundamentals of Moonbeam</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../learn/features/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/features.webp alt=Features loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Features</span> <p class=dropdown-desc>Explore core features</p> </div> </a> </li> <li class=md-tab__item> <a href=../../../learn/dapp-directory/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/dapp-directory.webp alt="DApp Directory" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>DApp Directory</span> <p class=dropdown-desc>Explore the DApp Directory and listing process</p> </div> </a> </li> </ul> </li> <li class=md-tabs__item--custom tabindex=0> <span class=md-tabs__link> <a href=../../ >Tutorials</a> </span> <ul class=md-tab__list> <li class=md-tab__item> <a href=../../interoperability/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/interoperability.webp alt=Interoperability loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Interoperability</span> <p class=dropdown-desc>Get hands-on building cross-chain DApps</p> </div> </a> </li> <li class=md-tab__item> <a href=../../eth-api/ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/eth-api.webp alt="Ethereum API" loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Ethereum API</span> <p class=dropdown-desc>Beginner to pro smart contract tutorials</p> </div> </a> </li> <li class=md-tab__item> <a href=../ > <div class=icon-col> <img class=dropdown-icon src=assets/images/dropdown-icons/integrations.webp alt=Integrations loading=lazy> </div> <div class=text-col> <span class=dropdown-title>Integrations</span> <p class=dropdown-desc>Dive deeper with tutorials on seamless integrations</p> </div> </a> </li> </ul> </li> </ul> </div> </nav> <div class="language-select-wrapper select-wrapper"> <span class="language-select-label select-label">Eng</span> <ul class="language-select select"> <li class=en value=en><a href=#>Eng</a></li> <li class=cn value=cn><a href>中文</a></li> </ul> <span class="md-icon selector-closed active"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6z"/></svg></span> <span class="md-icon selector-open"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></span> </div> <a href=# class="md-header__button md-button connectMetaMask-nav md-typeset"> Connect Wallet </a> <a class="md-header__button md-button faucet md-typeset" href=https://faucet.moonbeam.network/ target=_blank> Faucet </a> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Moonbeam Docs" class="md-nav__button md-logo" aria-label="Moonbeam Docs" data-md-component=logo> <img src=../../../assets/images/logo.webp alt=logo> </a> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ >Builders</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/get-started/ >Get Started</a> <label for=__nav_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-get-started-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/get-started/quick-start/ class=md-nav__link> Quick Start </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/create-account/ class=md-nav__link> Create an Account </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/get-started/networks/ >Networks</a> <label for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-get-started-networks-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonbeam-dev/ class=md-nav__link> Local Moonbeam Dev Node </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonbase/ class=md-nav__link> Moonbase Alpha </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonriver/ class=md-nav__link> Moonriver </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/networks/moonbeam/ class=md-nav__link> Moonbeam </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/get-started/endpoints/ class=md-nav__link> Network RPC Endpoints </a> </li> <li class=md-nav__item> <a href=../../../builders/get-started/explorers/ class=md-nav__link> Block Explorers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/ >Ethereum Toolkit</a> <label for=__nav_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/canonical-contracts/ class=md-nav__link> Canonical Contracts </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/ >Precompiled Contracts</a> <label for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/account/ >Account Management</a> <label for=__nav_2_3_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-account-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/account/identity/ class=md-nav__link> Identity </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/account/proxy/ class=md-nav__link> Proxy </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/ux/ >User Experience</a> <label for=__nav_2_3_3_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-ux-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/ux/batch/ class=md-nav__link> Batch </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/ux/call-permit/ class=md-nav__link> Call Permit </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/ux/erc20/ class=md-nav__link> Native Token ERC-20 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/features/ >Network Features</a> <label for=__nav_2_3_3_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-features-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/features/governance/ >Governance</a> <label for=__nav_2_3_3_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_3_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-features-governance-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/collective/ class=md-nav__link> Collective </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/conviction-voting/ class=md-nav__link> Conviction Voting </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/preimage/ class=md-nav__link> Preimage </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/governance/referenda/ class=md-nav__link> Referenda </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/randomness/ class=md-nav__link> Randomness </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/features/staking/ class=md-nav__link> Staking Functions </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/interoperability/ >Interoperability</a> <label for=__nav_2_3_3_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-interoperability-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/interoperability/gmp/ class=md-nav__link> GMP </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xc20/send-xc20s/xtokens-precompile/ class=md-nav__link> X-Tokens </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xc20/send-xc20s/eth-api/ class=md-nav__link> XCM Interface </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-precompile/ class=md-nav__link> XCM Transactor </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xcm-utils/ class=md-nav__link> XCM Utilities </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_3_7> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/precompiles/utility/ >Utility</a> <label for=__nav_2_3_3_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_3_7> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-precompiles-utility-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/eth-mainnet/ class=md-nav__link> Ethereum Native </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/registry/ class=md-nav__link> Precompile Registry </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/relay-data-verifier/ class=md-nav__link> Relay Data Verifier </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/precompiles/utility/non-specific/ class=md-nav__link> Non-Network Specific </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/libraries/ >Libraries</a> <label for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-libraries-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/ethersjs/ class=md-nav__link> Ethers.js </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/ethersrs/ class=md-nav__link> Ethers.rs </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/viem/ class=md-nav__link> viem </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/web3js/ class=md-nav__link> Web3.js </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/libraries/web3py/ class=md-nav__link> Web3.py </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/dev-env/ >Dev Environments</a> <label for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-dev-env-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/dev-env/openzeppelin/ >OpenZeppelin</a> <label for=__nav_2_3_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-dev-env-openzeppelin-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/openzeppelin/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/openzeppelin/contracts/ class=md-nav__link> Contract Wizard </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/ape/ class=md-nav__link> Ape </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/foundry/ class=md-nav__link> Foundry </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/hardhat/ class=md-nav__link> Hardhat </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/remix/ class=md-nav__link> Remix </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/scaffold-eth/ class=md-nav__link> Scaffold-ETH </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/tenderly/ class=md-nav__link> Tenderly </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/thirdweb/ class=md-nav__link> thirdweb </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/dev-env/waffle-mars/ class=md-nav__link> Waffle & Mars </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/verify-contracts/ >Verify Contracts</a> <label for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-verify-contracts-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/verify-contracts/block-explorers/ class=md-nav__link> Block Explorers </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/verify-contracts/etherscan-plugins/ class=md-nav__link> Etherscan Plugins </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/verify-contracts/api-verification/ class=md-nav__link> API-based Verification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_7> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/ethereum/json-rpc/ >JSON-RPC APIs</a> <label for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-ethereum-json-rpc-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/eth-rpc/ class=md-nav__link> Standard Ethereum </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/debug-trace/ class=md-nav__link> Non-standard Ethereum: Tracing </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/pubsub/ class=md-nav__link> Non-standard Ethereum: Pubsub </a> </li> <li class=md-nav__item> <a href=../../../builders/ethereum/json-rpc/moonbeam-custom-api/ class=md-nav__link> Custom Moonbeam </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/ >Substrate Toolkit</a> <label for=__nav_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/libraries/ >Libraries</a> <label for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-libraries-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/libraries/polkadot-js-api/ class=md-nav__link> Polkadot.js API </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/libraries/py-substrate-interface/ class=md-nav__link> Py Substrate Interface </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/libraries/sidecar/ class=md-nav__link> Sidecar </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/dev-env/ >Dev Environments</a> <label for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-dev-env-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/dev-env/chopsticks/ class=md-nav__link> Chopsticks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/ >Low-Level Interfaces</a> <label for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/account/ >Account Management</a> <label for=__nav_2_4_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-account-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/account/identity/ class=md-nav__link> Identity </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/account/multisig/ class=md-nav__link> Multisig </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/account/proxy/ class=md-nav__link> Proxy </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/features/ >Network Features</a> <label for=__nav_2_4_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-features-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/features/governance/ >Governance</a> <label for=__nav_2_4_4_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_4_4_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_3_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-features-governance-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/conviction-voting/ class=md-nav__link> Conviction Voting </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/parameters/ class=md-nav__link> Parameters </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/preimage/ class=md-nav__link> Preimage </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/governance/referenda/ class=md-nav__link> Referenda </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/staking/ class=md-nav__link> Parachain Staking </a> </li> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/features/randomness/ class=md-nav__link> Randomness </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/interoperability/ >Interoperability</a> <label for=__nav_2_4_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-interoperability-" data-md-scrollfix> <li class=md-nav__item> <a href=/builders/interoperability/xcm/xc20/send-xc20s/xcm-pallet/ class=md-nav__link> Polkadot XCM </a> </li> <li class=md-nav__item> <a href=/builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-pallet/ class=md-nav__link> XCM Transactor </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_4_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/substrate/interfaces/utility/ >Utility</a> <label for=__nav_2_4_4_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_4_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_4_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-substrate-interfaces-utility-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/substrate/interfaces/utility/utility/ class=md-nav__link> Utility </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/ >Interoperability</a> <label for=__nav_2_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/ >XCM Interoperability</a> <label for=__nav_2_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/overview/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/core-concepts/ >Core Concepts</a> <label for=__nav_2_5_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-core-concepts-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/instructions/ class=md-nav__link> XCM Instructions </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/multilocations/ class=md-nav__link> Multilocations </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/weights-fees/ class=md-nav__link> Weights and Fees </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/core-concepts/sovereign-accounts/ class=md-nav__link> Sovereign Accounts </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/xc-registration/ >XC Registration</a> <label for=__nav_2_5_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-xc-registration-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/forum-templates/ class=md-nav__link> Forum Templates </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/xc-integration/ class=md-nav__link> XC Channel Registration </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/assets/ class=md-nav__link> XC Asset Registration via Governance </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc-registration/self-serve-asset-registration/ class=md-nav__link> Self-Serve Asset Registration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/xc20/ >XC-20s</a> <label for=__nav_2_5_2_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-xc20-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/interact/ class=md-nav__link> Interact with XC-20s </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_5_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/ >Send XC-20s</a> <label for=__nav_2_5_2_5_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_5_2_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_5_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-xc20-send-xc20s-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/xcm-pallet/ class=md-nav__link> Using the Substrate API: Polkadot XCM Pallet </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/xtokens-precompile/ class=md-nav__link> Using the Ethereum API: X-Tokens Precompile </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xc20/send-xc20s/eth-api/ class=md-nav__link> Using the Ethereum API: XCM Precompile </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/remote-execution/ >Remote Execution</a> <label for=__nav_2_5_2_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_5_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-remote-execution-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/computed-origins/ class=md-nav__link> Computed Origin Accounts </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_2_6_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/xcm/remote-execution/substrate-calls/ >Remote Substrate Calls</a> <label for=__nav_2_5_2_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_5_2_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_2_6_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-xcm-remote-execution-substrate-calls-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-pallet/ class=md-nav__link> Using the Substrate API </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/substrate-calls/xcm-transactor-precompile/ class=md-nav__link> Using the Ethereum API </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/remote-execution/remote-evm-calls/ class=md-nav__link> Remote EVM Calls </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://moonbeam-foundation.github.io/xcm-sdk/latest/ class=md-nav__link> XCM SDK </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/send-execute-xcm/ class=md-nav__link> Send, Execute, & Test XCMs </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/xcm/xcm-utils/ class=md-nav__link> XCM Utilities </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/interoperability/protocols/ >Cross-Chain Protocols</a> <label for=__nav_2_5_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-interoperability-protocols-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/axelar/ class=md-nav__link> Axelar </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/hyperlane/ class=md-nav__link> Hyperlane </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/layerzero/ class=md-nav__link> LayerZero </a> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/protocols/wormhole/ class=md-nav__link> Wormhole </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../builders/interoperability/mrl/ class=md-nav__link> Moonbeam Routed Liquidity </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/ >Integrate</a> <label for=__nav_2_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/analytics/ >Analytics</a> <label for=__nav_2_6_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-analytics-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/analytics/dapplooker/ class=md-nav__link> Dapplooker </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/analytics/zapper/ class=md-nav__link> Portfolio Tracking on Moonbeam </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/indexers/ >Indexers</a> <label for=__nav_2_6_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-indexers-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/thegraph/ class=md-nav__link> The Graph </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/covalent/ class=md-nav__link> GoldRush API </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/moralis/ class=md-nav__link> Moralis </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/subquery/ class=md-nav__link> SubQuery </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/indexers/subsquid/ class=md-nav__link> SQD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/oracles/ >Oracles</a> <label for=__nav_2_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-oracles-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/api3/ class=md-nav__link> API3 </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/band-protocol/ class=md-nav__link> Band Protocol </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/dia/ class=md-nav__link> DIA </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/razor-network/ class=md-nav__link> Razor Network </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/oracles/supra/ class=md-nav__link> Supra </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../builders/integrations/wallets/ >Wallets</a> <label for=__nav_2_6_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list builders-integrations-wallets-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/metamask/ class=md-nav__link> MetaMask </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/walletconnect/ class=md-nav__link> WalletConnect </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/particle-network/ class=md-nav__link> Particle Network </a> </li> <li class=md-nav__item> <a href=../../../builders/integrations/wallets/rainbowkit/ class=md-nav__link> RainbowKit </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/ >Node Operators</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/networks/ >Networks</a> <label for=__nav_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-networks-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/networks/run-a-node/ >Run a Node</a> <label for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-networks-run-a-node-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/docker/ class=md-nav__link> Using Docker </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/systemd/ class=md-nav__link> Using Systemd </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/run-a-node/flags/ class=md-nav__link> Flags </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/tracing-node/ class=md-nav__link> Run a Tracing Node </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../node-operators/networks/collators/ >Collators</a> <label for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list node-operators-networks-collators-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/requirements/ class=md-nav__link> Requirements </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/account-management/ class=md-nav__link> Account Management </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/author-mapping/ class=md-nav__link> Author Mapping Precompile </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/activities/ class=md-nav__link> Collator Activities </a> </li> <li class=md-nav__item> <a href=../../../node-operators/networks/collators/orbiter/ class=md-nav__link> Orbiter Program </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/ >Tokens</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/connect/ >Connect to Moonbeam</a> <label for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-connect-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/connect/ledger/ >Ledger</a> <label for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-connect-ledger-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/connect/ledger/moonbeam/ class=md-nav__link> Moonbeam App </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/ledger/moonriver/ class=md-nav__link> Moonriver App </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/ledger/ethereum/ class=md-nav__link> Ethereum App </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tokens/connect/coinbase-wallet/ class=md-nav__link> Coinbase Wallet </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/mathwallet/ class=md-nav__link> MathWallet </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/metamask/ class=md-nav__link> MetaMask </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/polkadotjs/ class=md-nav__link> Polkadot.js Apps </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/subwallet/ class=md-nav__link> SubWallet </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/talisman/ class=md-nav__link> Talisman </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/trezor/ class=md-nav__link> Trezor </a> </li> <li class=md-nav__item> <a href=../../../tokens/connect/on-ramps/ class=md-nav__link> On Ramps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/manage/ >Account Management</a> <label for=__nav_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-manage-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/manage/proxy-accounts/ class=md-nav__link> Proxy Accounts </a> </li> <li class=md-nav__item> <a href=../../../tokens/manage/multisig-safe/ class=md-nav__link> Moonbeam Safe </a> </li> <li class=md-nav__item> <a href=../../../tokens/manage/identity/ class=md-nav__link> Managing an Identity </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/staking/ >Staking</a> <label for=__nav_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-staking-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/staking/stake/ class=md-nav__link> How to Stake </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../tokens/governance/ >Governance</a> <label for=__nav_4_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tokens-governance-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../tokens/governance/proposals/ class=md-nav__link> Submit a Democracy Proposal </a> </li> <li class=md-nav__item> <a href=../../../tokens/governance/voting/ class=md-nav__link> Vote on a Proposal </a> </li> <li class=md-nav__item> <a href=../../../tokens/governance/treasury-spend/ class=md-nav__link> Submit a Treasury Proposal </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/ >Learn</a> <label for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/platform/ >Platform</a> <label for=__nav_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-platform-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/platform/networks/ >Networks</a> <label for=__nav_5_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-platform-networks-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../learn/platform/networks/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/networks/moonbase/ class=md-nav__link> Moonbase Alpha </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/networks/moonriver/ class=md-nav__link> Moonriver </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/networks/moonbeam/ class=md-nav__link> Moonbeam </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../learn/platform/vision/ class=md-nav__link> Vision </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/why-polkadot/ class=md-nav__link> Why Polkadot </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/technology/ class=md-nav__link> Technology & Architecture </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/tokens/ class=md-nav__link> Tokens </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/code/ class=md-nav__link> Source Code </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/links/ class=md-nav__link> Important Links </a> </li> <li class=md-nav__item> <a href=../../../learn/platform/glossary/ class=md-nav__link> Glossary </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/core-concepts/ >Core Concepts</a> <label for=__nav_5_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-core-concepts-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../learn/core-concepts/balances/ class=md-nav__link> Account Balances </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/transfers-api/ class=md-nav__link> Balance Transfers </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/consensus-finality/ class=md-nav__link> Consensus & Finality </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/tx-fees/ class=md-nav__link> Transaction Fees </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/unified-accounts/ class=md-nav__link> Unified Accounts </a> </li> <li class=md-nav__item> <a href=../../../learn/core-concepts/security/ class=md-nav__link> Security Considerations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../learn/features/ >Features</a> <label for=__nav_5_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list learn-features-" data-md-scrollfix> <li class=md-nav__item> <a href=../../../learn/features/xchain-plans/ class=md-nav__link> Cross-Chain Communication </a> </li> <li class=md-nav__item> <a href=../../../learn/features/eth-compatibility/ class=md-nav__link> Ethereum Compatibility </a> </li> <li class=md-nav__item> <a href=../../../learn/features/governance/ class=md-nav__link> Governance </a> </li> <li class=md-nav__item> <a href=../../../learn/features/consensus/ class=md-nav__link> Parachain Consensus </a> </li> <li class=md-nav__item> <a href=../../../learn/features/randomness/ class=md-nav__link> Randomness </a> </li> <li class=md-nav__item> <a href=../../../learn/features/staking/ class=md-nav__link> Staking </a> </li> <li class=md-nav__item> <a href=../../../learn/features/treasury/ class=md-nav__link> Treasury </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../learn/dapp-directory/ class=md-nav__link> DApp Directory </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../ >Tutorials</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../interoperability/ >Interoperability</a> <label for=__nav_6_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-interoperability-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../interoperability/protocols.index/ >Create Connected Contracts with Cross-Chain Protocols</a> <label for=__nav_6_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-interoperability-protocols.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../interoperability/cross-chain-dao/ class=md-nav__link> [LayerZero] Creating a Cross-Chain DAO </a> </li> <li class=md-nav__item> <a href=../../interoperability/using-axelar-sdk/ class=md-nav__link> [Axelar] Minting a Cross-Chain NFT </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../interoperability/xcm.index/ >Build Cross-Chain Applications with XCM</a> <label for=__nav_6_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-interoperability-xcm.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../interoperability/remote-staking-xcm/ class=md-nav__link> [Polkadot's XCM Pallet] Remote Staking on Moonbeam from Polkadot </a> </li> <li class=md-nav__item> <a href=../../interoperability/uniswapv2-swap-xcm/ class=md-nav__link> [Polkadot's XCM Pallet] Uniswap V2 Swap on Moonbeam from Polkadot </a> </li> <li class=md-nav__item> <a href=../../interoperability/remote-batched-evm-calls/ class=md-nav__link> [Polkadot's XCM Pallet] Batched Remote EVM Calls on Moonbeam from Polkadot </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <div class="md-nav__link md-nav__link--index "> <a href=../../eth-api/ >Ethereum API</a> <label for=__nav_6_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-eth-api-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../../eth-api/get-started.index/ >Get Started with Smart Contracts</a> <label for=__nav_6_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-eth-api-get-started.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../eth-api/chat-gpt/ class=md-nav__link> [ChatGPT] Use GPT-4 to Write and Debug Smart Contracts </a> </li> <li class=md-nav__item> <a href=../../eth-api/how-to-build-a-dapp/ class=md-nav__link> [Ethers.js] How to Build a DApp </a> </li> <li class=md-nav__item> <a href=../../eth-api/foundry-start-to-end/ class=md-nav__link> [Foundry] Development Life Cycle from Start to End </a> </li> <li class=md-nav__item> <a href=../../eth-api/hardhat-start-to-end/ class=md-nav__link> [Hardhat] Development Life Cycle from Start to End </a> </li> <li class=md-nav__item> <a href=../../eth-api/using-tenderly/ class=md-nav__link> [Tenderly] Using Tenderly to Debug and Simulate Transactions </a> </li> <li class=md-nav__item> <a href=../../eth-api/thirdweb/ class=md-nav__link> [thirdweb] Building a DApp with thirdweb </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../eth-api/precompiles.index/ >Interact with Precompiles</a> <label for=__nav_6_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-eth-api-precompiles.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../../eth-api/batch-approve-swap/ class=md-nav__link> [Batch] Approve & Swap Tokens in a Single Transaction </a> </li> <li class=md-nav__item> <a href=../../eth-api/randomness-lottery/ class=md-nav__link> [Randomness] Create a Lottery </a> </li> <li class=md-nav__item> <a href=../../eth-api/call-permit-gasless-txs/ class=md-nav__link> [Call Permit] Send Gasless Transactions </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Integrations</a> <label for=__nav_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=true> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-integrations-" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../indexers.index/ >Use Indexers to Query Chain Data</a> <label for=__nav_6_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4_2> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-integrations-indexers.index-" data-md-scrollfix> <li class=md-nav__item> <a href=../local-subsquid/ class=md-nav__link> [SQD] Index a Local Dev Node </a> </li> <li class=md-nav__item> <a href=../nft-subsquid/ class=md-nav__link> [SQD] Index NFT Transfers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../oracles.index/ >Use Oracles to Fetch Off-Chain Data</a> <label for=__nav_6_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_4_3_label aria-expanded=true> <label class=md-nav__title for=__nav_6_4_3> <span class="md-nav__icon md-icon"></span> </label> <ul class="md-nav__list tutorials-integrations-oracles.index-" data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> [Supra] Fetch Price Data <span class="md-nav__icon md-icon"></span> </label> <div class="md-nav__link-wrapper md-nav__item md-nav__item--active"> <a href=./ class="md-nav__link md-nav__link--active"> [Supra] Fetch Price Data </a> </div> <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Determine title --> <!-- Table of contents --> <nav class="md-nav md-nav--secondary" aria-label=Sections> <!--
    Check whether the content starts with a level 1 headline. If it does, the
    top-level anchor must be skipped, since it would be redundant to the link
    to the current page that is located just above the anchor. Therefore we
    directly continue with the children of the anchor.
  --> <!-- Table of contents title and list --> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> <div class=toc-sections-title>Sections</div> </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#pull-model class=md-nav__link> <span class=md-ellipsis> An Overview of Supra's V1 Pull Model </span> </a> </li> <li class=md-nav__item> <a href=#checking-prerequisites class=md-nav__link> <span class=md-ellipsis> Checking Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#web2-retrieve-price-data class=md-nav__link> <span class=md-ellipsis> Use Web2 Code to Retrieve Price Data </span> </a> <nav class=md-nav aria-label="Use Web2 Code to Retrieve Price Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-project class=md-nav__link> <span class=md-ellipsis> Create a Project </span> </a> </li> <li class=md-nav__item> <a href=#create-pull-service-client class=md-nav__link> <span class=md-ellipsis> Create the Pull Service Client </span> </a> </li> <li class=md-nav__item> <a href=#use-the-pull-service-client class=md-nav__link> <span class=md-ellipsis> Use the Pull Service Client to Fetch Price Data </span> </a> </li> <li class=md-nav__item> <a href=#deserialize-proofs class=md-nav__link> <span class=md-ellipsis> Deserialize the Proofs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verify-and-publish-proofs class=md-nav__link> <span class=md-ellipsis> Use Web3 to Verify and Publish the Proofs </span> </a> <nav class=md-nav aria-label="Use Web3 to Verify and Publish the Proofs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-the-consumer-contract class=md-nav__link> <span class=md-ellipsis> Create the Consumer Contract </span> </a> </li> <li class=md-nav__item> <a href=#deploy-the-consumer-contract class=md-nav__link> <span class=md-ellipsis> Deploy the Contract </span> </a> </li> <li class=md-nav__item> <a href=#call-the-consumer-contract class=md-nav__link> <span class=md-ellipsis> Call the Contract </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#retrieve-on-chain-price-data class=md-nav__link> <span class=md-ellipsis> Retrieve On-Chain Price Data </span> </a> <nav class=md-nav aria-label="Retrieve On-Chain Price Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-the-retrieval-contract class=md-nav__link> <span class=md-ellipsis> Create the Retrieval Contract </span> </a> </li> <li class=md-nav__item> <a href=#deploy-the-retrieval-contract class=md-nav__link> <span class=md-ellipsis> Deploy the Contract </span> </a> </li> <li class=md-nav__item> <a href=#call-the-retrieval-contract class=md-nav__link> <span class=md-ellipsis> Call the Contract </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../0xgasless/ class=md-nav__link> Enable Gasless Transactions </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner><!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Determine title --> <!-- Table of contents --> <nav class="md-nav md-nav--secondary" aria-label=Sections> <!--
    Check whether the content starts with a level 1 headline. If it does, the
    top-level anchor must be skipped, since it would be redundant to the link
    to the current page that is located just above the anchor. Therefore we
    directly continue with the children of the anchor.
  --> <!-- Table of contents title and list --> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> <div class=toc-sections-title>Sections</div> </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#pull-model class=md-nav__link> <span class=md-ellipsis> An Overview of Supra's V1 Pull Model </span> </a> </li> <li class=md-nav__item> <a href=#checking-prerequisites class=md-nav__link> <span class=md-ellipsis> Checking Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#web2-retrieve-price-data class=md-nav__link> <span class=md-ellipsis> Use Web2 Code to Retrieve Price Data </span> </a> <nav class=md-nav aria-label="Use Web2 Code to Retrieve Price Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-project class=md-nav__link> <span class=md-ellipsis> Create a Project </span> </a> </li> <li class=md-nav__item> <a href=#create-pull-service-client class=md-nav__link> <span class=md-ellipsis> Create the Pull Service Client </span> </a> </li> <li class=md-nav__item> <a href=#use-the-pull-service-client class=md-nav__link> <span class=md-ellipsis> Use the Pull Service Client to Fetch Price Data </span> </a> </li> <li class=md-nav__item> <a href=#deserialize-proofs class=md-nav__link> <span class=md-ellipsis> Deserialize the Proofs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verify-and-publish-proofs class=md-nav__link> <span class=md-ellipsis> Use Web3 to Verify and Publish the Proofs </span> </a> <nav class=md-nav aria-label="Use Web3 to Verify and Publish the Proofs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-the-consumer-contract class=md-nav__link> <span class=md-ellipsis> Create the Consumer Contract </span> </a> </li> <li class=md-nav__item> <a href=#deploy-the-consumer-contract class=md-nav__link> <span class=md-ellipsis> Deploy the Contract </span> </a> </li> <li class=md-nav__item> <a href=#call-the-consumer-contract class=md-nav__link> <span class=md-ellipsis> Call the Contract </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#retrieve-on-chain-price-data class=md-nav__link> <span class=md-ellipsis> Retrieve On-Chain Price Data </span> </a> <nav class=md-nav aria-label="Retrieve On-Chain Price Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-the-retrieval-contract class=md-nav__link> <span class=md-ellipsis> Create the Retrieval Contract </span> </a> </li> <li class=md-nav__item> <a href=#deploy-the-retrieval-contract class=md-nav__link> <span class=md-ellipsis> Deploy the Contract </span> </a> </li> <li class=md-nav__item> <a href=#call-the-retrieval-contract class=md-nav__link> <span class=md-ellipsis> Call the Contract </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div><div class=feedback-actions-container><div class=feedback-section> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M23 10a2 2 0 0 0-2-2h-6.32l.96-4.57c.02-.1.03-.21.03-.32 0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.58C7.22 7.95 7 8.45 7 9v10a2 2 0 0 0 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73zM1 21h4V9H1z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15h4V3h-4m-4 0H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2a2 2 0 0 0 2 2h6.31l-.95 4.57c-.02.1-.03.2-.03.31 0 .42.17.79.44 1.06L9.83 23l6.58-6.59c.37-.36.59-.86.59-1.41V5a2 2 0 0 0-2-2"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by submitting <a href="https://github.com/moonbeam-foundation/moonbeam-docs/issues/new/?title=[Feedback]+Supra%20Oracles+-+/tutorials/integrations/supra/" target=_blank rel=noopener>additional feedback</a>. </div> </div> </div> </fieldset> <div class=divider></div></form> </div><div class=edit-section> <a href=https://github.com/moonbeam-foundation/moonbeam-docs/edit/master/tutorials/integrations/supra.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> Edit this page </a> </div> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=fetching-price-data-with-supra-oracles>Fetching Price Data with Supra Oracles<a class=headerlink href=#fetching-price-data-with-supra-oracles title="Permanent link">&para;</a></h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>Oracles play a crucial role in blockchain ecosystems by facilitating the interaction between smart contracts and external data sources.</p> <p>Supra Oracles is one Oracle service provider that enables you to retrieve price data from external services and feed it to smart contracts to validate the accuracy of such data and publish it on-chain. Supra achieves this flow using a pull model that fetches price data as needed.</p> <p>In this guide, you'll learn about Supra's pull model and how to use their price feeds to fetch price data in smart contracts on Moonbeam.</p> <div class=intro-disclaimer> The information presented herein is for informational purposes only and has been provided by third parties. Moonbeam does not endorse any project listed and described on the Moonbeam docs website (https://docs.moonbeam.network/). </div> <h2 id=pull-model>An Overview of Supra's V1 Pull Model<a class=headerlink href=#pull-model title="Permanent link">&para;</a></h2> <p>Supra uses a pull model as a customized approach that publishes price data upon request. It combines Web2 and Web3 methods to achieve low latency when sending data from Supra to destination chains. The process involves the following steps:</p> <ol> <li>Web2 methods are used to retrieve price data from Supra</li> <li>Smart contracts are utilized for cryptographically verifying and writing the latest price data on-chain, where it lives on immutable ledgers, using <a href=https://docs.supra.com/oracles/data-feeds/pull-oracle target=_blank>Supra's Pull contract</a></li> <li>Once the data has been written on-chain, the most recently published price feed data will be available in Supra's Storage contract</li> </ol> <p>You can fetch price data from Supra for any <a href=https://docs.supra.com/oracles/data-feeds/data-feeds-index target=_blank>available data pairs</a>.</p> <p>The addresses for Supra's contracts on Moonbeam are as follows:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Moonbeam</label><label for=__tabbed_1_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <table> <thead> <tr> <th style="text-align: center;">Contract</th> <th style="text-align: center;">Address</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">Pull Oracle</td> <td style="text-align: center;"><a href=https://moonscan.io/address/0x2FA6DbFe4291136Cf272E1A3294362b6651e8517 target=_blank>0x2FA6DbFe4291136Cf272E1A3294362b6651e8517</a></td> </tr> <tr> <td style="text-align: center;">Storage</td> <td style="text-align: center;"><a href=https://moonscan.io/address/0xD02cc7a670047b6b012556A88e275c685d25e0c9 target=_blank>0xD02cc7a670047b6b012556A88e275c685d25e0c9</a></td> </tr> </tbody> </table> </div> <div class=tabbed-block> <table> <thead> <tr> <th style="text-align: center;">Contract</th> <th style="text-align: center;">Address</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">Pull Oracle</td> <td style="text-align: center;"><a href=https://moonbase.moonscan.io/address/0xaa2f56843Cec7840F0C106F0202313d8d8CB13d6 target=_blank>0xaa2f56843Cec7840F0C106F0202313d8d8CB13d6</a></td> </tr> <tr> <td style="text-align: center;">Storage</td> <td style="text-align: center;"><a href=https://moonbase.moonscan.io/address/0x4591d1B110ad451d8220d82252F829E8b2a91B17 target=_blank>0x4591d1B110ad451d8220d82252F829E8b2a91B17</a></td> </tr> </tbody> </table> </div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Moonriver is not supported at this time.</p> </div> <h2 id=checking-prerequisites>Checking Prerequisites<a class=headerlink href=#checking-prerequisites title="Permanent link">&para;</a></h2> <p>To follow along with this guide, you will need:</p> <ul> <li>An account with funds. You can get DEV tokens for testing on Moonbase Alpha once every 24 hours from the <a href=https://faucet.moonbeam.network target=_blank>Moonbase Alpha Faucet</a></li> </ul> <h2 id=web2-retrieve-price-data>Use Web2 Code to Retrieve Price Data<a class=headerlink href=#web2-retrieve-price-data title="Permanent link">&para;</a></h2> <p>To build out the Web2 component required to fetch price data from Supra, you can use their <a href=https://github.com/Entropy-Foundation/oracle-pull-example target=_blank>Pull Service Client library</a>, designed to interact with a gRPC server to fetch price data. gRPC is a modern remote procedure call (RPC) framework created by Google. You can check out the <a href=https://grpc.io/docs/what-is-grpc target=_blank>gRPC documentation</a> for more information if you need to familiarize yourself.</p> <p>The library offers JavaScript or Rust-based clients for EVM, Sui, and Aptos-based chains. For Moonbeam, you can use the JavaScript or Rust-based EVM client. We'll use the <a href=https://github.com/Entropy-Foundation/oracle-pull-example/tree/master/rest/javascript/evm_client target=_blank>JavaScript client</a>.</p> <p>We'll copy the JavaScript client code and add it to our project, but you can also clone the <a href=https://github.com/Entropy-Foundation/oracle-pull-example target=_blank>repository</a> with all the clients.</p> <h3 id=create-a-project>Create a Project<a class=headerlink href=#create-a-project title="Permanent link">&para;</a></h3> <p>Follow these steps to create your project:</p> <ol> <li> <p>Create an empty project directory</p> <div class=highlight><pre><span></span><code>mkdir moonbeam-supra
</code></pre></div> </li> <li> <p>Create a basic <code>package.json</code> file for your project</p> <div class=highlight><pre><span></span><code>cd moonbeam-supra &amp;&amp; npm init-y
</code></pre></div> </li> <li> <p>Install dependencies needed to work with Supra's gRPC server</p> <div class=highlight><pre><span></span><code>npm install @grpc/grpc-js @grpc/proto-loader
</code></pre></div> </li> </ol> <h3 id=create-pull-service-client>Create the Pull Service Client<a class=headerlink href=#create-pull-service-client title="Permanent link">&para;</a></h3> <p>To create the pull service client, you'll need to create two files: one that defines the schema for the gRPC service, <code>client.proto</code>, and another that relies on the schema and is used to fetch the proof for a given data pair, <code>pullServiceClient.js</code>.</p> <p>You can create both files using the following command:</p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>client.proto<span class=w> </span>pullServiceClient.js
</code></pre></div> <p>Then, you can copy the following code snippets and add them to their respective files:</p> <details class=code open=open> <summary>Pull service client files</summary> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>client.proto</label><label for=__tabbed_2_2>pullServiceClient.js</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>syntax</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;proto3&quot;</span><span class=p>;</span>

<span class=kn>package</span><span class=w> </span><span class=nn>pull_service</span><span class=p>;</span>

<span class=kd>message</span><span class=w> </span><span class=nc>PullResponse</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>oneof</span><span class=w> </span><span class=n>resp</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>PullResponseEvm</span><span class=w> </span><span class=na>evm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=n>PullResponseSui</span><span class=w> </span><span class=na>sui</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>    </span><span class=n>PullResponseAptos</span><span class=w> </span><span class=na>aptos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>service</span><span class=w> </span><span class=n>PullService</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>GetProof</span><span class=p>(</span><span class=n>PullRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>PullResponse</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>PullRequest</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>repeated</span><span class=w> </span><span class=kt>uint32</span><span class=w> </span><span class=na>pair_indexes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=na>chain_type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>PullResponseEvm</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>repeated</span><span class=w> </span><span class=kt>uint32</span><span class=w> </span><span class=na>pair_indexes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=kt>bytes</span><span class=w> </span><span class=na>proof_bytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>grpc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@grpc/grpc-js&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>protoLoader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@grpc/proto-loader&#39;</span><span class=p>);</span>

<span class=kd>class</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kr>constructor</span><span class=p>(</span><span class=nx>address</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>PROTO_PATH</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>__dirname</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s1>&#39;./client.proto&#39;</span><span class=p>;</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>packageDefinition</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>protoLoader</span><span class=p>.</span><span class=nx>loadSync</span><span class=p>(</span><span class=nx>PROTO_PATH</span><span class=p>,</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>keepCase</span><span class=o>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<span class=w>      </span><span class=nx>longs</span><span class=o>:</span><span class=w> </span><span class=nb>String</span><span class=p>,</span>
<span class=w>      </span><span class=nx>enums</span><span class=o>:</span><span class=w> </span><span class=nb>String</span><span class=p>,</span>
<span class=w>      </span><span class=nx>defaults</span><span class=o>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<span class=w>      </span><span class=nx>oneofs</span><span class=o>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<span class=w>    </span><span class=p>});</span>

<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pullProto</span><span class=w> </span><span class=o>=</span>
<span class=w>      </span><span class=nx>grpc</span><span class=p>.</span><span class=nx>loadPackageDefinition</span><span class=p>(</span><span class=nx>packageDefinition</span><span class=p>).</span><span class=nx>pull_service</span><span class=p>;</span>
<span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>pullProto</span><span class=p>.</span><span class=nx>PullService</span><span class=p>(</span>
<span class=w>      </span><span class=nx>address</span><span class=p>,</span>
<span class=w>      </span><span class=nx>grpc</span><span class=p>.</span><span class=nx>credentials</span><span class=p>.</span><span class=nx>createSsl</span><span class=p>()</span>
<span class=w>    </span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=nx>module</span><span class=p>.</span><span class=nx>exports</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>;</span>
</code></pre></div> </div> </div> </div> </details> <h3 id=use-the-pull-service-client>Use the Pull Service Client to Fetch Price Data<a class=headerlink href=#use-the-pull-service-client title="Permanent link">&para;</a></h3> <p>In this section, you'll create an instance of the <code>PullServiceClient</code> to retrieve the proof for the ETH_USDT pair. You can modify this example for any of the <a href=https://docs.supra.com/oracles/data-feeds/data-feeds-index target=_blank>available data pairs</a>.</p> <p>To get started, create a file to add our logic:</p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>main.js
</code></pre></div> <p>In the <code>main.js</code> file, take the following steps to add the logic for retrieving proof data:</p> <ol> <li> <p>Import the <code>PullServiceClient</code> from the <code>pullServiceClient.js</code> file</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
</code></pre></div> </li> <li> <p>Create a variable to store the index of the data pair for which you want to retrieve the price data. This example requests the ETH_USDT data pair, but you can use the <a href=https://docs.supra.com/oracles/data-feeds/data-feeds-index target=_blank>index of any available data pair</a></p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
</code></pre></div> </li> <li> <p>Create a <code>getProofs</code> function, where you'll add all the logic</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Add logic</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>In the <code>getProofs</code> function, you can define the address for the gRPC server and use it to create an instance of the <code>PullServiceClient</code>. Supra has one address for MainNets, <code>'mainnet-dora.supraoracles.com'</code> and one for TestNets, <code>'testnet-dora.supraoracles.com'</code></p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Moonbeam</label><label for=__tabbed_3_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;mainnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>
<span class=p>};</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;testnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>
<span class=p>};</span>
</code></pre></div> </div> </div> </div> </li> <li> <p>To request data from the client, first, you need to define the data you want to request</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// ...</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Now you can request the proof for the data pair(s) by calling the <code>getProof</code> method of the Pull Service Client</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// ...</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Create a <code>main</code> function that calls the <code>getProofs</code> function and saves the proofs to be consumed in later steps</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </li> </ol> <details class=code> <summary>main.js</summary> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Moonbeam</label><label for=__tabbed_4_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;mainnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;testnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </details> <p>So far, you have the logic required to retrieve proofs for data pairs. The proofs are bytes of data that are not human-readable, but you can follow the steps in the next section to deserialize the data into human-readable formats. This step is optional, so you can <a href=#verify-and-publish-proofs>skip ahead to verify the proofs and write the price data on-chain</a>.</p> <h3 id=deserialize-proofs>Deserialize the Proofs<a class=headerlink href=#deserialize-proofs title="Permanent link">&para;</a></h3> <p>If you want to deserialize the data to read the latest price data you've retrieved, you can use the interfaces for the proof data and the signed coherent cluster data.</p> <p>Coherent cluster data is a set of values where all the values in that set agree. This is a component of Supra's DORA (Distributed Oracle Agreement) protocol, which, in its simplest form, is a protocol that aggregates a set of data into a single representative value. If you want to dive deeper, check out the <a href=https://supra.com/news/dora-distributed-oracle-agreement target=_blank>DORA litepaper</a>.</p> <p>You'll need to create a file for each interface, which you can store in a <code>resources</code> directory:</p> <div class=highlight><pre><span></span><code>mkdir<span class=w> </span>resources<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>touch<span class=w> </span>resources/oracleProof.json<span class=w> </span>resources/signedCoherentCluster.json
</code></pre></div> <p>Then, you can copy the following code snippets and add them to their respective files:</p> <details class=code open=open> <summary>Interface files</summary> <div class="tabbed-set tabbed-alternate" data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>oracleProof.json</label><label for=__tabbed_5_2>signedCoherentCluster.json</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=p>[</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;OracleProof&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>            </span><span class=p>{</span>
<span class=w>                </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple[]&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;votes&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>                    </span><span class=p>{</span>
<span class=w>                        </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple&quot;</span><span class=p>,</span>
<span class=w>                        </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;smrBlock&quot;</span><span class=p>,</span>
<span class=w>                        </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>                            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint64&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;round&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint128&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;timestamp&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;author&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;qcHash&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;batchHashes&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>                        </span><span class=p>]</span>
<span class=w>                    </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes8&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;roundLE&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>                </span><span class=p>]</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[2][]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sigs&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span>
<span class=w>                </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple[]&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;smrBatches&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes10&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;protocol&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;txnHashes&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;batchIdx&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>                </span><span class=p>]</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span>
<span class=w>                </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple[]&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;smrTxns&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;clusterHashes&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sender&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes10&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;protocol&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes1&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tx_sub_type&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;txnIdx&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>                </span><span class=p>]</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;clustersRaw&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;batchToVote&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;txnToBatch&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;clusterToTxn&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;clusterToHash&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bool[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;pairMask&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;pairCnt&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>        </span><span class=p>]</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>]</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=p>[</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;scc&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>            </span><span class=p>{</span>
<span class=w>                </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;cc&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;dataHash&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;pair&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;prices&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;timestamp&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256[]&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;decimals&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>                </span><span class=p>]</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;qc&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;round&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>{</span>
<span class=w>                </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tuple&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;origin&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bytes32&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;_publicKeyIdentity&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;_pubMemberIndex&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>                    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uint256&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;_committeeIndex&quot;</span><span class=w> </span><span class=p>}</span>
<span class=w>                </span><span class=p>]</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>]</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>]</span>
</code></pre></div> </div> </div> </div> </details> <p>To work with these interfaces, you must install the <a href=/moonbeam-mkdocs/builders/ethereum/libraries/ target=_blank>Ethereum library</a> of your choice. For this example, we'll use <a href=/moonbeam-mkdocs/builders/ethereum/libraries/web3js/ target=_blank>Web3.js</a>.</p> <div class=highlight><pre><span></span><code>npm<span class=w> </span>i<span class=w> </span>web3
</code></pre></div> <p>Next, you can take the following steps to create a function that deserializes the proof data:</p> <ol> <li> <p>In the <code>main.js</code> file, import the interfaces and Web3</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>
</code></pre></div> </li> <li> <p>Create a Web3 instance, which will be used to interact with the interfaces. You can add this snippet directly after the imports</p> <div class="tabbed-set tabbed-alternate" data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><input id=__tabbed_6_2 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>Moonbeam</label><label for=__tabbed_6_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>
</code></pre></div> </div> </div> </div> </li> <li> <p>Create a <code>deserializeProofBytes</code> function to add all the logic for deserializing the proofs. The function should accept the proof formatted in hex as a parameter</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Add logic here</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>First you can decode the parameters of the proof data using the Oracle Proof interface and extract the raw bytes of the signed pair cluster data and which pair IDs have been requested</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Next, you can iterate over the signed pair cluster data and decode the parameters using the Signed Coherent Cluster interface, and then save the data for each pair to variables that you can log to the console</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// ...</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>In the <code>main</code> function that you created in the previous section, you can convert the <code>proofs</code> to hex and call the <code>deserializeProofBytes</code> function</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </li> </ol> <details class=code> <summary>main.js</summary> <div class="tabbed-set tabbed-alternate" data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><input id=__tabbed_7_2 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=__tabbed_7_1>Moonbeam</label><label for=__tabbed_7_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;mainnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=c1>// Function to convert the proof data to human-readable price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;testnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=c1>// Function to convert the proof data to human-readable price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </details> <p>When you request the proof data, you can view that data in a human-readable format. You can try it out by running:</p> <div class=highlight><pre><span></span><code>node<span class=w> </span>main.js
</code></pre></div> <p>The terminal output should look something like the following:</p> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>node main.js</span> <br> <span data-ty>----- Deserialized Data ------ <br> Pair index : [ '1' ] <br> Pair Price : [ '3424260000000000000000' ] <br> Pair Decimal : [ '18' ] <br> Pair Timestamp : [ '1709317443269' ] <br> ------------------------------ </span> </div> <h2 id=verify-and-publish-proofs>Use Web3 to Verify and Publish the Proofs<a class=headerlink href=#verify-and-publish-proofs title="Permanent link">&para;</a></h2> <p>Now that we've retrieved the price data, we need to be able to consume it to verify and publish the data on-chain. To do this, we'll need a smart contract that uses Supra's Pull contract to verify the proof data.</p> <h3 id=create-the-consumer-contract>Create the Consumer Contract<a class=headerlink href=#create-the-consumer-contract title="Permanent link">&para;</a></h3> <p>You can take the following steps to create our smart contract:</p> <ol> <li> <p>Create a new file for the smart contract, which we'll name <code>OracleClient</code></p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>OracleClient.sol
</code></pre></div> </li> <li> <p>In the file, create an interface for Supra's Pull contract. The interface outlines the data structure for the price data and has a function that we'll call to verify proofs. Then, in our <code>OracleClient</code> contract, we'll instantiate the <code>ISupraOraclePull</code> interface with the address of Supra's Pull contract on Moonbeam or Moonbase Alpha</p> <div class=highlight><span class=filename>OracleClient.sol</span><pre><span></span><code><span class=c1>// SPDX-License-Identifier: UNLICENSED</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=err>0.8.20</span><span class=p>;</span>

interface<span class=w> </span>ISupraOraclePull<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Verified price data</span>
<span class=w>    </span><span class=kt>struct</span><span class=w> </span><span class=nv>PriceData</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// List of pairs</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span>pairs<span class=p>;</span>
<span class=w>        </span><span class=c1>// List of prices</span>
<span class=w>        </span><span class=c1>// prices[i] is the price of pairs[i]</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span>prices<span class=p>;</span>
<span class=w>        </span><span class=c1>// List of decimals</span>
<span class=w>        </span><span class=c1>// decimals[i] is the decimals of pairs[i]</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span>decimals<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>verifyOracleProof</span><span class=p>(</span>
<span class=w>        </span><span class=kt>bytes</span><span class=w> </span><span class=nv>calldata</span><span class=w> </span>_bytesProof
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span>PriceData<span class=w> </span><span class=kt>memory</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> </li> <li> <p>In the same file, create the <code>OracleClient</code> contract. As mentioned in the previous step, the constructor of this contract instantiates the <code>ISupraOraclePull</code> interface with the address of Supra's Pull contract. The contract also includes a function that calls the <code>verifyOracleProof</code> function of the Pull contract and saves the price data on-chain</p> <div class=highlight><span class=filename>OracleClient.sol</span><pre><span></span><code><span class=c1>// ...</span>

<span class=c1>// Contract which can consume oracle pull data</span>
<span class=k>contract</span><span class=w> </span><span class=ni>OracleClient</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// The oracle contract</span>
<span class=w>    </span>ISupraOraclePull<span class=w> </span><span class=kt>internal</span><span class=w> </span>oracle<span class=p>;</span>

<span class=w>    </span><span class=c1>// Event emitted when a pair price is received</span>
<span class=w>    </span><span class=kt>event</span><span class=w> </span><span class=nv>PairPrice</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>pair</span><span class=p>,</span><span class=w> </span><span class=kt>uint256</span><span class=w> </span><span class=nv>price</span><span class=p>,</span><span class=w> </span><span class=kt>uint256</span><span class=w> </span><span class=nv>decimals</span><span class=p>);</span>

<span class=w>    </span><span class=kt>constructor</span><span class=p>(</span><span class=kt>address</span><span class=w> </span><span class=nv>oracle_</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>oracle<span class=w> </span><span class=o>=</span><span class=w> </span>ISupraOraclePull<span class=p>(</span>oracle_<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>GetPairPrice</span><span class=p>(</span>
<span class=w>        </span><span class=kt>bytes</span><span class=w> </span><span class=nv>calldata</span><span class=w> </span>_bytesProof<span class=p>,</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>pair</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Verify the proof</span>
<span class=w>        </span>ISupraOraclePull<span class=p>.</span>PriceData<span class=w> </span><span class=kt>memory</span><span class=w> </span>prices<span class=w> </span><span class=o>=</span><span class=w> </span>oracle<span class=p>.</span>verifyOracleProof<span class=p>(</span>
<span class=w>             </span>_bytesProof
<span class=w>        </span><span class=p>);</span>
<span class=w>        </span><span class=c1>// Set the price and decimals for the requested data pair</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>price</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>decimals</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>        </span><span class=kt>for</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span><span class=w> </span>i<span class=w> </span><span class=o>&lt;</span><span class=w> </span>prices<span class=p>.</span>pairs<span class=p>.</span>length<span class=p>;</span><span class=w> </span>i<span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>prices<span class=p>.</span>pairs<span class=p>[</span>i<span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span>pair<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span>price<span class=w> </span><span class=o>=</span><span class=w> </span>prices<span class=p>.</span>prices<span class=p>[</span>i<span class=p>];</span>
<span class=w>                </span>decimals<span class=w> </span><span class=o>=</span><span class=w> </span>prices<span class=p>.</span>decimals<span class=p>[</span>i<span class=p>];</span>
<span class=w>                </span><span class=kt>break</span><span class=p>;</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kt>require</span><span class=p>(</span>price<span class=w> </span><span class=o>!=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;Pair not found&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=kt>return</span><span class=w> </span>price<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </li> </ol> <details class=code> <summary>OracleClient.sol</summary> <div class=highlight><pre><span></span><code><span class=c1>// SPDX-License-Identifier: UNLICENSED</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=err>0.8.20</span><span class=p>;</span>

interface<span class=w> </span>ISupraOraclePull<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Verified price data</span>
<span class=w>    </span><span class=kt>struct</span><span class=w> </span><span class=nv>PriceData</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// List of pairs</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span>pairs<span class=p>;</span>
<span class=w>        </span><span class=c1>// List of prices</span>
<span class=w>        </span><span class=c1>// prices[i] is the price of pairs[i]</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span>prices<span class=p>;</span>
<span class=w>        </span><span class=c1>// List of decimals</span>
<span class=w>        </span><span class=c1>// decimals[i] is the decimals of pairs[i]</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[]</span><span class=w> </span>decimals<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>verifyOracleProof</span><span class=p>(</span>
<span class=w>        </span><span class=kt>bytes</span><span class=w> </span><span class=nv>calldata</span><span class=w> </span>_bytesProof
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span>PriceData<span class=w> </span><span class=kt>memory</span><span class=p>);</span>
<span class=p>}</span>

<span class=c1>// Contract which can consume oracle pull data</span>
<span class=k>contract</span><span class=w> </span><span class=ni>OracleClient</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// The oracle contract</span>
<span class=w>    </span>ISupraOraclePull<span class=w> </span><span class=kt>internal</span><span class=w> </span>oracle<span class=p>;</span>

<span class=w>    </span><span class=c1>// Event emitted when a pair price is received</span>
<span class=w>    </span><span class=kt>event</span><span class=w> </span><span class=nv>PairPrice</span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>pair</span><span class=p>,</span><span class=w> </span><span class=kt>uint256</span><span class=w> </span><span class=nv>price</span><span class=p>,</span><span class=w> </span><span class=kt>uint256</span><span class=w> </span><span class=nv>decimals</span><span class=p>);</span>

<span class=w>    </span><span class=kt>constructor</span><span class=p>(</span><span class=kt>address</span><span class=w> </span><span class=nv>oracle_</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>oracle<span class=w> </span><span class=o>=</span><span class=w> </span>ISupraOraclePull<span class=p>(</span>oracle_<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>GetPairPrice</span><span class=p>(</span>
<span class=w>        </span><span class=kt>bytes</span><span class=w> </span><span class=nv>calldata</span><span class=w> </span>_bytesProof<span class=p>,</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>pair</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Verify the proof</span>
<span class=w>        </span>ISupraOraclePull<span class=p>.</span>PriceData<span class=w> </span><span class=kt>memory</span><span class=w> </span>prices<span class=w> </span><span class=o>=</span><span class=w> </span>oracle<span class=p>.</span>verifyOracleProof<span class=p>(</span>
<span class=w>             </span>_bytesProof
<span class=w>        </span><span class=p>);</span>
<span class=w>        </span><span class=c1>// Set the price and decimals for the requested data pair</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>price</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>        </span><span class=kt>uint256</span><span class=w> </span><span class=nv>decimals</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span>
<span class=w>        </span><span class=kt>for</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span><span class=w> </span>i<span class=w> </span><span class=o>&lt;</span><span class=w> </span>prices<span class=p>.</span>pairs<span class=p>.</span>length<span class=p>;</span><span class=w> </span>i<span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kt>if</span><span class=w> </span><span class=p>(</span>prices<span class=p>.</span>pairs<span class=p>[</span>i<span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span>pair<span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span>price<span class=w> </span><span class=o>=</span><span class=w> </span>prices<span class=p>.</span>prices<span class=p>[</span>i<span class=p>];</span>
<span class=w>                </span>decimals<span class=w> </span><span class=o>=</span><span class=w> </span>prices<span class=p>.</span>decimals<span class=p>[</span>i<span class=p>];</span>
<span class=w>                </span><span class=kt>break</span><span class=p>;</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kt>require</span><span class=p>(</span>price<span class=w> </span><span class=o>!=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;Pair not found&quot;</span><span class=p>);</span>
<span class=w>        </span><span class=kt>return</span><span class=w> </span>price<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </details> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This contract only saves the price data for one pair. So, if you want to save the price data for multiple pairs, you must modify the contract.</p> </div> <h3 id=deploy-the-consumer-contract>Deploy the Contract<a class=headerlink href=#deploy-the-consumer-contract title="Permanent link">&para;</a></h3> <p>With the contract created, you must next deploy the contract. Since we've already installed Web3.js, let's use it to deploy the contract. If you're unfamiliar with the process, you can reference the <a href=/moonbeam-mkdocs/builders/ethereum/libraries/web3js/#deploy-a-contract target=_blank>Web3.js docs on deploying a smart contract</a>.</p> <p>To deploy the contract, take the following steps:</p> <ol> <li> <p>Create a file that will contain the logic for compiling and deploying the smart contract</p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>deploy.js
</code></pre></div> </li> <li> <p>Install the Solidity compiler. We're installing version 0.8.20, as that is the version required by the <code>OracleClient</code> contract</p> <div class=highlight><pre><span></span><code>npm<span class=w> </span>i<span class=w> </span>solc@0.8.20
</code></pre></div> </li> <li> <p>Add the following imports</p> <div class=highlight><span class=filename>deploy.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>fs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>solc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;solc&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>
</code></pre></div> </li> <li> <p>Create the Web3 instance</p> <div class="tabbed-set tabbed-alternate" data-tabs=8:2><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><input id=__tabbed_8_2 name=__tabbed_8 type=radio><div class=tabbed-labels><label for=__tabbed_8_1>Moonbeam</label><label for=__tabbed_8_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>
</code></pre></div> </div> </div> </div> </li> <li> <p>Create a function that compiles the <code>OracleClient</code> contract, saves the ABI in the <code>resources</code> directory for later use, and returns the ABI and bytecode for the deployment</p> <div class=highlight><span class=filename>deploy.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>compile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Get path and load contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;utf8&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create input object</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>language</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Solidity&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>sources</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>content</span><span class=o>:</span><span class=w> </span><span class=nx>source</span><span class=p>,</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nx>settings</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>outputSelection</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;*&#39;</span><span class=p>],</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>tempFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>solc</span><span class=p>.</span><span class=nx>compile</span><span class=p>(</span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>input</span><span class=p>)));</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>tempFile</span><span class=p>.</span><span class=nx>contracts</span><span class=p>[</span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=p>][</span><span class=s1>&#39;OracleClient&#39;</span><span class=p>];</span>

<span class=w>  </span><span class=c1>// Save ABI to a file</span>
<span class=w>  </span><span class=nx>fs</span><span class=p>.</span><span class=nx>writeFileSync</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mf>4</span><span class=p>),</span>
<span class=w>    </span><span class=s1>&#39;utf8&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>bytecode</span><span class=p>.</span><span class=nx>object</span><span class=w> </span><span class=p>};</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Create the function to deploy the compiled contract. You'll need to pass the address of Supra's Pull contract to the constructor. You'll also need to provide your address and your private key</p> <div class="admonition remember"> <p class=admonition-title>Remember</p> <p>Never store your private key in a JavaScript file; this is for demo purposes only.</p> </div> <div class="tabbed-set tabbed-alternate" data-tabs=9:2><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><input id=__tabbed_9_2 name=__tabbed_9 type=radio><div class=tabbed-labels><label for=__tabbed_9_1>Moonbeam</label><label for=__tabbed_9_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>deploy.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>deploy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>compile</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Create contract instance</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>abi</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the deployment transaction and pass in the Pull Oracle contract address</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deployTx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>deploy</span><span class=p>({</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>bytecode</span><span class=p>,</span>
<span class=w>    </span><span class=nx>arguments</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0x2FA6DbFe4291136Cf272E1A3294362b6651e8517&#39;</span><span class=p>],</span>
<span class=w>  </span><span class=p>});</span>

<span class=w>  </span><span class=c1>// Sign transaction with PK</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>encodeABI</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>nonce</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getTransactionCount</span><span class=p>(</span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send transaction and wait for receipt</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createReceipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>createTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Contract deployed at address: </span><span class=si>${</span><span class=nx>createReceipt</span><span class=p>.</span><span class=nx>contractAddress</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>deploy</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><span class=filename>deploy.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>deploy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>compile</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Create contract instance</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>abi</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the deployment transaction and pass in the Pull Oracle contract address</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deployTx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>deploy</span><span class=p>({</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>bytecode</span><span class=p>,</span>
<span class=w>    </span><span class=nx>arguments</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0xaa2f56843Cec7840F0C106F0202313d8d8CB13d6&#39;</span><span class=p>],</span>
<span class=w>  </span><span class=p>});</span>

<span class=w>  </span><span class=c1>// Sign transaction with PK</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>encodeABI</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>nonce</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getTransactionCount</span><span class=p>(</span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send transaction and wait for receipt</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createReceipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>createTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Contract deployed at address: </span><span class=si>${</span><span class=nx>createReceipt</span><span class=p>.</span><span class=nx>contractAddress</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>deploy</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </li> </ol> <details class=code> <summary>deploy.js</summary> <div class="tabbed-set tabbed-alternate" data-tabs=10:2><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><input id=__tabbed_10_2 name=__tabbed_10 type=radio><div class=tabbed-labels><label for=__tabbed_10_1>Moonbeam</label><label for=__tabbed_10_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>fs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>solc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;solc&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>compile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Get path and load contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;utf8&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create input object</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>language</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Solidity&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>sources</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>content</span><span class=o>:</span><span class=w> </span><span class=nx>source</span><span class=p>,</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nx>settings</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>outputSelection</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;*&#39;</span><span class=p>],</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>tempFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>solc</span><span class=p>.</span><span class=nx>compile</span><span class=p>(</span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>input</span><span class=p>)));</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>tempFile</span><span class=p>.</span><span class=nx>contracts</span><span class=p>[</span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=p>][</span><span class=s1>&#39;OracleClient&#39;</span><span class=p>];</span>

<span class=w>  </span><span class=c1>// Save ABI to a file</span>
<span class=w>  </span><span class=nx>fs</span><span class=p>.</span><span class=nx>writeFileSync</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mf>4</span><span class=p>),</span>
<span class=w>    </span><span class=s1>&#39;utf8&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>bytecode</span><span class=p>.</span><span class=nx>object</span><span class=w> </span><span class=p>};</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>deploy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>compile</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Create contract instance</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>abi</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the deployment transaction and pass in the Pull Oracle contract address</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deployTx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>deploy</span><span class=p>({</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>bytecode</span><span class=p>,</span>
<span class=w>    </span><span class=nx>arguments</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0x2FA6DbFe4291136Cf272E1A3294362b6651e8517&#39;</span><span class=p>],</span>
<span class=w>  </span><span class=p>});</span>

<span class=w>  </span><span class=c1>// Sign transaction with PK</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>encodeABI</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>nonce</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getTransactionCount</span><span class=p>(</span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send transaction and wait for receipt</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createReceipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>createTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Contract deployed at address: </span><span class=si>${</span><span class=nx>createReceipt</span><span class=p>.</span><span class=nx>contractAddress</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>deploy</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>fs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>solc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;solc&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>compile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Get path and load contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;utf8&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create input object</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>language</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Solidity&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>sources</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>content</span><span class=o>:</span><span class=w> </span><span class=nx>source</span><span class=p>,</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nx>settings</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>outputSelection</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;*&#39;</span><span class=p>],</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>tempFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>solc</span><span class=p>.</span><span class=nx>compile</span><span class=p>(</span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>input</span><span class=p>)));</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>tempFile</span><span class=p>.</span><span class=nx>contracts</span><span class=p>[</span><span class=s1>&#39;OracleClient.sol&#39;</span><span class=p>][</span><span class=s1>&#39;OracleClient&#39;</span><span class=p>];</span>

<span class=w>  </span><span class=c1>// Save ABI to a file</span>
<span class=w>  </span><span class=nx>fs</span><span class=p>.</span><span class=nx>writeFileSync</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mf>4</span><span class=p>),</span>
<span class=w>    </span><span class=s1>&#39;utf8&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>bytecode</span><span class=p>.</span><span class=nx>object</span><span class=w> </span><span class=p>};</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>deploy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>compile</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Create contract instance</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>abi</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the deployment transaction and pass in the Pull Oracle contract address</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deployTx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>deploy</span><span class=p>({</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>bytecode</span><span class=p>,</span>
<span class=w>    </span><span class=nx>arguments</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0xaa2f56843Cec7840F0C106F0202313d8d8CB13d6&#39;</span><span class=p>],</span>
<span class=w>  </span><span class=p>});</span>

<span class=w>  </span><span class=c1>// Sign transaction with PK</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>encodeABI</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>nonce</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getTransactionCount</span><span class=p>(</span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send transaction and wait for receipt</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createReceipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>createTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Contract deployed at address: </span><span class=si>${</span><span class=nx>createReceipt</span><span class=p>.</span><span class=nx>contractAddress</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>deploy</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </details> <p>To deploy the contract, run:</p> <div class=highlight><pre><span></span><code>node<span class=w> </span>deploy.js
</code></pre></div> <p>The contract's address will be printed to the terminal; save it as you'll need it in the following steps.</p> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>node deploy.js</span> <br> <span data-ty>Contract deployed at address: 0xaf1207d950a2231937372cedc2e8ddfa22c40665</span> </div> <h3 id=call-the-consumer-contract>Call the Contract<a class=headerlink href=#call-the-consumer-contract title="Permanent link">&para;</a></h3> <p>To verify the proof data and publish the latest price on-chain, the last step you'll need to do is to create a function that calls the <code>GetPairPrice</code> function of the <code>OracleClient</code> contract.</p> <p>Back in the <code>main.js</code> file, take the following steps:</p> <ol> <li> <p>Import the ABI for the <code>OracleClient</code> contract</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>oracleClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>);</span>
</code></pre></div> </li> <li> <p>Create a function that accepts the hex-formatted proof data and will be responsible for calling the <code>OracleClient</code> contract</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Add logic here</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>In the <code>callContract</code> function, create an instance of the deployed <code>OracleClient</code> contract using the ABI and the contract address, which you should have saved from deploying the contract in the previous set of steps</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Create the transaction object that will call the <code>GetPairPrice</code> function of the <code>OracleClient</code> contract. You'll need to provide your address in the transaction object</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the transaction object using the hex-formatted proof and the index of the</span>
<span class=w>  </span><span class=c1>// data pair you requested price data for</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>txData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>).</span><span class=nx>encodeABI</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>gasEstimate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span>
<span class=w>    </span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>transactionObject</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>from</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>to</span><span class=o>:</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>,</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>txData</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=nx>gasEstimate</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>  </span><span class=p>};</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Add logic for signing and sending the transaction. You'll need to provide your private key</p> <div class="admonition remember"> <p class=admonition-title>Remember</p> <p>Never store your private key in a JavaScript file; this is for demo purposes only.</p> </div> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the transaction object using the hex-formatted proof and the index of the</span>
<span class=w>  </span><span class=c1>// data pair you requested price data for</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>txData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>).</span><span class=nx>encodeABI</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>gasEstimate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span>
<span class=w>    </span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>transactionObject</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>from</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>to</span><span class=o>:</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>,</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>txData</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=nx>gasEstimate</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=c1>// Sign the transaction with the private key</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>signedTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>transactionObject</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send the signed transaction</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span><span class=nx>signedTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span><span class=p>);</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>The last step is to call the <code>callContract</code> function from the <code>main</code> function</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Verify and write the latest price data on-chain</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>receipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>callContract</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Transaction receipt:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>receipt</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </li> </ol> <details class=code> <summary>main.js</summary> <div class="tabbed-set tabbed-alternate" data-tabs=11:2><input checked=checked id=__tabbed_11_1 name=__tabbed_11 type=radio><input id=__tabbed_11_2 name=__tabbed_11 type=radio><div class=tabbed-labels><label for=__tabbed_11_1>Moonbeam</label><label for=__tabbed_11_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;mainnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=c1>// Function to convert the proof data to human-readable price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>

<span class=c1>// Function to call the Oracle client to verify and publish the latest price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the transaction object using the hex-formatted proof and the index of the</span>
<span class=w>  </span><span class=c1>// data pair you requested price data for</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>txData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>).</span><span class=nx>encodeABI</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>gasEstimate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span>
<span class=w>    </span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>transactionObject</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>from</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>to</span><span class=o>:</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>,</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>txData</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=nx>gasEstimate</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=c1>// Sign the transaction with the private key</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>signedTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>transactionObject</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send the signed transaction</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span><span class=nx>signedTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span><span class=p>);</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Verify and write the latest price data on-chain</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>receipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>callContract</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Transaction receipt:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>receipt</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;testnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=c1>// Function to convert the proof data to human-readable price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>

<span class=c1>// Function to call the Oracle client to verify and publish the latest price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the transaction object using the hex-formatted proof and the index of the</span>
<span class=w>  </span><span class=c1>// data pair you requested price data for</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>txData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>).</span><span class=nx>encodeABI</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>gasEstimate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span>
<span class=w>    </span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>transactionObject</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>from</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>to</span><span class=o>:</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>,</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>txData</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=nx>gasEstimate</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=c1>// Sign the transaction with the private key</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>signedTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>transactionObject</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send the signed transaction</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span><span class=nx>signedTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span><span class=p>);</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Verify and write the latest price data on-chain</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>receipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>callContract</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Transaction receipt:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>receipt</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </details> <p>And that's all the logic you'll need to request, verify, and write the latest price data for a data pair on-chain using Supra!</p> <p>To verify and write the price data on-chain, go ahead and run:</p> <div class=highlight><pre><span></span><code>node<span class=w> </span>main.js
</code></pre></div> <p>The deserialized output and the transaction receipt will be printed to the console.</p> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>node main.js</span> <br> <span data-ty>----- Deserialized Data ------ <br> Pair index : [ '1' ] <br> Pair Price : [ '3424260000000000000000' ] <br> Pair Decimal : [ '18' ] <br> Pair Timestamp : [ '1709317443269' ] <br> ------------------------------ </span> <span data-ty>Transaction receipt: { <br> transactionHash: '0x7d6f14a049e41f8e873dedfed4aff53bc0d52ff06a17fb0901e35464511708b1', <br>transactionIndex: 1n, <br>blockHash: '0xb3551d522371b192f37e68634e6b0ce616adecf0d8b18e139980d2cf564f9313', <br>from: '0x097d9eea23de2d3081169e0225173d0c55768338', <br>to: '0xaf1207d950a2231937372cedc2e8ddfa22c40665', <br>blockNumber: 6178886n, <br>cumulativeGasUsed: 467872n, <br>gasUsed: 415356n, <br>logs: [], <br>logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000', <br>status: 1n, <br>effectiveGasPrice: 31250000n, <br>type: 0n <br>} </span> </div> <h2 id=retrieve-on-chain-price-data>Retrieve On-Chain Price Data<a class=headerlink href=#retrieve-on-chain-price-data title="Permanent link">&para;</a></h2> <p>If you want to access the on-chain price data, you can create another contract that interacts with Supra's Storage contract.</p> <h3 id=create-the-retrieval-contract>Create the Retrieval Contract<a class=headerlink href=#create-the-retrieval-contract title="Permanent link">&para;</a></h3> <p>To create the contract, you can take the following steps:</p> <ol> <li> <p>Create a new file for the smart contract, which we'll name <code>FeedClient</code></p> <div class=highlight><pre><span></span><code>touch<span class=w> </span>FeedClient.sol
</code></pre></div> </li> <li> <p>In the file, create an interface for Supra's Storage contract. The interface has two functions: one for retrieving the price data for a single data pair and another that retrieves price data for multiple data pairs. Then, in our <code>FeedClient</code> contract, we'll instantiate the <code>ISupraSValueFeed</code> interface with the address of Supra's Storage contract on Moonbeam or Moonbase Alpha</p> <div class=highlight><span class=filename>FeedClient.sol</span><pre><span></span><code><span class=c1>// SPDX-License-Identifier: UNLICENSED</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=err>0.8.20</span><span class=p>;</span>

interface<span class=w> </span>ISupraSValueFeed<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getSvalue</span><span class=p>(</span><span class=kt>uint64</span><span class=w> </span><span class=nv>_pairIndex</span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>bytes32</span><span class=p>,</span><span class=w> </span><span class=kt>bool</span><span class=p>);</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getSvalues</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint64</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>_pairIndexes
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>bytes32</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=p>,</span><span class=w> </span><span class=kt>bool</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> </li> <li> <p>In the same file, create the <code>FeedClient</code> contract. As mentioned in the previous step, the constructor of this contract instantiates the <code>ISupraSValueFeed</code> interface with the address of Supra's Storage contract. The contract also includes functions that call the <code>getSValue</code> and <code>getSValues</code> functions of the Storage contract and return the response in a decoded format</p> <div class=highlight><span class=filename>FeedClient.sol</span><pre><span></span><code><span class=c1>// ...</span>

<span class=k>contract</span><span class=w> </span><span class=ni>FeedClient</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// The storage contract</span>
<span class=w>    </span>ISupraSValueFeed<span class=w> </span><span class=kt>internal</span><span class=w> </span>sValueFeed<span class=p>;</span>

<span class=w>    </span><span class=kt>constructor</span><span class=p>(</span><span class=kt>address</span><span class=w> </span><span class=nv>storage_</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>sValueFeed<span class=w> </span><span class=o>=</span><span class=w> </span>ISupraSValueFeed<span class=p>(</span>storage_<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>unpack</span><span class=p>(</span><span class=kt>bytes32</span><span class=w> </span><span class=nv>data</span><span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span>pure<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>info<span class=p>;</span>

<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>(</span>data<span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">192</span><span class=p>));</span><span class=w> </span><span class=c1>// round</span>
<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>((</span>data<span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class="m m-Decimal">64</span><span class=p>)</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">248</span><span class=p>));</span><span class=w> </span><span class=c1>// decimal</span>
<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>((</span>data<span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class="m m-Decimal">72</span><span class=p>)</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">192</span><span class=p>));</span><span class=w> </span><span class=c1>// timestamp</span>
<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">3</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>((</span>data<span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class="m m-Decimal">136</span><span class=p>)</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">160</span><span class=p>));</span><span class=w> </span><span class=c1>// price</span>

<span class=w>        </span><span class=kt>return</span><span class=w> </span>info<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>bytesToUint256</span><span class=p>(</span>
<span class=w>        </span><span class=kt>bytes</span><span class=w> </span><span class=nv>memory</span><span class=w> </span>_bs
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span>pure<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>value</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>require</span><span class=p>(</span>_bs<span class=p>.</span>length<span class=w> </span><span class=o>==</span><span class=w> </span><span class="m m-Decimal">32</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;bytes length is not 32.&quot;</span><span class=p>);</span>
<span class=w>        </span>assembly<span class=w> </span><span class=p>{</span>
<span class=w>            </span>value<span class=w> </span><span class=o>:=</span><span class=w> </span>mload<span class=p>(</span>add<span class=p>(</span>_bs<span class=p>,</span><span class=w> </span><span class=mh>0x20</span><span class=p>))</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getPrice</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>_priceIndex</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=p>(</span><span class=kt>bytes32</span><span class=w> </span><span class=nv>val</span><span class=p>,</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span>sValueFeed<span class=p>.</span>getSvalue<span class=p>(</span>_priceIndex<span class=p>);</span>

<span class=w>        </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>decoded<span class=w> </span><span class=o>=</span><span class=w> </span>unpack<span class=p>(</span>val<span class=p>);</span>

<span class=w>        </span><span class=kt>return</span><span class=w> </span>decoded<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getPriceForMultiplePair</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint64</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>_pairIndexes
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>][]</span><span class=w> </span><span class=kt>memory</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=p>(</span><span class=kt>bytes32</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>val<span class=p>,</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span>sValueFeed<span class=p>.</span>getSvalues<span class=p>(</span>_pairIndexes<span class=p>);</span>

<span class=w>        </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>][]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>decodedArray<span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>new</span><span class=w> </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>][](</span>val<span class=p>.</span>length<span class=p>);</span>

<span class=w>        </span><span class=kt>for</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span><span class=w> </span>i<span class=w> </span><span class=o>&lt;</span><span class=w> </span>val<span class=p>.</span>length<span class=p>;</span><span class=w> </span>i<span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>decoded<span class=w> </span><span class=o>=</span><span class=w> </span>unpack<span class=p>(</span>val<span class=p>[</span>i<span class=p>]);</span>
<span class=w>            </span>decodedArray<span class=p>[</span>i<span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>decoded<span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kt>return</span><span class=w> </span>decodedArray<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </li> </ol> <details class=code> <summary>FeedClient.sol</summary> <div class=highlight><pre><span></span><code><span class=c1>// SPDX-License-Identifier: UNLICENSED</span>
<span class=k>pragma solidity</span><span class=w> </span><span class=err>0.8.20</span><span class=p>;</span>

interface<span class=w> </span>ISupraSValueFeed<span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getSvalue</span><span class=p>(</span><span class=kt>uint64</span><span class=w> </span><span class=nv>_pairIndex</span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>bytes32</span><span class=p>,</span><span class=w> </span><span class=kt>bool</span><span class=p>);</span>
<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getSvalues</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint64</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>_pairIndexes
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>bytes32</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=p>,</span><span class=w> </span><span class=kt>bool</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=p>);</span>
<span class=p>}</span>

<span class=k>contract</span><span class=w> </span><span class=ni>FeedClient</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// The storage contract</span>
<span class=w>    </span>ISupraSValueFeed<span class=w> </span><span class=kt>internal</span><span class=w> </span>sValueFeed<span class=p>;</span>

<span class=w>    </span><span class=kt>constructor</span><span class=p>(</span><span class=kt>address</span><span class=w> </span><span class=nv>storage_</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span>sValueFeed<span class=w> </span><span class=o>=</span><span class=w> </span>ISupraSValueFeed<span class=p>(</span>storage_<span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>unpack</span><span class=p>(</span><span class=kt>bytes32</span><span class=w> </span><span class=nv>data</span><span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span>pure<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>info<span class=p>;</span>

<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>(</span>data<span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">192</span><span class=p>));</span><span class=w> </span><span class=c1>// round</span>
<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>((</span>data<span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class="m m-Decimal">64</span><span class=p>)</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">248</span><span class=p>));</span><span class=w> </span><span class=c1>// decimal</span>
<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>((</span>data<span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class="m m-Decimal">72</span><span class=p>)</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">192</span><span class=p>));</span><span class=w> </span><span class=c1>// timestamp</span>
<span class=w>        </span>info<span class=p>[</span><span class="m m-Decimal">3</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>bytesToUint256<span class=p>(</span>abi<span class=p>.</span>encodePacked<span class=p>((</span>data<span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class="m m-Decimal">136</span><span class=p>)</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class="m m-Decimal">160</span><span class=p>));</span><span class=w> </span><span class=c1>// price</span>

<span class=w>        </span><span class=kt>return</span><span class=w> </span>info<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>bytesToUint256</span><span class=p>(</span>
<span class=w>        </span><span class=kt>bytes</span><span class=w> </span><span class=nv>memory</span><span class=w> </span>_bs
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>internal</span><span class=w> </span>pure<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>value</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>require</span><span class=p>(</span>_bs<span class=p>.</span>length<span class=w> </span><span class=o>==</span><span class=w> </span><span class="m m-Decimal">32</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;bytes length is not 32.&quot;</span><span class=p>);</span>
<span class=w>        </span>assembly<span class=w> </span><span class=p>{</span>
<span class=w>            </span>value<span class=w> </span><span class=o>:=</span><span class=w> </span>mload<span class=p>(</span>add<span class=p>(</span>_bs<span class=p>,</span><span class=w> </span><span class=mh>0x20</span><span class=p>))</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getPrice</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint64</span><span class=w> </span><span class=nv>_priceIndex</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=p>(</span><span class=kt>bytes32</span><span class=w> </span><span class=nv>val</span><span class=p>,</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span>sValueFeed<span class=p>.</span>getSvalue<span class=p>(</span>_priceIndex<span class=p>);</span>

<span class=w>        </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>decoded<span class=w> </span><span class=o>=</span><span class=w> </span>unpack<span class=p>(</span>val<span class=p>);</span>

<span class=w>        </span><span class=kt>return</span><span class=w> </span>decoded<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kt>function</span><span class=w> </span><span class=nv>getPriceForMultiplePair</span><span class=p>(</span>
<span class=w>        </span><span class=kt>uint64</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>_pairIndexes
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=kt>external</span><span class=w> </span>view<span class=w> </span><span class=kt>returns</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>][]</span><span class=w> </span><span class=kt>memory</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=p>(</span><span class=kt>bytes32</span><span class=p>[]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>val<span class=p>,</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span>sValueFeed<span class=p>.</span>getSvalues<span class=p>(</span>_pairIndexes<span class=p>);</span>

<span class=w>        </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>][]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>decodedArray<span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>new</span><span class=w> </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>][](</span>val<span class=p>.</span>length<span class=p>);</span>

<span class=w>        </span><span class=kt>for</span><span class=w> </span><span class=p>(</span><span class=kt>uint256</span><span class=w> </span><span class=nv>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class="m m-Decimal">0</span><span class=p>;</span><span class=w> </span>i<span class=w> </span><span class=o>&lt;</span><span class=w> </span>val<span class=p>.</span>length<span class=p>;</span><span class=w> </span>i<span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kt>uint256</span><span class=p>[</span><span class="m m-Decimal">4</span><span class=p>]</span><span class=w> </span><span class=kt>memory</span><span class=w> </span>decoded<span class=w> </span><span class=o>=</span><span class=w> </span>unpack<span class=p>(</span>val<span class=p>[</span>i<span class=p>]);</span>
<span class=w>            </span>decodedArray<span class=p>[</span>i<span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span>decoded<span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kt>return</span><span class=w> </span>decodedArray<span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </details> <h3 id=deploy-the-retrieval-contract>Deploy the Contract<a class=headerlink href=#deploy-the-retrieval-contract title="Permanent link">&para;</a></h3> <p>The steps for compiling and deploying the contract are similar to those in the previous section. You can either duplicate the <code>deploy.js</code> file and make the necessary edits or directly edit the existing <code>deploy.js</code> file with the following two changes:</p> <ul> <li>Update the contract name from <code>OracleClient</code> to <code>FeedClient</code></li> <li>Update the contract address in the deployment transaction to be the Storage contract address instead of the Pull contract address</li> </ul> <p>You should end up with the following code:</p> <details class=code open=open> <summary>deploy.js</summary> <div class="tabbed-set tabbed-alternate" data-tabs=12:2><input checked=checked id=__tabbed_12_1 name=__tabbed_12 type=radio><input id=__tabbed_12_2 name=__tabbed_12 type=radio><div class=tabbed-labels><label for=__tabbed_12_1>Moonbeam</label><label for=__tabbed_12_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>fs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>solc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;solc&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>compile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Get path and load contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;FeedClient.sol&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;utf8&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create input object</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>language</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Solidity&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>sources</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=s1>&#39;FeedClient.sol&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>content</span><span class=o>:</span><span class=w> </span><span class=nx>source</span><span class=p>,</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nx>settings</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>outputSelection</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;*&#39;</span><span class=p>],</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>tempFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>solc</span><span class=p>.</span><span class=nx>compile</span><span class=p>(</span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>input</span><span class=p>)));</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>tempFile</span><span class=p>.</span><span class=nx>contracts</span><span class=p>[</span><span class=s1>&#39;FeedClient.sol&#39;</span><span class=p>][</span><span class=s1>&#39;FeedClient&#39;</span><span class=p>];</span>

<span class=w>  </span><span class=c1>// Save ABI to a file</span>
<span class=w>  </span><span class=nx>fs</span><span class=p>.</span><span class=nx>writeFileSync</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;./resources/feedClient.json&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mf>4</span><span class=p>),</span>
<span class=w>    </span><span class=s1>&#39;utf8&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>bytecode</span><span class=p>.</span><span class=nx>object</span><span class=w> </span><span class=p>};</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>deploy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>compile</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Create contract instance</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>abi</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the deployment transaction and pass in the Storage contract address</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deployTx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>deploy</span><span class=p>({</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>bytecode</span><span class=p>,</span>
<span class=w>    </span><span class=nx>arguments</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0xD02cc7a670047b6b012556A88e275c685d25e0c9&#39;</span><span class=p>],</span>
<span class=w>  </span><span class=p>});</span>

<span class=w>  </span><span class=c1>// Sign transaction with PK</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>encodeABI</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>nonce</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getTransactionCount</span><span class=p>(</span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send transaction and wait for receipt</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createReceipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>createTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Contract deployed at address: </span><span class=si>${</span><span class=nx>createReceipt</span><span class=p>.</span><span class=nx>contractAddress</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>deploy</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>fs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>solc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;solc&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>

<span class=kd>const</span><span class=w> </span><span class=nx>compile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Get path and load contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;FeedClient.sol&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;utf8&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create input object</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>language</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;Solidity&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>sources</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=s1>&#39;FeedClient.sol&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>content</span><span class=o>:</span><span class=w> </span><span class=nx>source</span><span class=p>,</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nx>settings</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>outputSelection</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=s1>&#39;*&#39;</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;*&#39;</span><span class=p>],</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>tempFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>solc</span><span class=p>.</span><span class=nx>compile</span><span class=p>(</span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>input</span><span class=p>)));</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>tempFile</span><span class=p>.</span><span class=nx>contracts</span><span class=p>[</span><span class=s1>&#39;FeedClient.sol&#39;</span><span class=p>][</span><span class=s1>&#39;FeedClient&#39;</span><span class=p>];</span>

<span class=w>  </span><span class=c1>// Save ABI to a file</span>
<span class=w>  </span><span class=nx>fs</span><span class=p>.</span><span class=nx>writeFileSync</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;./resources/feedClient.json&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nb>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mf>4</span><span class=p>),</span>
<span class=w>    </span><span class=s1>&#39;utf8&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=o>:</span><span class=w> </span><span class=nx>contractFile</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>bytecode</span><span class=p>.</span><span class=nx>object</span><span class=w> </span><span class=p>};</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>deploy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Compile the contract</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>abi</span><span class=p>,</span><span class=w> </span><span class=nx>bytecode</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>compile</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Create contract instance</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>abi</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the deployment transaction and pass in the Storage contract address</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>deployTx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>deploy</span><span class=p>({</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>bytecode</span><span class=p>,</span>
<span class=w>    </span><span class=nx>arguments</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0x4591d1B110ad451d8220d82252F829E8b2a91B17&#39;</span><span class=p>],</span>
<span class=w>  </span><span class=p>});</span>

<span class=w>  </span><span class=c1>// Sign transaction with PK</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>encodeABI</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>deployTx</span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>      </span><span class=nx>nonce</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getTransactionCount</span><span class=p>(</span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send transaction and wait for receipt</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>createReceipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>createTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Contract deployed at address: </span><span class=si>${</span><span class=nx>createReceipt</span><span class=p>.</span><span class=nx>contractAddress</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>deploy</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </details> <p>To deploy the contract, run:</p> <div class=highlight><pre><span></span><code>node<span class=w> </span>deploy.js
</code></pre></div> <p>The contract address will be printed to your terminal; save it as you'll need it in the next section.</p> <h3 id=call-the-retrieval-contract>Call the Contract<a class=headerlink href=#call-the-retrieval-contract title="Permanent link">&para;</a></h3> <p>For simplicity, you can add a function to the <code>main.js</code> file that retrieves the data from the <code>FeedClient</code> contract:</p> <ol> <li> <p>Import the ABI of the <code>FeedClient</code> contract</p> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>feedClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/feedClient.json&#39;</span><span class=p>);</span><span class=w> </span>
</code></pre></div> </li> <li> <p>Create a function named <code>getPriceData</code> that accepts the index of a data pair as a parameter and will be responsible for calling the <code>FeedClient</code> contract</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getPriceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>index</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// Add logic here</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>In the <code>getPriceData</code> function, create an instance of the deployed <code>FeedClient</code> contract using the ABI and the contract address, which you should have saved from deploying the contract in the previous set of steps</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getPriceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>index</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>feedClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>Call the <code>getPrice</code> function of the <code>FeedClient</code> contract and log the results to the console</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>getPriceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>index</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>feedClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Get the price data and log it to the console</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>priceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>getPrice</span><span class=p>(</span><span class=nx>index</span><span class=p>).</span><span class=nx>call</span><span class=p>();</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- On-Chain Price Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Round : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>0</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Decimals : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>1</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>2</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>3</span><span class=p>]);</span>
<span class=p>};</span>
</code></pre></div> </li> <li> <p>In the <code>main</code> function, add the logic to call the <code>getPriceData</code> function</p> <div class=highlight><span class=filename>main.js</span><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Verify and write the latest price data on-chain</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>receipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>callContract</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Transaction receipt:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>receipt</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Get the latest price data</span>
<span class=w>  </span><span class=k>await</span><span class=w> </span><span class=nx>getPriceData</span><span class=p>(</span><span class=nx>pairIndex</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </li> </ol> <details class=code> <summary>main.js</summary> <div class="tabbed-set tabbed-alternate" data-tabs=13:2><input checked=checked id=__tabbed_13_1 name=__tabbed_13 type=radio><input id=__tabbed_13_2 name=__tabbed_13 type=radio><div class=tabbed-labels><label for=__tabbed_13_1>Moonbeam</label><label for=__tabbed_13_2>Moonbase Alpha</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>feedClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/feedClient.json&#39;</span><span class=p>);</span><span class=w> </span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbeam.network&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;mainnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=c1>// Function to convert the proof data to human-readable price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>

<span class=c1>// Function to call the Oracle client to verify and publish the latest price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the transaction object using the hex-formatted proof and the index of the</span>
<span class=w>  </span><span class=c1>// data pair you requested price data for</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>txData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>).</span><span class=nx>encodeABI</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>gasEstimate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span>
<span class=w>    </span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>transactionObject</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>from</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>to</span><span class=o>:</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>,</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>txData</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=nx>gasEstimate</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=c1>// Sign the transaction with the private key</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>signedTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>transactionObject</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send the signed transaction</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span><span class=nx>signedTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span><span class=p>);</span>
<span class=p>};</span>

<span class=c1>// Function to get the most recently published on-chain price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getPriceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>index</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>feedClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Get the price data and log it to the console</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>priceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>getPrice</span><span class=p>(</span><span class=nx>index</span><span class=p>).</span><span class=nx>call</span><span class=p>();</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- On-Chain Price Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Round : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>0</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Decimals : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>1</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>2</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>3</span><span class=p>]);</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Verify and write the latest price data on-chain</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>receipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>callContract</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Transaction receipt:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>receipt</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Get the latest price data</span>
<span class=w>  </span><span class=k>await</span><span class=w> </span><span class=nx>getPriceData</span><span class=p>(</span><span class=nx>pairIndex</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./pullServiceClient&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleProofABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleProof.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>signedCoherentClusterABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/signedCoherentCluster.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Web3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;web3&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>oracleClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/oracleClient.json&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>feedClientABI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./resources/feedClient.json&#39;</span><span class=p>);</span><span class=w> </span>

<span class=kd>const</span><span class=w> </span><span class=nx>web3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Web3</span><span class=p>(</span><span class=s1>&#39;https://rpc.api.moonbase.moonbeam.network&#39;</span><span class=p>);</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pairIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>

<span class=c1>// Function that fetches proof data from the gRPC server using the specified parameters</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getProofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;testnet-dora.supraoracles.com&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>PullServiceClient</span><span class=p>(</span><span class=nx>address</span><span class=p>);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>pair_indexes</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=nx>pairIndex</span><span class=p>],</span><span class=w> </span><span class=c1>// ETH_USDT</span>
<span class=w>    </span><span class=nx>chain_type</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;evm&#39;</span><span class=p>,</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>client</span><span class=p>.</span><span class=nx>getProof</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>err</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>.</span><span class=nx>details</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>};</span>

<span class=c1>// Function to convert the proof data to human-readable price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>deserializeProofBytes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proof_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span><span class=nx>oracleProofABI</span><span class=p>,</span><span class=w> </span><span class=nx>proofHex</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// Fatching the raw bytes of the signed pair cluster data</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>clusters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>clustersRaw</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Fetching which pair IDs have been requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairMask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>proof_data</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>pairMask</span><span class=p>;</span>

<span class=w>  </span><span class=c1>// Helps in iterating the vector of pair masking</span>
<span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=nx>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Lists of all the pair IDs, prices, decimals, and timestamps requested</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairPrice</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairDecimal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>clusters</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Deserialize the raw bytes of the signed pair cluster data</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>scc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>abi</span><span class=p>.</span><span class=nx>decodeParameters</span><span class=p>(</span>
<span class=w>      </span><span class=nx>signedCoherentClusterABI</span><span class=p>,</span>
<span class=w>      </span><span class=nx>clusters</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=nx>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>pair</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>      </span><span class=c1>// Verify whether the pair is requested or not</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>pairMask</span><span class=p>[</span><span class=nx>pair</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>continue</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=c1>// Pushing the pair IDs, prices, decimals, and timestamps requested in the output vector</span>
<span class=w>      </span><span class=nx>pairId</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>pair</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairPrice</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>prices</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairDecimal</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>decimals</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>      </span><span class=nx>pairTimestamp</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>scc</span><span class=p>[</span><span class=mf>0</span><span class=p>].</span><span class=nx>cc</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>toString</span><span class=p>(</span><span class=mf>10</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- Deserialized Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair index : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairId</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairPrice</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Decimal : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairDecimal</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Pair Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>pairTimestamp</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;------------------------------&#39;</span><span class=p>);</span>
<span class=p>};</span>

<span class=c1>// Function to call the Oracle client to verify and publish the latest price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>callContract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>proofHex</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>oracleClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Create the transaction object using the hex-formatted proof and the index of the</span>
<span class=w>  </span><span class=c1>// data pair you requested price data for</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>txData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>).</span><span class=nx>encodeABI</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>gasEstimate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span>
<span class=w>    </span><span class=p>.</span><span class=nx>GetPairPrice</span><span class=p>(</span><span class=nx>proofHex</span><span class=p>,</span><span class=w> </span><span class=nx>pairIndex</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>estimateGas</span><span class=p>();</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>transactionObject</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>from</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;INSERT_ADDRESS&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=nx>to</span><span class=o>:</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>,</span>
<span class=w>    </span><span class=nx>data</span><span class=o>:</span><span class=w> </span><span class=nx>txData</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gas</span><span class=o>:</span><span class=w> </span><span class=nx>gasEstimate</span><span class=p>,</span>
<span class=w>    </span><span class=nx>gasPrice</span><span class=o>:</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getGasPrice</span><span class=p>(),</span>
<span class=w>  </span><span class=p>};</span>

<span class=w>  </span><span class=c1>// Sign the transaction with the private key</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>signedTransaction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>accounts</span><span class=p>.</span><span class=nx>signTransaction</span><span class=p>(</span>
<span class=w>    </span><span class=nx>transactionObject</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;INSERT_PRIVATE_KEY&#39;</span>
<span class=w>  </span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Send the signed transaction</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>sendSignedTransaction</span><span class=p>(</span><span class=nx>signedTransaction</span><span class=p>.</span><span class=nx>rawTransaction</span><span class=p>);</span>
<span class=p>};</span>

<span class=c1>// Function to get the most recently published on-chain price data</span>
<span class=kd>const</span><span class=w> </span><span class=nx>getPriceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>(</span><span class=nx>index</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contractAddress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT_CONTRACT_ADDRESS&#39;</span><span class=p>;</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>contract</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>Contract</span><span class=p>(</span><span class=nx>feedClientABI</span><span class=p>,</span><span class=w> </span><span class=nx>contractAddress</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Get the price data and log it to the console</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>priceData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>contract</span><span class=p>.</span><span class=nx>methods</span><span class=p>.</span><span class=nx>getPrice</span><span class=p>(</span><span class=nx>index</span><span class=p>).</span><span class=nx>call</span><span class=p>();</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;----- On-Chain Price Data ------&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Round : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>0</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Decimals : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>1</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Timestamp : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>2</span><span class=p>]);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Price : &#39;</span><span class=p>,</span><span class=w> </span><span class=nx>priceData</span><span class=p>[</span><span class=mf>3</span><span class=p>]);</span>
<span class=p>};</span>

<span class=kd>const</span><span class=w> </span><span class=nx>main</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>proofs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>getProofs</span><span class=p>();</span>

<span class=w>  </span><span class=c1>// Convert oracle proof bytes to hex</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>hex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>web3</span><span class=p>.</span><span class=nx>utils</span><span class=p>.</span><span class=nx>bytesToHex</span><span class=p>(</span><span class=nx>proofs</span><span class=p>.</span><span class=nx>evm</span><span class=p>.</span><span class=nx>proof_bytes</span><span class=p>);</span>
<span class=w>  </span><span class=nx>deserializeProofBytes</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Verify and write the latest price data on-chain</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>receipt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>callContract</span><span class=p>(</span><span class=nx>hex</span><span class=p>);</span>
<span class=w>  </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Transaction receipt:&#39;</span><span class=p>,</span><span class=w> </span><span class=nx>receipt</span><span class=p>);</span>

<span class=w>  </span><span class=c1>// Get the latest price data</span>
<span class=w>  </span><span class=k>await</span><span class=w> </span><span class=nx>getPriceData</span><span class=p>(</span><span class=nx>pairIndex</span><span class=p>);</span>
<span class=p>};</span>

<span class=nx>main</span><span class=p>();</span>
</code></pre></div> </div> </div> </div> </details> <p>Run the following command to print the price data to the terminal:</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Feel free to comment out the calls to the <code>deserializeProofBytes</code> and <code>callContract</code> functions if you only want to retrieve the price data.</p> </div> <div class=highlight><pre><span></span><code>node<span class=w> </span>main.js
</code></pre></div> <p>The terminal output should now include the price data.</p> <div id=termynal data-termynal> <span data-ty=input><span class=file-path></span>node main.js</span> <br> <span data-ty>----- On-Chain Price Data ------ <br> Round : 1709333298000n <br> Decimals : 18n <br> Timestamp : 1709333298216n <br> Price : 3430850000000000000000n </span> </div> <p>And that's it! You've successfully fetched the proof data from Supra, verified and published it on-chain, and retrieved it! For more information on Supra Oracles, please check out their <a href=https://docs.supra.com/ target=_blank>documentation</a>.</p> <div class=page-disclaimer> This tutorial is for educational purposes only. As such, any contracts or code created in this tutorial should not be used in production. </div> <div class=page-disclaimer> The information presented herein has been provided by third parties and is made available solely for general information purposes. Moonbeam does not endorse any project listed and described on the Moonbeam Doc Website (https://docs.moonbeam.network/). Moonbeam Foundation does not warrant the accuracy, completeness or usefulness of this information. Any reliance you place on such information is strictly at your own risk. Moonbeam Foundation disclaims all liability and responsibility arising from any reliance placed on this information by you or by anyone who may be informed of any of its contents. All statements and/or opinions expressed in these materials are solely the responsibility of the person or entity providing those materials and do not necessarily represent the opinion of Moonbeam Foundation. The information should not be construed as professional or financial advice of any kind. Advice from a suitably qualified professional should always be sought in relation to any particular matter or circumstance. The information herein may link to or integrate with other websites operated or content provided by third parties, and such other websites may link to this website. Moonbeam Foundation has no control over any such other websites or their content and will have no liability arising out of or related to such websites or their content. The existence of any such link does not constitute an endorsement of such websites, the content of the websites, or the operators of the websites. These links are being provided to you only as a convenience and you release and hold Moonbeam Foundation harmless from any and all liability arising from your use of this information or the information provided by any third-party website or service. </div> <div class=md-source-file> <small> <span class=source-file-label>Last update:</span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 16, 2025 14:41:49">September 16, 2025</span> <br> <span class=source-file-seperator>|</span> <span class=source-file-label>Created:</span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 16, 2025 14:41:49">September 16, 2025</span> </small> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=footer.title> <a href=../oracles.index/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=122.883px height=122.882px viewbox="0 0 122.883 122.882" enable-background="new 0 0 122.883 122.882" xml:space=preserve><g><path d="M61.441,0c16.967,0,32.327,6.877,43.446,17.996c11.119,11.119,17.996,26.479,17.996,43.445 c0,16.966-6.877,32.326-17.996,43.445c-11.119,11.118-26.479,17.995-43.446,17.995c-16.966,0-32.326-6.877-43.445-17.995 C6.877,93.768,0,78.407,0,61.441c0-16.967,6.877-32.327,17.996-43.445C29.115,6.877,44.475,0,61.441,0L61.441,0z M71.377,42.166 c1.736-1.784,1.695-4.637-0.088-6.372s-4.637-1.696-6.373,0.088L43.078,58.402l3.23,3.142l-3.244-3.146 c-1.737,1.792-1.693,4.652,0.099,6.39c0.052,0.05,0.104,0.099,0.158,0.146l21.595,22.082c1.736,1.784,4.59,1.823,6.373,0.088 c1.783-1.734,1.824-4.588,0.088-6.372L52.598,61.531L71.377,42.166L71.377,42.166z M98.496,24.386 C89.014,14.903,75.912,9.038,61.441,9.038s-27.572,5.865-37.055,15.348C14.903,33.869,9.038,46.97,9.038,61.441 c0,14.471,5.865,27.572,15.349,37.055c9.482,9.483,22.583,15.349,37.055,15.349s27.573-5.865,37.055-15.349 c9.484-9.482,15.35-22.584,15.35-37.055C113.846,46.97,107.98,33.869,98.496,24.386L98.496,24.386z"/></g></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <span class=md-footer__page-name> Tutorials on Using Oracles </span> </div> </a> <a href=../0xgasless/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <span class=md-footer__page-name> Enable Gasless Transactions </span> </div> <div class="md-footer__button md-icon"> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=122.883px height=122.882px viewbox="0 0 122.883 122.882" enable-background="new 0 0 122.883 122.882" xml:space=preserve><g><path d="M61.441,0C44.475,0,29.115,6.877,17.996,17.996C6.877,29.115,0,44.475,0,61.441c0,16.966,6.877,32.326,17.996,43.445 c11.119,11.118,26.479,17.995,43.445,17.995c16.967,0,32.327-6.877,43.446-17.995c11.119-11.119,17.996-26.479,17.996-43.445 c0-16.967-6.877-32.327-17.996-43.445C93.768,6.877,78.408,0,61.441,0L61.441,0z M51.505,42.166 c-1.735-1.784-1.696-4.637,0.088-6.372c1.784-1.735,4.637-1.696,6.373,0.088l21.839,22.521l-3.23,3.142l3.244-3.146 c1.738,1.792,1.693,4.652-0.098,6.39c-0.053,0.05-0.105,0.099-0.158,0.146L57.966,87.017c-1.735,1.784-4.588,1.823-6.373,0.088 c-1.784-1.734-1.823-4.588-0.088-6.372l18.78-19.201L51.505,42.166L51.505,42.166z M24.386,24.386 C33.869,14.903,46.97,9.038,61.441,9.038c14.471,0,27.573,5.865,37.055,15.348c9.484,9.483,15.35,22.584,15.35,37.056 c0,14.471-5.865,27.572-15.35,37.055c-9.482,9.483-22.584,15.349-37.055,15.349c-14.471,0-27.572-5.865-37.055-15.349 C14.903,89.014,9.038,75.912,9.038,61.441C9.038,46.97,14.903,33.869,24.386,24.386L24.386,24.386z"/></g></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="column llms-wrapper"> <p class=llms-title> AI-Compatible Docs </p> <div class=llms-options> <a class=llms-link href=/llms.txt>llms.txt</a> <a class=llms-link href=/llms-full.txt>llms-full.txt</a> <a href=/ai-resources/ai-resources/ class=llms-link>LLMs By Topic</a> </div> </div> <div class="column social"> <div class=md-social> <a href=https://discord.com/invite/PfpUATX target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://t.me/Moonbeam_Official target=_blank rel=noopener title=Telegram class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg> </a> <a href=https://twitter.com/MoonbeamNetwork target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://www.youtube.com/c/MoonbeamNetwork target=_blank rel=noopener title=YouTube class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg> </a> <a href=https://github.com/moonbeam-foundation/moonbeam target=_blank rel=noopener title=GitHub class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> <div class=md-footer-copyright> <div class=copyright-wrapper> <div class=md-footer-copyright__highlight> © 2025 Moonbeam Foundation. All Rights Reserved. </div> <div class=papermoon> <span> Made with 🩵 by <a href=https://papermoon.io/ target=_blank>PaperMoon</a> </span> </div> <div class=policy-links> <a href=https://moonbeam.network/terms-of-use target=_blank>Terms of use</a> <a href=https://moonbeam.network/privacy-policy target=_blank>Privacy policy</a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <form class="md-consent__form md-grid md-typeset"><div class=cookie-logo> <img src=../../..assets/images/Moonbeam_Icon_White.webp alt="Moonbeam logo for Cookie consent"> </div><div class=cookie-content> <h4>This website uses cookies</h4> <p>We use essential cookies to make the website work. We would also like to use cookies to understand how you use the website and how you interact with certain features. We may share this information with our analytics partners. For further details, please see our <a href=https://moonbeam.network/cookie-policy target=_blank rel=noopener>cookie policy</a>. </p><input class=md-toggle type=checkbox id=__settings><div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> </ul> </div> </div><div class="cookie-buttons md-consent__controls"> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> <button type=reset class="md-button md-button--secondary">Reject</button> </div> </form> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "navigation.prune", "content.code.copy", "announce.dismiss", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.56ea9cef.min.js></script> <script src=../../../js/connectMetaMask.min.js></script> <script src=../../../js/errorModal.min.js></script> <script src=../../../js/networkModal.min.js></script> <script src=../../../js/handleLanguageChange.min.js></script> <script src=../../../js/fixCreatedDate.min.js></script> <script src=../../../js/externalLinkModal.min.js></script> <script src=../../../js/cookbookInit.min.js></script> <script src=../../../js/clipboardCopyllms.min.js></script> <script src=../../../js/cookbookEventHandler.js></script> <script>
    document.addEventListener('DOMContentLoaded', () => {
      const copyTxtFile = async (url) => {
        try {
            const response = await fetch(url);
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            const text = await response.text();
            await navigator.clipboard.writeText(text);

            const copiedToClipboard = document.querySelector('.md-dialog');
            if (copiedToClipboard) {
              copiedToClipboard.classList.add('md-dialog--active');

              const copiedToClipboardMessage =
                copiedToClipboard.querySelector('.md-dialog__inner');
              if (
                copiedToClipboardMessage &&
                copiedToClipboardMessage.textContent !==
                  "Copied to clipboard"
              ) {
                copiedToClipboardMessage.textContent =
                  "Copied to clipboard";
              }
              // Set a timer to remove the after 2 seconds (2000ms)
              setTimeout(() => {
                copiedToClipboard.classList.remove('md-dialog--active');
              }, 2000);
            }
          } catch (err) {
            console.error('Failed to copy:', err);
            const copiedToClipboard = document.querySelector('.md-dialog');
            if (copiedToClipboard) {
              copiedToClipboard.classList.remove('md-dialog--active');
            }
          }
      }

      document.querySelectorAll('.llms').forEach(button => {
        button.addEventListener('click', (event) => {
          event.preventDefault(); // Prevent default link behavior

          const action = button.getAttribute('data-action');
          const fileName = button.getAttribute('data-value');
          if (!fileName) return; // Exit if no file name is found

          // Add 'llms-files/' prefix except for root-level llms.txt and llms-full.txt
          const filePath = (fileName === "llms.txt" || fileName === "llms-full.txt") 
            ? fileName 
            : `llms-files/${fileName}`;
          const url = `https://docs.moonbeam.network/${filePath}`;

          if (action === 'copy') {
            copyTxtFile(url);
          }
        })
      })
    });
  </script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>